<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å›½è‰¯è¯±æ•å™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            background-color: #0d1117;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            touch-action: manipulation;
            color: #e6edf3;
        }
        
        #game-container {
            width: 100%;
            height: 100%;
            max-width: 450px;
            max-height: 800px;
            background-color: #161b22;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
        }
        
        /* Title Screen */
        #title-screen {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1e253a 0%, #0d1117 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: absolute;
            z-index: 10;
            transition: opacity 0.5s;
        }
        
        #title-logo {
            font-size: 3rem;
            font-weight: bold;
            color: #f778ba;
            text-shadow: 0 0 15px rgba(247, 120, 186, 0.7);
            margin-bottom: 3rem;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { text-shadow: 0 0 15px rgba(247, 120, 186, 0.7); }
            50% { text-shadow: 0 0 25px rgba(247, 120, 186, 0.9); }
            100% { text-shadow: 0 0 15px rgba(247, 120, 186, 0.7); }
        }
        
        .btn {
            padding: 0.8rem 1.5rem;
            background-color: #30363d;
            color: #f778ba;
            border: 2px solid #f778ba;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            margin: 0.7rem 0;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            width: 180px;
            text-align: center;
            transition: all 0.3s;
            -webkit-tap-highlight-color: transparent;
        }
        
        .btn:active {
            transform: translateY(3px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .btn:hover {
            background-color: #373e47;
        }
        
        /* Game UI */
        #game-ui {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            opacity: 0;
            transition: opacity 0.5s;
        }
        
        /* Status Bar */
        #status-bar {
            height: 60px;
            background-color: #0d1117;
            display: flex;
            align-items: center;
            padding: 0 15px;
            justify-content: space-between;
            border-bottom: 1px solid #30363d;
        }
        
        .status-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .status-label {
            font-size: 0.7rem;
            color: #8b949e;
        }
        
        .status-value {
            font-weight: bold;
            color: #f778ba;
            font-size: 0.9rem;
        }
        
        /* Scene Container */
        #scene-container {
            height: 35%;
            min-height: 200px;
            background-color: #1e253a;
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        #scene-bg {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 6rem;
            text-align: center;
            z-index: -1;
            opacity: 0.8;
        }
        
        #character {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 160px;
            background-color: transparent;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2;
            transition: transform 0.3s ease-out;
        }
        
        #character-img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.5));
        }
        
        /* Menu Button */
        #menu-button {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: rgba(13, 17, 23, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.2rem;
            color: #f778ba;
            cursor: pointer;
            z-index: 100;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            border: 1px solid #30363d;
            padding: 10px;
            margin: -10px;
        }
        
        #menu-button:active {
            transform: scale(0.95);
            background-color: rgba(30, 37, 58, 0.9);
        }
        
        /* Dialogue Box */
        #dialogue-box {
            flex-grow: 1;
            background-color: #0d1117;
            padding: 1rem;
            position: relative;
            border-top: 2px solid #30363d;
            display: flex;
            flex-direction: column;
        }
        
        #speaker-name {
            background-color: #f778ba;
            color: #0d1117;
            display: inline-block;
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-weight: bold;
            position: absolute;
            top: -15px;
            left: 20px;
            font-size: 0.9rem;
            z-index: 2;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        
        #dialogue-text {
            margin-top: 1.2rem;
            font-size: 1rem;
            line-height: 1.6;
            overflow-y: auto;
            flex-grow: 1;
            margin-bottom: 0.6rem;
            padding: 0.5rem;
            min-height: 80px;
            max-height: 30vh;
            color: #e6edf3;
            background-color: rgba(30, 37, 58, 0.3);
            border-radius: 10px;
            border: 1px solid #30363d;
        }
        
        #tap-indicator {
            position: absolute;
            bottom: 10px;
            right: 15px;
            color: #f778ba;
            animation: tap-pulse 1.5s infinite;
            font-size: 1.2rem;
        }
        
        @keyframes tap-pulse {
            0% { opacity: 0.6; transform: translateY(0); }
            50% { opacity: 1; transform: translateY(-3px); }
            100% { opacity: 0.6; transform: translateY(0); }
        }
        
        /* Choice Buttons */
        #choices-container {
            margin-top: 0.6rem;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            max-height: 35vh;
            gap: 8px;
        }
        
        .choice-btn {
            background-color: #21262d;
            padding: 1rem 1.2rem;
            border-radius: 10px;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid #30363d;
            text-align: left;
            font-size: 0.95rem;
            position: relative;
            color: #e6edf3;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            z-index: 10;
            user-select: none;
            pointer-events: auto;
        }
        
        .choice-btn:active {
            background-color: #30363d;
            transform: translateY(2px);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        .choice-btn.disabled {
            opacity: 0.5;
            pointer-events: none;
            border: 1px solid #484f58;
            color: #8b949e;
        }
        
        .choice-btn::after {
            content: "â€º";
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.5rem;
            color: #f778ba;
            opacity: 0.8;
        }
        
        /* Description for choice */
        .choice-desc {
            font-size: 0.85rem;
            color: #8b949e;
            margin-top: 0.3rem;
        }
        
        /* Game Menu */
        #game-menu {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(13, 17, 23, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 20;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s;
            backdrop-filter: blur(5px);
        }
        
        .menu-title {
            font-size: 1.8rem;
            color: #f778ba;
            margin-bottom: 2rem;
            text-shadow: 0 0 10px rgba(247, 120, 186, 0.5);
        }
        
        .menu-btn {
            width: 80%;
            max-width: 280px;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #21262d;
            border: 1px solid #30363d;
            color: #e6edf3;
        }
        
        .menu-btn:hover {
            background-color: #30363d;
            border-color: #f778ba;
        }
        
        .menu-btn::before {
            margin-right: 1rem;
            font-size: 1.2rem;
            color: #f778ba;
        }
        
        #inventory-btn::before {
            content: "ğŸ’";
        }
        
        #map-btn::before {
            content: "ğŸ—ºï¸";
        }
        
        #status-btn::before {
            content: "ğŸ“Š";
        }
        
        #memory-btn::before {
            content: "ğŸ’«";
        }
        
        #log-btn::before {
            content: "ğŸ“";
        }
        
        #save-btn::before {
            content: "ğŸ’¾";
        }
        
        #close-menu-btn::before {
            content: "â†©ï¸";
        }
        
        /* Sub-screens (Map, Inventory, etc.) */
        .sub-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #0d1117;
            z-index: 15;
            padding: 1.2rem;
            display: flex;
            flex-direction: column;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s;
            overflow-y: auto;
        }
        
        .screen-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 0.8rem;
            border-bottom: 2px solid #30363d;
            position: sticky;
            top: 0;
            background-color: #0d1117;
            z-index: 2;
        }
        
        .screen-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #f778ba;
        }
        
        .back-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #21262d;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            font-size: 1.2rem;
            color: #e6edf3;
            border: 1px solid #30363d;
        }
        
        .back-btn:active {
            transform: scale(0.95);
            background-color: #30363d;
        }
        
        /* Map Screen */
        .location-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 0.6rem;
            padding-bottom: 1rem;
        }
        
        .location-item {
            background-color: #21262d;
            border-radius: 12px;
            height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
            border: 1px solid #30363d;
        }
        
        .location-item:active {
            transform: translateY(3px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            background-color: #30363d;
        }
        
        .location-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }
        
        .location-name {
            font-size: 0.9rem;
            color: #e6edf3;
            font-weight: bold;
        }
        
        .current-location {
            border: 2px solid #f778ba;
            background-color: rgba(247, 120, 186, 0.1);
        }
        
        .current-location .location-name {
            color: #f778ba;
        }
        
        /* Status Screen */
        .status-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 0.8rem;
            margin-bottom: 1rem;
        }
        
        .status-bar-item {
            background-color: #21262d;
            border-radius: 10px;
            padding: 1rem 1.2rem;
            border: 1px solid #30363d;
        }
        
        .status-bar-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }
        
        .status-bar-label {
            font-weight: bold;
            color: #e6edf3;
        }
        
        .status-bar-value {
            color: #f778ba;
            font-weight: bold;
        }
        
        .progress-bar {
            height: 12px;
            background-color: #30363d;
            border-radius: 6px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #f778ba, #da5e9b);
            transition: width 0.5s;
            border-radius: 6px;
        }
        
        /* Inventory Screen */
        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.8rem;
            margin-top: 0.6rem;
            padding-bottom: 1rem;
        }
        
        .inventory-item {
            background-color: #21262d;
            border-radius: 10px;
            height: 5.5rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
            transition: all 0.3s;
            border: 1px solid #30363d;
        }
        
        .inventory-item:active {
            background-color: #30363d;
            transform: translateY(2px);
        }
        
        .inventory-icon {
            font-size: 2rem;
            margin-bottom: 0.3rem;
        }
        
        .inventory-name {
            font-size: 0.8rem;
            color: #e6edf3;
            text-align: center;
            padding: 0 0.3rem;
        }
        
        /* Item Detail Modal */
        #item-detail-modal {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(13, 17, 23, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 25;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s;
            backdrop-filter: blur(5px);
        }
        
        .item-detail-container {
            width: 85%;
            max-width: 320px;
            background-color: #21262d;
            border-radius: 15px;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            border: 1px solid #30363d;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        
        .item-detail-header {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
            width: 100%;
        }
        
        .item-detail-icon {
            font-size: 2.5rem;
            margin-right: 1rem;
        }
        
        .item-detail-name {
            font-size: 1.3rem;
            font-weight: bold;
            color: #f778ba;
        }
        
        .item-detail-description {
            font-size: 1rem;
            color: #c9d1d9;
            margin-bottom: 1.8rem;
            text-align: center;
            line-height: 1.5;
        }
        
        .item-detail-buttons {
            display: flex;
            justify-content: space-around;
            width: 100%;
        }
        
        .item-detail-btn {
            padding: 0.7rem 1.2rem;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            font-weight: bold;
            border: none;
            transition: all 0.3s;
        }
        
        .use-btn {
            background-color: #f778ba;
            color: #0d1117;
            flex: 2;
            margin-right: 10px;
        }
        
        .use-btn:active {
            background-color: #da5e9b;
            transform: translateY(2px);
        }
        
        .cancel-btn {
            background-color: #30363d;
            color: #e6edf3;
            flex: 1;
        }
        
        .cancel-btn:active {
            background-color: #484f58;
            transform: translateY(2px);
        }
        
        /* Memory Log Screen */
        .memory-log-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.8rem;
            padding-bottom: 1rem;
        }
        
        .memory-log-item {
            background-color: #21262d;
            border-radius: 10px;
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
            position: relative;
            border: 1px solid #30363d;
            transition: all 0.3s;
        }
        
        .memory-log-item:active {
            transform: translateY(2px);
            background-color: #30363d;
        }
        
        .memory-log-item.locked {
            background-color: #161b22;
            color: #484f58;
            border: 1px solid #30363d;
            cursor: default;
        }
        
        .memory-log-icon {
            font-size: 2rem;
            margin-bottom: 0.3rem;
            color: #f778ba;
        }
        
        .memory-log-item.locked .memory-log-icon {
            color: #484f58;
        }
        
        .memory-log-number {
            font-size: 0.8rem;
            font-weight: bold;
            color: #c9d1d9;
        }
        
        .memory-log-item.locked .memory-log-number {
            color: #6e7681;
        }
        
        /* Memory Log Modal */
        #memory-log-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(13, 17, 23, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 30;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s;
            backdrop-filter: blur(5px);
        }
        
        .memory-log-content {
            width: 90%;
            max-width: 400px;
            max-height: 80vh;
            background-color: #21262d;
            border-radius: 15px;
            padding: 1.5rem;
            overflow-y: auto;
            position: relative;
            border: 1px solid #30363d;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        
        .memory-log-close {
            position: absolute;
            top: 0.8rem;
            right: 0.8rem;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: #30363d;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            font-size: 1rem;
            color: #e6edf3;
            border: 1px solid #484f58;
        }
        
        .memory-log-close:active {
            transform: scale(0.95);
            background-color: #484f58;
        }
        
        .memory-log-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #f778ba;
            margin-bottom: 1.2rem;
            padding-right: 2rem;
        }
        
        .memory-log-text {
            font-size: 1rem;
            line-height: 1.6;
            color: #c9d1d9;
        }
        
        /* Game Log Screen */
        #log-container {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }
        
        .log-entry {
            background-color: #21262d;
            margin-bottom: 0.5rem;
            padding: 1rem;
            border-radius: 10px;
            border: 1px solid #30363d;
        }
        
        .log-entry.special {
            border-left: 3px solid #f778ba;
        }
        
        .log-heading {
            font-weight: bold;
            color: #f778ba;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }
        
        .log-text {
            font-size: 0.95rem;
            line-height: 1.5;
            color: #c9d1d9;
        }
        
        /* Memory Collected Screen */
        #memory-collected {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(13, 17, 23, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 25;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s;
            padding: 1.5rem;
            backdrop-filter: blur(10px);
        }
        
        #memory-title {
            color: #f778ba;
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 1.5rem;
            text-shadow: 0 0 10px rgba(247, 120, 186, 0.5);
            text-align: center;
        }
        
        #memory-content {
            background-color: #21262d;
            padding: 1.5rem;
            border-radius: 15px;
            width: 90%;
            max-height: 50vh;
            overflow-y: auto;
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 2rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            border: 1px solid #30363d;
            color: #c9d1d9;
        }
        
        #continue-btn {
            background-color: #f778ba;
            color: #0d1117;
            border: none;
            width: 150px;
            font-weight: bold;
        }
        
        #continue-btn:active {
            background-color: #da5e9b;
        }
        
        /* Notification */
        #notification {
            position: fixed;
            top: 70px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(13, 17, 23, 0.9);
            color: #f778ba;
            padding: 0.8rem 1.5rem;
            border-radius: 30px;
            font-size: 1rem;
            z-index: 30;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            border: 1px solid #f778ba;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            text-align: center;
            max-width: 250px;
            font-weight: bold;
        }
        
        /* Loading Screen */
        #loading-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1e253a 0%, #0d1117 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 50;
            transition: opacity 0.5s;
        }
        
        .loader {
            width: 60px;
            height: 60px;
            border: 5px solid #30363d;
            border-bottom-color: #f778ba;
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1.5s linear infinite;
            margin-bottom: 1.5rem;
        }
        
        @keyframes rotation {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
        
        #loading-text {
            color: #f778ba;
            font-size: 1.3rem;
            font-weight: bold;
            animation: pulse 2s infinite;
        }
        
        /* Responsive Adjustments */
        @media (max-height: 600px) {
            #scene-container {
                height: 30%;
                min-height: 150px;
            }
            
            #dialogue-text {
                max-height: 25vh;
                font-size: 0.95rem;
            }
            
            #choices-container {
                max-height: 30vh;
            }
            
            .choice-btn {
                padding: 0.7rem 1rem;
                font-size: 0.9rem;
            }
            
            .status-item {
                transform: scale(0.9);
            }
        }

        @media (min-height: 800px) {
            #dialogue-text {
                max-height: 35vh;
            }
            
            #choices-container {
                max-height: 40vh;
            }
        }

        /* Game Progress Indicator */
        .progress-indicator {
            position: absolute;
            bottom: 10px;
            left: 10px;
            font-size: 0.8rem;
            color: #8b949e;
            display: flex;
            align-items: center;
        }

        .progress-indicator-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #30363d;
            margin-right: 5px;
        }

        .progress-indicator-dot.active {
            background-color: #f778ba;
        }

        /* Special Effects */
        .scene-transition {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: black;
            opacity: 0;
            pointer-events: none;
            z-index: 40;
            transition: opacity 0.5s;
        }

        /* Highlight effect for new elements */
        @keyframes highlight {
            0% { box-shadow: 0 0 0 rgba(247, 120, 186, 0); }
            50% { box-shadow: 0 0 15px rgba(247, 120, 186, 0.8); }
            100% { box-shadow: 0 0 0 rgba(247, 120, 186, 0); }
        }

        .highlight {
            animation: highlight 2s ease-in-out;
        }
        
        /* Emergency Recovery Button */
        #recovery-button {
            position: fixed;
            bottom: 10px;
            right: 10px;
            z-index: 999;
            padding: 5px 10px;
            background-color: #f778ba;
            color: #0d1117;
            border: none;
            border-radius: 5px;
            display: none;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <!-- Loading Screen -->
        <div id="loading-screen">
            <span class="loader"></span>
            <div id="loading-text">åŠ è½½ä¸­...</div>
        </div>
        
        <!-- Title Screen -->
        <div id="title-screen">
            <div id="title-logo">å›½è‰¯è¯±æ•å™¨</div>
            <div class="btn" id="start-btn">å¼€å§‹æ¸¸æˆ</div>
            <div class="btn" id="load-btn">ç»§ç»­æ¸¸æˆ</div>
            <div class="btn" id="about-btn">å…³äºæ¸¸æˆ</div>
        </div>
        
        <!-- Game UI -->
        <div id="game-ui">
            <!-- Status Bar -->
            <div id="status-bar">
                <div class="status-item">
                    <div class="status-label">æ—¥æœŸ</div>
                    <div class="status-value" id="date-display">ç¬¬1å¤©</div>
                </div>
                <div class="status-item">
                    <div class="status-label">æ—¶é—´</div>
                    <div class="status-value" id="time-display">ä¸Šåˆ</div>
                </div>
                <div class="status-item">
                    <div class="status-label">ä½“åŠ›</div>
                    <div class="status-value" id="energy-display">100%</div>
                </div>
                <div class="status-item">
                    <div class="status-label">è®°å¿†</div>
                    <div class="status-value" id="memory-display">0/12</div>
                </div>
            </div>
            
            <!-- Scene Container -->
            <div id="scene-container">
                <div id="scene-bg">ğŸ«</div>
                <div id="character"><img src="https://pic1.imgdb.cn/item/66e83fc7d9c307b7e9977eda.png" alt="è§’è‰²" id="character-img"></div>
                <div id="menu-button">â‰¡</div>
            </div>
            
            <!-- Dialogue Box -->
            <div id="dialogue-box">
                <div id="speaker-name">ç³»ç»Ÿ</div>
                <div id="dialogue-text">æ¬¢è¿æ¥åˆ°ã€Šå›½è‰¯è¯±æ•å™¨ã€‹ï¼ä½ å°†æ‰®æ¼”ç»“åŸå¤å¥ˆï¼Œä¸€ä½å•†æ³•ä¸“ä¸šçš„å¤§äºŒå­¦ç”Ÿã€‚ä½ çš„ç›®æ ‡æ˜¯è¿½æ±‚æå›½è‰¯ï¼Œå¤§ä¸‰ç¯®çƒé˜Ÿçš„å­¦ç”Ÿæ•™ç»ƒã€‚ç‚¹å‡»å±å¹•ç»§ç»­...</div>
                <div id="tap-indicator">â–¼</div>
                <div id="choices-container"></div>
                <div class="progress-indicator">
                    <div class="progress-indicator-dot active"></div>
                    <div class="progress-indicator-dot"></div>
                    <div class="progress-indicator-dot"></div>
                </div>
            </div>
        </div>
        
        <!-- Game Menu -->
        <div id="game-menu">
            <div class="menu-title">æ¸¸æˆèœå•</div>
            <div class="btn menu-btn" id="inventory-btn">ç‰©å“æ </div>
            <div class="btn menu-btn" id="map-btn">åœ°å›¾</div>
            <div class="btn menu-btn" id="status-btn">å±æ€§</div>
            <div class="btn menu-btn" id="memory-btn">è®°å¿†æ”¶é›†</div>
            <div class="btn menu-btn" id="log-btn">æ¸¸æˆæ—¥å¿—</div>
            <div class="btn menu-btn" id="save-btn">ä¿å­˜æ¸¸æˆ</div>
            <div class="btn menu-btn" id="close-menu-btn">è¿”å›æ¸¸æˆ</div>
        </div>
        
        <!-- Map Screen -->
        <div id="map-screen" class="sub-screen">
            <div class="screen-header">
                <div class="screen-title">åœ°å›¾</div>
                <div class="back-btn">â†</div>
            </div>
            <div class="location-grid">
                <div class="location-item" data-location="apartment">
                    <div class="location-icon">ğŸ </div>
                    <div class="location-name">å…¬å¯“</div>
                </div>
                <div class="location-item" data-location="basketball-court">
                    <div class="location-icon">ğŸ€</div>
                    <div class="location-name">ç¯®çƒåœº</div>
                </div>
                <div class="location-item" data-location="library">
                    <div class="location-icon">ğŸ“š</div>
                    <div class="location-name">å›¾ä¹¦é¦†</div>
                </div>
                <div class="location-item" data-location="cafe">
                    <div class="location-icon">â˜•</div>
                    <div class="location-name">å’–å•¡å…</div>
                </div>
                <div class="location-item" data-location="park">
                    <div class="location-icon">ğŸŒ³</div>
                    <div class="location-name">å…¬å›­</div>
                </div>
                <div class="location-item" data-location="gym">
                    <div class="location-icon">ğŸ’ª</div>
                    <div class="location-name">å¥èº«æˆ¿</div>
                </div>
                <div class="location-item" data-location="classroom">
                    <div class="location-icon">ğŸ«</div>
                    <div class="location-name">æ•™å®¤</div>
                </div>
                <div class="location-item" data-location="office">
                    <div class="location-icon">ğŸ§‘â€ğŸ’¼</div>
                    <div class="location-name">æ•™å¸ˆåŠå…¬å®¤</div>
                </div>
            </div>
        </div>
        
        <!-- Inventory Screen -->
        <div id="inventory-screen" class="sub-screen">
            <div class="screen-header">
                <div class="screen-title">ç‰©å“æ </div>
                <div class="back-btn">â†</div>
            </div>
            <div class="inventory-grid" id="inventory-grid">
                <!-- ç‰©å“å°†é€šè¿‡JSåŠ¨æ€æ·»åŠ  -->
            </div>
        </div>
        
        <!-- Status Screen -->
        <div id="status-screen" class="sub-screen">
            <div class="screen-header">
                <div class="screen-title">å±æ€§é¢æ¿</div>
                <div class="back-btn">â†</div>
            </div>
            <div class="status-grid">
                <div class="status-bar-item">
                    <div class="status-bar-header">
                        <div class="status-bar-label">é­…åŠ›</div>
                        <div class="status-bar-value" id="charm-value">20/100</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="charm-bar" style="width: 20%;"></div>
                    </div>
                </div>
                <div class="status-bar-item">
                    <div class="status-bar-header">
                        <div class="status-bar-label">æ™ºæ…§</div>
                        <div class="status-bar-value" id="wisdom-value">25/100</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="wisdom-bar" style="width: 25%;"></div>
                    </div>
                </div>
                <div class="status-bar-item">
                    <div class="status-bar-header">
                        <div class="status-bar-label">ä½“åŠ›</div>
                        <div class="status-bar-value" id="stamina-value">100/100</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="stamina-bar" style="width: 100%;"></div>
                    </div>
                </div>
                <div class="status-bar-item">
                    <div class="status-bar-header">
                        <div class="status-bar-label">å•†æ³•çŸ¥è¯†</div>
                        <div class="status-bar-value" id="law-value">40/100</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="law-bar" style="width: 40%;"></div>
                    </div>
                </div>
                <div class="status-bar-item">
                    <div class="status-bar-header">
                        <div class="status-bar-label">ç¯®çƒæŠ€èƒ½</div>
                        <div class="status-bar-value" id="basketball-value">10/100</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="basketball-bar" style="width: 10%;"></div>
                    </div>
                </div>
                <div class="status-bar-item">
                    <div class="status-bar-header">
                        <div class="status-bar-label">çƒ¹é¥ªèƒ½åŠ›</div>
                        <div class="status-bar-value" id="cooking-value">15/100</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="cooking-bar" style="width: 15%;"></div>
                    </div>
                </div>
                <div class="status-bar-item">
                    <div class="status-bar-header">
                        <div class="status-bar-label">å›½è‰¯å¥½æ„Ÿåº¦</div>
                        <div class="status-bar-value" id="affection-value">0/100</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="affection-bar" style="width: 0%;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Memory Collection Screen -->
        <div id="memory-log-screen" class="sub-screen">
            <div class="screen-header">
                <div class="screen-title">è®°å¿†ç¢ç‰‡</div>
                <div class="back-btn">â†</div>
            </div>
            <div class="memory-log-grid" id="memory-log-grid">
                <!-- è®°å¿†ç¢ç‰‡å°†é€šè¿‡JSåŠ¨æ€æ·»åŠ  -->
            </div>
        </div>
        
        <!-- Game Log Screen -->
        <div id="log-screen" class="sub-screen">
            <div class="screen-header">
                <div class="screen-title">æ¸¸æˆæ—¥å¿—</div>
                <div class="back-btn">â†</div>
            </div>
            <div id="log-container">
                <!-- æ—¥å¿—å°†é€šè¿‡JSåŠ¨æ€æ·»åŠ  -->
            </div>
        </div>
        
        <!-- Item Detail Modal -->
        <div id="item-detail-modal">
            <div class="item-detail-container">
                <div class="item-detail-header">
                    <div class="item-detail-icon" id="item-detail-icon">ğŸ“˜</div>
                    <div class="item-detail-name" id="item-detail-name">ç¯®çƒå…¥é—¨</div>
                </div>
                <div class="item-detail-description" id="item-detail-description">æé«˜ç¯®çƒæŠ€èƒ½çš„ä¹¦ç±</div>
                <div class="item-detail-buttons">
                    <button class="item-detail-btn use-btn" id="use-item-btn">ä½¿ç”¨</button>
                    <button class="item-detail-btn cancel-btn" id="cancel-item-btn">å–æ¶ˆ</button>
                </div>
            </div>
        </div>
        
        <!-- Memory Detail Modal -->
        <div id="memory-log-modal">
            <div class="memory-log-content">
                <div class="memory-log-close">âœ•</div>
                <h3 class="memory-log-title" id="memory-log-modal-title">è®°å¿†ç¢ç‰‡ï¼šåˆæ¬¡ç›¸é‡</h3>
                <div class="memory-log-text" id="memory-log-modal-text">
                    ä½ æƒ³èµ·äº†ä¸€ä¸ªæ¨¡ç³Šçš„åœºæ™¯ï¼Œåœ¨ä¸€ä¸ªæ˜äº®çš„æ•™å®¤é‡Œï¼Œæœ‰ä¸€ä¸ªé«˜å¤§çš„èº«å½±ååœ¨ä½ æ—è¾¹ã€‚ä»–åœ¨å¸®ä½ è§£ç­”å•†æ³•è¯¾é¢˜ï¼Œä½ ä»¬çœ‹èµ·æ¥å¾ˆç†Ÿæ‚‰...
                </div>
            </div>
        </div>
        
        <!-- Notification -->
        <div id="notification">å±æ€§æå‡ï¼</div>
        
        <!-- Memory Collection Popup -->
        <div id="memory-collected">
            <div id="memory-title">è®°å¿†ç¢ç‰‡æ”¶é›†</div>
            <div id="memory-content">ä½ å‘ç°äº†ä¸€æ®µè¢«é—å¿˜çš„è®°å¿†...</div>
            <div class="btn" id="continue-btn">ç»§ç»­</div>
        </div>

        <!-- Scene Transition Effect -->
        <div class="scene-transition"></div>
        
        <!-- Emergency Recovery Button -->
        <button id="recovery-button">æ¢å¤æ¸¸æˆ</button>
    </div>

    <script>
        // æ¸¸æˆæ•°æ®
        let gameData = {
            player: {
                name: "ç»“åŸå¤å¥ˆ",
                attributes: {
                    charm: 20,
                    wisdom: 25,
                    stamina: 100,
                    law: 40,
                    basketball: 10,
                    cooking: 15
                },
                inventory: [],
                memoryFragments: []
            },
            characters: {
                guoliang: {
                    name: "æå›½è‰¯",
                    affection: 0,
                    metFlag: false
                },
                misaki: {
                    name: "ç›¸æ³½ç¾å’²",
                    metFlag: false
                }
            },
            gameState: {
                day: 1,
                time: "morning", // morning, afternoon, evening
                location: "apartment",
                storyFlag: 0,
                energyLeft: 3,
                completedEvents: [],
                gameLog: [] // æ¸¸æˆæ—¥å¿—
            }
        };

        // ç‰©å“æ•°æ®
        const itemsData = {
            basketballBook: {
                id: "basketballBook",
                name: "ç¯®çƒå…¥é—¨",
                icon: "ğŸ“˜",
                description: "æé«˜ç¯®çƒæŠ€èƒ½çš„ä¹¦ç±ï¼Œä½¿ç”¨åç¯®çƒæŠ€èƒ½+5ã€‚",
                effect: {type: "attribute", target: "basketball", value: 5}
            },
            lawBook: {
                id: "lawBook",
                name: "å•†æ³•æ•™æ",
                icon: "ğŸ“š",
                description: "æé«˜å•†æ³•çŸ¥è¯†çš„æ•™æï¼Œä½¿ç”¨åå•†æ³•çŸ¥è¯†+5ã€‚",
                effect: {type: "attribute", target: "law", value: 5}
            },
            sportsDrink: {
                id: "sportsDrink",
                name: "è¿åŠ¨é¥®æ–™",
                icon: "ğŸ¥¤",
                description: "æ¢å¤å°‘é‡ä½“åŠ›ï¼Œä½¿ç”¨åä½“åŠ›+20ã€‚",
                effect: {type: "attribute", target: "stamina", value: 20}
            },
            chocolates: {
                id: "chocolates",
                name: "å·§å…‹åŠ›ç¤¼ç›’",
                icon: "ğŸ«",
                description: "ç»™æå›½è‰¯çš„ç¤¼ç‰©ï¼Œä½¿ç”¨åå¥½æ„Ÿåº¦+10ã€‚",
                effect: {type: "affection", value: 10}
            },
            homemadeCookies: {
                id: "homemadeCookies",
                name: "æ‰‹å·¥é¥¼å¹²",
                icon: "ğŸª",
                description: "è‡ªåˆ¶ç‚¹å¿ƒï¼Œä½¿ç”¨åå¥½æ„Ÿåº¦+15ã€‚",
                effect: {type: "affection", value: 15}
            },
            photoAlbum: {
                id: "photoAlbum",
                name: "æ ¡å‹ç›¸å†Œ",
                icon: "ğŸ“”",
                description: "è®°å½•å­¦æ ¡å¾€å¹´çš„ç…§ç‰‡ï¼Œä½¿ç”¨åè·å¾—è®°å¿†ç¢ç‰‡ã€‚",
                effect: {type: "memory", id: "memory2"}
            },
            perfume: {
                id: "perfume",
                name: "é¦™æ°´",
                icon: "ğŸ§´",
                description: "æé«˜é­…åŠ›å€¼ï¼Œä½¿ç”¨åé­…åŠ›+10ã€‚",
                effect: {type: "attribute", target: "charm", value: 10}
            },
            cookbook: {
                id: "cookbook",
                name: "é£Ÿè°±",
                icon: "ğŸ“•",
                description: "æé«˜çƒ¹é¥ªèƒ½åŠ›ï¼Œä½¿ç”¨åçƒ¹é¥ª+10ã€‚",
                effect: {type: "attribute", target: "cooking", value: 10}
            }
        };

        // è®°å¿†ç¢ç‰‡æ•°æ®
        const memoryFragmentsData = {
            memory1: {
                id: "memory1",
                title: "è®°å¿†ç¢ç‰‡ï¼šåˆæ¬¡ç›¸é‡",
                content: "ä½ æƒ³èµ·äº†ä¸€ä¸ªæ¨¡ç³Šçš„åœºæ™¯ï¼Œåœ¨ä¸€ä¸ªæ˜äº®çš„æ•™å®¤é‡Œï¼Œæœ‰ä¸€ä¸ªé«˜å¤§çš„èº«å½±ååœ¨ä½ æ—è¾¹ã€‚ä»–åœ¨å¸®ä½ è§£ç­”å•†æ³•è¯¾é¢˜ï¼Œä½ ä»¬çœ‹èµ·æ¥å¾ˆç†Ÿæ‚‰..."
            },
            memory2: {
                id: "memory2",
                title: "è®°å¿†ç¢ç‰‡ï¼šæ ¡å‹ç›¸å†Œä¸­çš„ç…§ç‰‡",
                content: "åœ¨æ ¡å‹ç›¸å†Œä¸­ï¼Œä½ å‘ç°äº†ä¸€å¼ åˆå½±ï¼Œç…§ç‰‡ä¸­çš„ä½ å’Œæå›½è‰¯ç«™åœ¨ä¸€èµ·ï¼Œçœ‹èµ·æ¥æ˜¯åŒä¸€ä¸ªç­çº§ã€‚ä½†ä½ ä¸ºä»€ä¹ˆæ²¡æœ‰è¿™æ®µè®°å¿†ï¼Ÿ"
            },
            memory3: {
                id: "memory3",
                title: "è®°å¿†ç¢ç‰‡ï¼šç¯®çƒæ¯”èµ›",
                content: "ä½ è®°èµ·åœ¨çœ‹å°ä¸Šæ¿€åŠ¨åœ°å‘å–Šï¼Œä¸ºåœºä¸Šçš„æå›½è‰¯åŠ æ²¹ã€‚ä»–æ˜¯çƒé˜Ÿçš„æ˜æ˜Ÿçƒå‘˜ï¼Œä½†åœ¨ä¸€æ¬¡å…³é”®æ‰£ç¯®åï¼Œä»–çš„è½åœ°å§¿åŠ¿ä¸å¯¹..."
            },
            memory4: {
                id: "memory4",
                title: "è®°å¿†ç¢ç‰‡ï¼šåŒ»é™¢çš„æ—¥å­",
                content: "ä¸€æ®µåœ¨åŒ»é™¢çš„è®°å¿†é—ªå›ï¼Œä½ æ¯å¤©éƒ½å»çœ‹æœ›è†ç›–å—ä¼¤çš„æå›½è‰¯ï¼Œä¸ºä»–å¸¦å»å­¦ä¹ èµ„æ–™å’Œé¼“åŠ±ã€‚ä½ ä»¬çš„å…³ç³»æ¯”æ™®é€šåŒå­¦äº²å¯†å¾—å¤šã€‚"
            },
            memory5: {
                id: "memory5",
                title: "è®°å¿†ç¢ç‰‡ï¼šæ¨±èŠ±æ ‘ä¸‹çš„çº¦å®š",
                content: "æ¨±èŠ±æ ‘ä¸‹ï¼Œæå›½è‰¯æ¡ç€ä½ çš„æ‰‹ï¼Œè¯´ï¼š'ç­‰æˆ‘æˆä¸ºæ•™ç»ƒçš„é‚£å¤©ï¼Œä½ è¦ç­”åº”åšæˆ‘çš„å¥³æœ‹å‹ã€‚'ä½ ç¬‘ç€ç‚¹å¤´ç­”åº”äº†ã€‚"
            },
            memory6: {
                id: "memory6",
                title: "è®°å¿†ç¢ç‰‡ï¼šå¤±æ„çš„å¤œæ™š",
                content: "ä¸€ä¸ªé›¨å¤œï¼Œæå›½è‰¯å‘Šè¯‰ä½ ä»–å› ä¸ºè†ä¼¤æ— æ³•ç»§ç»­èŒä¸šç¯®çƒçš„æ¢¦æƒ³ï¼Œä½ ç´§ç´§æŠ±ä½ä»–ï¼Œå‘Šè¯‰ä»–ä½ ä¼šä¸€ç›´æ”¯æŒä»–ã€‚"
            },
            memory7: {
                id: "memory7",
                title: "è®°å¿†ç¢ç‰‡ï¼šæ•™ç»ƒä¹‹è·¯",
                content: "ä½ è®°å¾—è‡ªå·±é¼“åŠ±æå›½è‰¯è½¬å‹ä¸ºæ•™ç»ƒï¼Œè¯´ä»–æœ‰æ•™å¯¼ä»–äººçš„å¤©èµ‹ã€‚ä»–å› ä¸ºä½ çš„è¯é‡æ–°ç‡ƒèµ·äº†å¯¹ç¯®çƒçš„çƒ­æƒ…ã€‚"
            },
            memory8: {
                id: "memory8",
                title: "è®°å¿†ç¢ç‰‡ï¼šæ„å¤–çš„é‚£å¤©",
                content: "ä¸€ä¸ªé›¨å¤©ï¼Œä½ ä¸ºäº†èµ¶å»ç»™æå›½è‰¯é€ä¸œè¥¿ï¼Œåœ¨æ ¡å›­é‡Œè·‘å¾—å¤ªå¿«ï¼Œç„¶åæ˜¯ä¸€ç‰‡é»‘æš—...æ¥ç€ä½ åœ¨åŒ»é™¢é†’æ¥ï¼Œæ„Ÿè§‰å¾ˆå¤šè®°å¿†éƒ½æ¨¡ç³Šäº†ã€‚"
            },
            memory9: {
                id: "memory9",
                title: "è®°å¿†ç¢ç‰‡ï¼šçˆ¶æ¯çš„å†³å®š",
                content: "åŒ»é™¢çš„å¯¹è¯ä¸­ï¼Œä½ éšçº¦å¬åˆ°çˆ¶æ¯å’ŒåŒ»ç”Ÿçš„å¯¹è¯ï¼Œè¯´æ˜¯å› ä¸ºæ„å¤–å¯¹ä½ çš„å¤§è„‘æœ‰å½±å“ï¼Œæœ€å¥½ä¸è¦å—åˆ°å¤ªå¤§åˆºæ¿€ã€‚ä½ è¢«è½¬å­¦åˆ°äº†å•†æ³•ä¸“ä¸šã€‚"
            },
            memory10: {
                id: "memory10",
                title: "è®°å¿†ç¢ç‰‡ï¼šæå›½è‰¯çš„é€‰æ‹©",
                content: "ç—…æˆ¿å¤–ï¼Œæå›½è‰¯ä¸ä½ çš„çˆ¶æ¯äº¤è°ˆï¼ŒåŒæ„æš‚æ—¶ä¸æ‰“æ‰°ä½ ï¼Œè®©ä½ è‡ªç„¶æ¢å¤è®°å¿†ã€‚ä»–é€‰æ‹©åœ¨æš—ä¸­ç­‰å¾…ä½ ï¼Œå±¥è¡Œä½ ä»¬çš„çº¦å®šã€‚"
            },
            memory11: {
                id: "memory11",
                title: "è®°å¿†ç¢ç‰‡ï¼šå•†æ³•æ‰èƒ½",
                content: "ä½ æƒ³èµ·è‡ªå·±åœ¨ä¸Šå•†æ³•é€‰ä¿®è¯¾æ—¶å±•ç°å‡ºçš„å¤©èµ‹ï¼Œè¿™è®©æå›½è‰¯å¾ˆæƒŠè®¶ã€‚ä»–ä¸€ç›´é¼“åŠ±ä½ å‘å±•è¿™æ–¹é¢çš„èƒ½åŠ›ã€‚"
            },
            memory12: {
                id: "memory12",
                title: "è®°å¿†ç¢ç‰‡ï¼šå®Œæ•´çš„è¿‡å»",
                content: "æ‰€æœ‰è®°å¿†ç¢ç‰‡è¿æ¥åœ¨ä¸€èµ·ï¼Œä½ ç»ˆäºæƒ³èµ·äº†å®Œæ•´çš„è¿‡å»ï¼šä½ å’Œæå›½è‰¯æ˜¯é«˜ä¸­åŒå­¦ï¼Œä¸€èµ·é€‰ä¿®äº†å•†æ³•è¯¾ç¨‹ã€‚ä½ ä»¬ç›¸çˆ±ï¼Œä»–å› ä¿æŠ¤ä½ åœ¨æ¯”èµ›ä¸­å—ä¼¤ï¼Œä½ å› è‡ªè´£å¯¼è‡´æ„å¤–å¤±å¿†ã€‚ç°åœ¨ï¼Œå‘½è¿è®©ä½ ä»¬å†æ¬¡ç›¸é‡ï¼Œå±¥è¡Œæ¨±èŠ±æ ‘ä¸‹çš„çº¦å®šã€‚"
            }
        };

        // å®šä¹‰åœºæ™¯å’Œäº‹ä»¶æ•°æ®
        const locationsData = {
            apartment: {
                name: "å…¬å¯“",
                icon: "ğŸ ",
                description: "ä½ çš„å±…ä½åœ°ï¼Œå¯ä»¥ä¼‘æ¯æ¢å¤ä½“åŠ›ã€‚",
                events: ["rest", "study", "cook"]
            },
            "basketball-court": {
                name: "ç¯®çƒåœº",
                icon: "ğŸ€",
                description: "æ ¡ç¯®çƒé˜Ÿè®­ç»ƒçš„åœ°æ–¹ï¼Œæå›½è‰¯ç»å¸¸åœ¨è¿™é‡Œã€‚",
                events: ["watchTraining", "practiceBasketball", "meetGuoliang"]
            },
            library: {
                name: "å›¾ä¹¦é¦†",
                icon: "ğŸ“š",
                description: "å­¦ä¹ çš„å¥½åœ°æ–¹ï¼Œå¯ä»¥æé«˜çŸ¥è¯†ã€‚",
                events: ["studyLaw", "readBooks", "meetClassmate"]
            },
            cafe: {
                name: "å’–å•¡å…",
                icon: "â˜•",
                description: "æ ¡å›­é™„è¿‘çš„å’–å•¡å…ï¼Œæ˜¯æ”¾æ¾å’Œç¤¾äº¤çš„å¥½åœ°æ–¹ã€‚",
                events: ["drinkCoffee", "meetFriends", "contractEvent"]
            },
            park: {
                name: "å…¬å›­",
                icon: "ğŸŒ³",
                description: "æ ¡å›­å†…çš„å°å…¬å›­ï¼Œæ¨±èŠ±æ ‘ä¸‹æ˜¯ä¸ªç‰¹åˆ«çš„åœ°æ–¹ã€‚",
                events: ["relax", "cherryBlossomMemory", "exercise"]
            },
            gym: {
                name: "å¥èº«æˆ¿",
                icon: "ğŸ’ª",
                description: "æ ¡å›­å¥èº«ä¸­å¿ƒï¼Œå¯ä»¥æé«˜ä½“åŠ›ã€‚",
                events: ["workout", "rehabilitationTraining", "meetMisaki"]
            },
            classroom: {
                name: "æ•™å®¤",
                icon: "ğŸ«",
                description: "ä¸Šè¯¾çš„åœ°æ–¹ï¼Œå¯ä»¥æé«˜å­¦æœ¯çŸ¥è¯†ã€‚",
                events: ["attendClass", "groupStudy", "presentationEvent"]
            },
            office: {
                name: "æ•™å¸ˆåŠå…¬å®¤",
                icon: "ğŸ§‘â€ğŸ’¼",
                description: "æ•™æˆä»¬çš„åŠå…¬å®¤ï¼Œå¯ä»¥è·å–å­¦ä¹ å»ºè®®ã€‚",
                events: ["meetProfessor", "seekAdvice", "helpGrading"]
            }
        };

        // å®šä¹‰äº‹ä»¶æ•°æ®
        const eventsData = {
            // å…¬å¯“äº‹ä»¶
            rest: {
                name: "ä¼‘æ¯",
                description: "ä¼‘æ¯ä¸€ä¼šå„¿ï¼Œæ¢å¤ä½“åŠ›ã€‚",
                energyCost: 0,
                requirements: {},
                execute: function() {
                    changeAttribute("stamina", 50);
                    addToLog("æ´»åŠ¨", "ä½ åœ¨å…¬å¯“é‡Œå¥½å¥½ä¼‘æ¯äº†ä¸€ä¼šå„¿ï¼Œæ¢å¤äº†ä¸å°‘ä½“åŠ›ã€‚");
                    return {
                        dialogue: [
                            {speaker: "ç³»ç»Ÿ", text: "ä½ åœ¨å…¬å¯“é‡Œå¥½å¥½ä¼‘æ¯äº†ä¸€ä¼šå„¿ï¼Œæ¢å¤äº†ä¸å°‘ä½“åŠ›ã€‚"}
                        ],
                        choices: []
                    };
                }
            },
            study: {
                name: "è‡ªä¹ ",
                description: "åœ¨å®¶å­¦ä¹ æé«˜çŸ¥è¯†ã€‚",
                energyCost: 1,
                requirements: {},
                execute: function() {
                    changeAttribute("wisdom", 5);
                    changeAttribute("law", 3);
                    addToLog("æ´»åŠ¨", "ä½ è®¤çœŸåœ°å¤ä¹ äº†å•†æ³•è¯¾ç¨‹ï¼ŒçŸ¥è¯†å’Œæ™ºæ…§éƒ½æœ‰æ‰€æå‡ã€‚");
                    return {
                        dialogue: [
                            {speaker: "ç³»ç»Ÿ", text: "ä½ è®¤çœŸåœ°å¤ä¹ äº†å•†æ³•è¯¾ç¨‹ï¼ŒçŸ¥è¯†å’Œæ™ºæ…§éƒ½æœ‰æ‰€æå‡ã€‚"}
                        ],
                        choices: []
                    };
                }
            },
            cook: {
                name: "çƒ¹é¥ª",
                description: "å°è¯•åšä¸€äº›ç¾é£Ÿï¼Œæé«˜çƒ¹é¥ªèƒ½åŠ›ã€‚",
                energyCost: 1,
                requirements: {},
                execute: function() {
                    changeAttribute("cooking", 3);
                    const cookingValue = gameData.player.attributes.cooking;
                    addToLog("æ´»åŠ¨", "ä½ å°è¯•çƒ¹é¥ªäº†ä¸€äº›ç‚¹å¿ƒï¼Œçƒ¹é¥ªèƒ½åŠ›å¾—åˆ°æå‡ã€‚");
                    if (cookingValue >= 30 && !hasItem("homemadeCookies")) {
                        addToInventory("homemadeCookies");
                        addToLog("è·å¾—ç‰©å“", "ä½ æˆåŠŸåšå‡ºäº†ç¾å‘³çš„æ‰‹å·¥é¥¼å¹²ï¼");
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ å°è¯•çƒ¹é¥ªäº†ä¸€äº›ç‚¹å¿ƒï¼Œçƒ¹é¥ªèƒ½åŠ›å¾—åˆ°æå‡ã€‚ä½ æˆåŠŸåšå‡ºäº†ç¾å‘³çš„æ‰‹å·¥é¥¼å¹²ï¼"},
                                {speaker: "å¤å¥ˆ", text: "è¿™æ¬¡çš„é¥¼å¹²çœ‹èµ·æ¥å¾ˆä¸é”™ï¼Œä¹Ÿè®¸å¯ä»¥é€ç»™æå›½è‰¯å°å°..."}
                            ],
                            choices: []
                        };
                    } else {
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ å°è¯•çƒ¹é¥ªäº†ä¸€äº›ç‚¹å¿ƒï¼Œçƒ¹é¥ªèƒ½åŠ›å¾—åˆ°æå‡ã€‚"}
                            ],
                            choices: []
                        };
                    }
                }
            },
            
            // ç¯®çƒåœºäº‹ä»¶
            watchTraining: {
                name: "è§‚çœ‹è®­ç»ƒ",
                description: "è§‚çœ‹ç¯®çƒé˜Ÿè®­ç»ƒã€‚",
                energyCost: 1,
                requirements: {},
                execute: function() {
                    changeAttribute("basketball", 2);
                    addToLog("æ´»åŠ¨", "ä½ è§‚çœ‹äº†ç¯®çƒé˜Ÿçš„è®­ç»ƒï¼Œå¯¹ç¯®çƒæœ‰äº†æ›´å¤šäº†è§£ã€‚");
                    if (!gameData.characters.guoliang.metFlag && gameData.gameState.storyFlag === 0) {
                        gameData.characters.guoliang.metFlag = true;
                        gameData.gameState.storyFlag = 1;
                        addToLog("å‰§æƒ…", "ä½ åœ¨ç¯®çƒåœºç¬¬ä¸€æ¬¡è§åˆ°äº†æå›½è‰¯ï¼Œä»–æ˜¯ç¯®çƒé˜Ÿçš„å­¦ç”Ÿæ•™ç»ƒã€‚");
                        return firstMeetingEvent();
                    } else {
                        return {
                            dialogue: [{speaker: "ç³»ç»Ÿ", text: "ä½ è§‚çœ‹äº†ç¯®çƒé˜Ÿçš„è®­ç»ƒï¼Œå¯¹ç¯®çƒæœ‰äº†æ›´å¤šäº†è§£ã€‚"},
                                {speaker: "å¤å¥ˆ", text: "ä»–ä»¬è®­ç»ƒå¾—çœŸè®¤çœŸï¼Œç‰¹åˆ«æ˜¯æå›½è‰¯æ•™ç»ƒï¼ŒæŒ‡å¯¼å¾—å¾ˆä¸“ä¸šã€‚"}
                            ],
                            choices: []
                        };
                    }
                }
            },
            practiceBasketball: {
                name: "ç»ƒä¹ ç¯®çƒ",
                description: "å°è¯•è‡ªå·±ç»ƒä¹ ä¸€ä¸‹ç¯®çƒã€‚",
                energyCost: 2,
                requirements: {},
                execute: function() {
                    changeAttribute("basketball", 5);
                    changeAttribute("stamina", -10);
                    addToLog("æ´»åŠ¨", "ä½ åœ¨çƒåœºä¸€è§’ç»ƒä¹ æŠ•ç¯®ï¼Œç¯®çƒæŠ€èƒ½æœ‰æ‰€æå‡ï¼Œæ¶ˆè€—äº†ä¸€äº›ä½“åŠ›ã€‚");
                    
                    const basketballSkill = gameData.player.attributes.basketball;
                    if (basketballSkill >= 25 && gameData.characters.guoliang.metFlag && gameData.characters.guoliang.affection >= 15 && !hasCompleted("basketballTraining")) {
                        completeEvent("basketballTraining");
                        addToLog("å‰§æƒ…", "æå›½è‰¯æ³¨æ„åˆ°ä½ åœ¨ç»ƒä¹ ç¯®çƒï¼Œä¸»åŠ¨è¿‡æ¥æŒ‡å¯¼ä½ ã€‚");
                        return basketballTrainingEvent();
                    } else {
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ åœ¨çƒåœºä¸€è§’ç»ƒä¹ æŠ•ç¯®ï¼Œè™½ç„¶å¾ˆå¤šéƒ½æ²¡è¿›ï¼Œä½†ç¯®çƒæŠ€èƒ½æœ‰æ‰€æå‡ã€‚"},
                                {speaker: "å¤å¥ˆ", text: "åŸæ¥ç¯®çƒæ²¡é‚£ä¹ˆç®€å•å•Š...ä¸è¿‡æˆ‘ä¸ä¼šæ”¾å¼ƒçš„ï¼"}
                            ],
                            choices: []
                        };
                    }
                }
            },
            meetGuoliang: {
                name: "å¯»æ‰¾æå›½è‰¯",
                description: "å°è¯•åœ¨ç¯®çƒåœºæ‰¾åˆ°æå›½è‰¯ã€‚",
                energyCost: 1,
                requirements: {
                    flags: ["metGuoliang"]
                },
                available: function() {
                    return gameData.characters.guoliang.metFlag;
                },
                execute: function() {
                    addToLog("æ´»åŠ¨", "ä½ åœ¨ç¯®çƒåœºå¯»æ‰¾æå›½è‰¯ã€‚");
                    if (gameData.characters.guoliang.affection >= 10 && gameData.gameState.storyFlag === 1 && !hasCompleted("firstConversation")) {
                        completeEvent("firstConversation");
                        gameData.gameState.storyFlag = 2;
                        addToLog("å‰§æƒ…", "ä½ é¼“èµ·å‹‡æ°”ä¸æå›½è‰¯è¿›è¡Œäº†æ›´æ·±å…¥çš„äº¤è°ˆã€‚");
                        return deeperConversationEvent();
                    } else if (gameData.characters.guoliang.affection >= 30 && gameData.gameState.storyFlag === 3 && !hasCompleted("contractHelp")) {
                        addToLog("å‰§æƒ…", "ä½ å’Œæå›½è‰¯è®¨è®ºäº†ç¯®çƒé˜Ÿçš„èµåŠ©åˆåŒé—®é¢˜ã€‚");
                        return contractDiscussionEvent();
                    } else {
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ åœ¨ç¯®çƒåœºæ‰¾åˆ°äº†æå›½è‰¯ï¼Œä½†ä»–çœ‹èµ·æ¥æ­£å¿™ç€è®­ç»ƒé˜Ÿå‘˜ã€‚"},
                                {speaker: "å¤å¥ˆ", text: "ä»–çœ‹èµ·æ¥çœŸçš„å¾ˆå¿™ï¼Œä¹Ÿè®¸ç°åœ¨ä¸æ˜¯æ‰“æ‰°ä»–çš„å¥½æ—¶æœº..."}
                            ],
                            choices: []
                        };
                    }
                }
            },
            
            // å›¾ä¹¦é¦†äº‹ä»¶
            studyLaw: {
                name: "ç ”ç©¶å•†æ³•",
                description: "åœ¨å›¾ä¹¦é¦†ç ”ç©¶å•†æ³•çŸ¥è¯†ã€‚",
                energyCost: 2,
                requirements: {},
                execute: function() {
                    changeAttribute("law", 7);
                    changeAttribute("wisdom", 3);
                    addToLog("æ´»åŠ¨", "ä½ åœ¨å›¾ä¹¦é¦†ä¸“å¿ƒç ”ç©¶å•†æ³•çŸ¥è¯†ï¼Œæé«˜äº†ä¸å°‘ä¸“ä¸šæŠ€èƒ½ã€‚");
                    
                    if (!hasItem("lawBook") && Math.random() > 0.7) {
                        addToInventory("lawBook");
                        addToLog("è·å¾—ç‰©å“", "å›¾ä¹¦ç®¡ç†å‘˜ç»™äº†ä½ ä¸€æœ¬å•†æ³•æ•™æã€‚");
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ åœ¨å›¾ä¹¦é¦†ä¸“å¿ƒç ”ç©¶å•†æ³•çŸ¥è¯†ï¼Œæé«˜äº†ä¸å°‘ä¸“ä¸šæŠ€èƒ½ã€‚"},
                                {speaker: "å›¾ä¹¦ç®¡ç†å‘˜", text: "è¿™ä½åŒå­¦ï¼Œè¿™æœ¬æ–°åˆ°çš„å•†æ³•æ•™æå¯èƒ½å¯¹ä½ æœ‰ç”¨ï¼Œä½ å¯ä»¥å€Ÿèµ°ã€‚"},
                                {speaker: "å¤å¥ˆ", text: "å¤ªæ„Ÿè°¢äº†ï¼è¿™æ­£æ˜¯æˆ‘éœ€è¦çš„ï¼"}
                            ],
                            choices: []
                        };
                    } else {
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ åœ¨å›¾ä¹¦é¦†ä¸“å¿ƒç ”ç©¶å•†æ³•çŸ¥è¯†ï¼Œæé«˜äº†ä¸å°‘ä¸“ä¸šæŠ€èƒ½ã€‚"}
                            ],
                            choices: []
                        };
                    }
                }
            },
            readBooks: {
                name: "é˜…è¯»",
                description: "é˜…è¯»å„ç§ä¹¦ç±æ‹“å±•çŸ¥è¯†é¢ã€‚",
                energyCost: 1,
                requirements: {},
                execute: function() {
                    changeAttribute("wisdom", 5);
                    addToLog("æ´»åŠ¨", "ä½ åœ¨å›¾ä¹¦é¦†é˜…è¯»äº†å„ç§ä¹¦ç±ï¼Œå¢é•¿äº†è§è¯†ã€‚");
                    
                    if (!hasItem("basketballBook") && Math.random() > 0.7) {
                        addToInventory("basketballBook");
                        addToLog("è·å¾—ç‰©å“", "ä½ æ‰¾åˆ°äº†ä¸€æœ¬ç¯®çƒå…¥é—¨æ•™ç¨‹ã€‚");
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ åœ¨å›¾ä¹¦é¦†é˜…è¯»äº†å„ç§ä¹¦ç±ï¼Œå¢é•¿äº†è§è¯†ã€‚"},
                                {speaker: "å¤å¥ˆ", text: "å’¦ï¼Œè¿™æœ¬ç¯®çƒå…¥é—¨æ•™ç¨‹çœ‹èµ·æ¥ä¸é”™...ä¹Ÿè®¸å¯ä»¥å¸®æˆ‘äº†è§£æå›½è‰¯çš„ä¸–ç•Œã€‚"}
                            ],
                            choices: []
                        };
                    } else {
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ åœ¨å›¾ä¹¦é¦†é˜…è¯»äº†å„ç§ä¹¦ç±ï¼Œå¢é•¿äº†è§è¯†ã€‚"}
                            ],
                            choices: []
                        };
                    }
                }
            },
            meetClassmate: {
                name: "ä¸åŒå­¦äº¤æµ",
                description: "åœ¨å›¾ä¹¦é¦†ä¸åŒå­¦äº¤æµã€‚",
                energyCost: 1,
                requirements: {},
                execute: function() {
                    changeAttribute("charm", 3);
                    addToLog("æ´»åŠ¨", "ä½ åœ¨å›¾ä¹¦é¦†ä¸åŒå­¦äº¤æµå­¦ä¹ å¿ƒå¾—ï¼Œç¤¾äº¤èƒ½åŠ›æœ‰æ‰€æå‡ã€‚");
                    
                    if (gameData.gameState.storyFlag >= 1 && !hasCompleted("classmateTalk") && Math.random() > 0.5) {
                        completeEvent("classmateTalk");
                        if (!hasMemoryFragment("memory1") && gameData.player.memoryFragments.length >= 1) {
                            collectMemoryFragment("memory1");
                            addToLog("è®°å¿†", "ä½ ä»åŒå­¦é‚£é‡Œå¾—çŸ¥ï¼Œæå›½è‰¯ä¼¼ä¹å’Œä½ æ˜¯åŒä¸€å±Šçš„å­¦ç”Ÿã€‚");
                            return {
                                dialogue: [
                                    {speaker: "åŒå­¦", text: "å¤å¥ˆï¼æ¥ï¼Œç»™ä½ ä»‹ç»ä¸€ä¸‹ï¼Œè¿™æ˜¯ç›¸æ³½ç¾å’²å­¦å§ï¼Œå­¦ç”Ÿä¼šä½“è‚²éƒ¨éƒ¨é•¿ã€‚"},
                                    {speaker: "åŒå­¦", text: "å¤å¥ˆï¼Œå¬è¯´ä½ å¯¹ç¯®çƒé˜Ÿçš„ææ•™ç»ƒå¾ˆæ„Ÿå…´è¶£ï¼Ÿ"},
                                    {speaker: "å¤å¥ˆ", text: "å—¯...æ˜¯æœ‰ç‚¹ï¼Œä½ è®¤è¯†ä»–å—ï¼Ÿ"},
                                    {speaker: "åŒå­¦", text: "ä¸å¤ªç†Ÿï¼Œä¸è¿‡å¬è¯´ä»–ä»¥å‰æ˜¯æ ¡é˜Ÿçš„æ˜æ˜Ÿçƒå‘˜ï¼Œå› ä¸ºè†ä¼¤æ‰è½¬åšæ•™ç»ƒçš„ã€‚ä½ çŸ¥é“å—ï¼Œä»–å¥½åƒå’Œä½ æ˜¯åŒä¸€å±Šçš„ï¼Œåªæ˜¯ä½ è½¬åˆ°å•†æ³•ä¸“ä¸šä¹‹åæ‰æ²¡æ€ä¹ˆæ¥è§¦ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "åŒä¸€å±Šï¼Ÿä¸å¯èƒ½å§...æˆ‘å®Œå…¨æ²¡å°è±¡å•Š..."},
                                    {speaker: "ç³»ç»Ÿ", text: "ä¸€ä¸ªå¥‡æ€ªçš„ç”»é¢é—ªè¿‡ä½ çš„è„‘æµ·..."}
                                ],
                                choices: []
                            };
                        }
                    }
                    
                    return {
                        dialogue: [
                            {speaker: "ç³»ç»Ÿ", text: "ä½ åœ¨å›¾ä¹¦é¦†ä¸åŒå­¦äº¤æµå­¦ä¹ å¿ƒå¾—ï¼Œç¤¾äº¤èƒ½åŠ›æœ‰æ‰€æå‡ã€‚"}
                        ],
                        choices: []
                    };
                }
            },
            
            // å’–å•¡å…äº‹ä»¶
            drinkCoffee: {
                name: "å–æ¯å’–å•¡",
                description: "æ”¾æ¾ä¸€ä¸‹ï¼Œäº«å—å’–å•¡æ—¶å…‰ã€‚",
                energyCost: 1,
                requirements: {},
                execute: function() {
                    changeAttribute("stamina", 20);
                    addToLog("æ´»åŠ¨", "ä½ åœ¨å’–å•¡å…æ”¾æ¾åœ°å–äº†æ¯å’–å•¡ï¼Œæ¢å¤äº†ä¸€äº›ç²¾åŠ›ã€‚");
                    
                    if (gameData.characters.guoliang.metFlag && gameData.characters.guoliang.affection >= 20 && !hasCompleted("cafeMeeting") && Math.random() > 0.5) {
                        completeEvent("cafeMeeting");
                        addToLog("å‰§æƒ…", "ä½ åœ¨å’–å•¡å…å¶é‡äº†æå›½è‰¯ã€‚");
                        return cafeEncounterEvent();
                    } else {
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ åœ¨å’–å•¡å…æ”¾æ¾åœ°å–äº†æ¯å’–å•¡ï¼Œæ¢å¤äº†ä¸€äº›ç²¾åŠ›ã€‚"}
                            ],
                            choices: []
                        };
                    }
                }
            },
            meetFriends: {
                name: "ä¸æœ‹å‹èšä¼š",
                description: "å’Œæœ‹å‹ä»¬åœ¨å’–å•¡å…èšä¼šã€‚",
                energyCost: 2,
                requirements: {},
                execute: function() {
                    changeAttribute("charm", 5);
                    addToLog("æ´»åŠ¨", "ä½ å’Œæœ‹å‹ä»¬åœ¨å’–å•¡å…èŠå¤©ï¼Œåº¦è¿‡äº†æ„‰å¿«çš„æ—¶å…‰ï¼Œç¤¾äº¤èƒ½åŠ›å¾—åˆ°æå‡ã€‚");
                    if (!gameData.characters.misaki.metFlag && gameData.characters.guoliang.affection >= 15) {
                        gameData.characters.misaki.metFlag = true;
                        addToLog("å‰§æƒ…", "ä½ è®¤è¯†äº†ç›¸æ³½ç¾å’²ï¼Œå­¦ç”Ÿä¼šä½“è‚²éƒ¨éƒ¨é•¿ã€‚");
                        return meetMisakiEvent();
                    } else {
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ å’Œæœ‹å‹ä»¬åœ¨å’–å•¡å…èŠå¤©ï¼Œåº¦è¿‡äº†æ„‰å¿«çš„æ—¶å…‰ï¼Œç¤¾äº¤èƒ½åŠ›å¾—åˆ°æå‡ã€‚"}
                            ],
                            choices: []
                        };
                    }
                }
            },
            contractEvent: {
                name: "åˆåŒå¤ä¹ ",
                description: "åœ¨å’–å•¡å…æ•´ç†å­¦ä¹ èµ„æ–™ã€‚",
                energyCost: 1,
                available: function() {
                    return gameData.gameState.storyFlag >= 2;
                },
                requirements: {},
                execute: function() {
                    changeAttribute("law", 4);
                    addToLog("æ´»åŠ¨", "ä½ åœ¨å’–å•¡å…æ•´ç†å•†æ³•è¯¾ç¨‹çš„åˆåŒæ³•ç›¸å…³èµ„æ–™ï¼Œæ³•å¾‹çŸ¥è¯†æœ‰æ‰€æå‡ã€‚");
                    if (gameData.gameState.storyFlag === 2 && gameData.player.attributes.law >= 40 && !hasCompleted("contractReview")) {
                        completeEvent("contractReview");
                        gameData.gameState.storyFlag = 3;
                        addToLog("å‰§æƒ…", "æå›½è‰¯å¯»æ±‚ä½ å¯¹ç¯®çƒé˜ŸèµåŠ©åˆåŒçš„å¸®åŠ©ã€‚");
                        return contractReviewEvent();
                    } else {
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ åœ¨å’–å•¡å…æ•´ç†å•†æ³•è¯¾ç¨‹çš„åˆåŒæ³•ç›¸å…³èµ„æ–™ï¼Œæ³•å¾‹çŸ¥è¯†æœ‰æ‰€æå‡ã€‚"}
                            ],
                            choices: []
                        };
                    }
                }
            },
            
            // å…¬å›­äº‹ä»¶
            relax: {
                name: "æ”¾æ¾æ•£æ­¥",
                description: "åœ¨å…¬å›­é‡Œæ•£æ­¥æ”¾æ¾ã€‚",
                energyCost: 1,
                requirements: {},
                execute: function() {
                    changeAttribute("stamina", 15);
                    addToLog("æ´»åŠ¨", "ä½ åœ¨å…¬å›­é‡Œæ‚ é—²åœ°æ•£æ­¥ï¼Œå¿ƒæƒ…èˆ’ç•…ï¼Œæ¢å¤äº†ä¸€äº›ç²¾åŠ›ã€‚");
                    return {
                        dialogue: [
                            {speaker: "ç³»ç»Ÿ", text: "ä½ åœ¨å…¬å›­é‡Œæ‚ é—²åœ°æ•£æ­¥ï¼Œå¿ƒæƒ…èˆ’ç•…ï¼Œæ¢å¤äº†ä¸€äº›ç²¾åŠ›ã€‚"}
                        ],
                        choices: []
                    };
                }
            },
            cherryBlossomMemory: {
                name: "è§‚èµæ¨±èŠ±",
                description: "è§‚èµå…¬å›­ä¸­çš„æ¨±èŠ±æ ‘ã€‚",
                energyCost: 1,
                requirements: {},
                execute: function() {
                    addToLog("æ´»åŠ¨", "ä½ åœ¨å…¬å›­æ¬£èµç¾ä¸½çš„æ¨±èŠ±ã€‚");
                    if (gameData.player.memoryFragments.length >= 3 && !hasMemoryFragment("memory5")) {
                        collectMemoryFragment("memory5");
                        addToLog("è®°å¿†", "æ¨±èŠ±æ ‘ä¸‹çš„æ™¯è‰²è§¦å‘äº†ä½ å…³äºæŸä¸ªé‡è¦çº¦å®šçš„è®°å¿†ã€‚");
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ ç«™åœ¨ç››å¼€çš„æ¨±èŠ±æ ‘ä¸‹ï¼Œä¸€ç§å¥‡æ€ªçš„ç†Ÿæ‚‰æ„Ÿæ²¹ç„¶è€Œç”Ÿã€‚"},
                                {speaker: "å¤å¥ˆ", text: "ä¸ºä»€ä¹ˆ...æˆ‘æ„Ÿè§‰åœ¨è¿™é‡Œæœ‰è¿‡å¾ˆé‡è¦çš„å›å¿†..."},
                                {speaker: "ç³»ç»Ÿ", text: "ä¸€æ®µæ¨¡ç³Šçš„è®°å¿†é—ªè¿‡ä½ çš„è„‘æµ·..."}
                            ],
                            choices: []
                        };
                    } else {
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ åœ¨å…¬å›­æ¬£èµç¾ä¸½çš„æ¨±èŠ±ï¼Œå¿ƒæƒ…æ„‰æ‚¦ã€‚"},
                                {speaker: "å¤å¥ˆ", text: "è¿™äº›æ¨±èŠ±çœŸç¾å•Š...ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œè¿™æ™¯è‰²è®©æˆ‘æ„Ÿåˆ°æœ‰ç‚¹æ€€å¿µã€‚"}
                            ],
                            choices: []
                        };
                    }
                }
            },
            exercise: {
                name: "æˆ·å¤–é”»ç‚¼",
                description: "åœ¨å…¬å›­è¿›è¡Œæˆ·å¤–é”»ç‚¼ã€‚",
                energyCost: 2,
                requirements: {},
                execute: function() {
                    changeAttribute("stamina", -10);
                    changeAttribute("charm", 3);
                    addToLog("æ´»åŠ¨", "ä½ åœ¨å…¬å›­è¿›è¡Œäº†ä¸€äº›æˆ·å¤–é”»ç‚¼ï¼Œèº«ä½“ç´ è´¨å¾—åˆ°é”»ç‚¼ï¼Œå¤–è¡¨çœ‹èµ·æ¥æ›´æœ‰æ´»åŠ›ã€‚");
                    return {
                        dialogue: [
                            {speaker: "ç³»ç»Ÿ", text: "ä½ åœ¨å…¬å›­è¿›è¡Œäº†ä¸€äº›æˆ·å¤–é”»ç‚¼ï¼Œèº«ä½“ç´ è´¨å¾—åˆ°é”»ç‚¼ï¼Œå¤–è¡¨çœ‹èµ·æ¥æ›´æœ‰æ´»åŠ›ã€‚"}
                        ],
                        choices: []
                    };
                }
            },
            
            // å¥èº«æˆ¿äº‹ä»¶
            workout: {
                name: "å¥èº«",
                description: "åœ¨å¥èº«æˆ¿è¿›è¡Œé”»ç‚¼ã€‚",
                energyCost: 2,
                requirements: {},
                execute: function() {
                    changeAttribute("stamina", -10);
                    changeAttribute("charm", 4);
                    addToLog("æ´»åŠ¨", "ä½ åœ¨å¥èº«æˆ¿è¿›è¡Œäº†å…¨é¢çš„é”»ç‚¼ï¼Œä½“åŠ›è™½ç„¶æ¶ˆè€—äº†ä¸€äº›ï¼Œä½†èº«æå’Œæ°”è´¨éƒ½æœ‰æ‰€æå‡ã€‚");
                    return {
                        dialogue: [
                            {speaker: "ç³»ç»Ÿ", text: "ä½ åœ¨å¥èº«æˆ¿è¿›è¡Œäº†å…¨é¢çš„é”»ç‚¼ï¼Œä½“åŠ›è™½ç„¶æ¶ˆè€—äº†ä¸€äº›ï¼Œä½†èº«æå’Œæ°”è´¨éƒ½æœ‰æ‰€æå‡ã€‚"}
                        ],
                        choices: []
                    };
                }
            },
            rehabilitationTraining: {
                name: "åº·å¤è®­ç»ƒ",
                description: "è§‚å¯Ÿåº·å¤è®­ç»ƒåŒºã€‚",
                energyCost: 1,
                requirements: {},
                execute: function() {
                    addToLog("æ´»åŠ¨", "ä½ è§‚å¯Ÿäº†å¥èº«æˆ¿çš„åº·å¤è®­ç»ƒåŒºï¼Œäº†è§£äº†ä¸€äº›è¿åŠ¨æŸä¼¤çš„åº·å¤çŸ¥è¯†ã€‚");
                    if (gameData.player.memoryFragments.length >= 2 && !hasMemoryFragment("memory4") && gameData.characters.guoliang.affection >= 25) {
                        collectMemoryFragment("memory4");
                        addToLog("è®°å¿†", "çœ‹åˆ°åº·å¤è®­ç»ƒçš„è¿åŠ¨å‘˜ï¼Œä½ æƒ³èµ·äº†åœ¨åŒ»é™¢é™ªä¼´æå›½è‰¯çš„æ—¥å­ã€‚");
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ åœ¨åº·å¤è®­ç»ƒåŒºçœ‹åˆ°å‡ ä¸ªæ­£åœ¨è¿›è¡Œè†å…³èŠ‚æ¢å¤è®­ç»ƒçš„è¿åŠ¨å‘˜ã€‚"},
                                {speaker: "å¤å¥ˆ", text: "çœ‹åˆ°ä»–ä»¬çš„è®­ç»ƒï¼Œæ€»æ„Ÿè§‰å¾ˆç†Ÿæ‚‰ï¼Œå¥½åƒæˆ‘æ›¾ç»..."},
                                {speaker: "ç³»ç»Ÿ", text: "çªç„¶é—´ï¼Œä¸€æ®µåœ¨åŒ»é™¢é™ªä¼´å—ä¼¤çš„äººçš„è®°å¿†é—ªç°..."}
                            ],
                            choices: []
                        };
                    } else {
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ è§‚å¯Ÿäº†å¥èº«æˆ¿çš„åº·å¤è®­ç»ƒåŒºï¼Œäº†è§£äº†ä¸€äº›è¿åŠ¨æŸä¼¤çš„åº·å¤çŸ¥è¯†ã€‚"}
                            ],
                            choices: []
                        };
                    }
                }
            },
            meetMisaki: {
                name: "ä¸ç¾å’²äº¤æµ",
                description: "å°è¯•ä¸ç›¸æ³½ç¾å’²äº¤æµã€‚",
                energyCost: 1,
                available: function() {
                    return gameData.characters.misaki.metFlag;
                },
                requirements: {},
                execute: function() {
                    addToLog("æ´»åŠ¨", "ä½ å°è¯•ä¸ç›¸æ³½ç¾å’²äº¤æµã€‚");
                    if (gameData.characters.guoliang.affection >= 40 && !hasCompleted("misakiConfrontation")) {
                        completeEvent("misakiConfrontation");
                        addToLog("å‰§æƒ…", "ç›¸æ³½ç¾å’²å‘ä½ é€éœ²äº†ä¸€äº›å…³äºä½ è¿‡å»çš„çº¿ç´¢ã€‚");
                        return misakiConfrontationEvent();
                    } else {
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ å°è¯•ä¸ç›¸æ³½ç¾å’²äº¤æµï¼Œä½†å¥¹ä¼¼ä¹æ­£å¿™ç€å¤„ç†å­¦ç”Ÿä¼šçš„äº‹åŠ¡ã€‚"},
                                {speaker: "ç¾å’²", text: "æŠ±æ­‰ï¼Œæˆ‘ç°åœ¨å¾ˆå¿™ã€‚å¦‚æœæ²¡æœ‰é‡è¦çš„äº‹ï¼Œå¯ä»¥æ”¹å¤©å†è¯´å—ï¼Ÿ"},
                                {speaker: "å¤å¥ˆ", text: "æ²¡å…³ç³»ï¼Œä¸æ‰“æ‰°ä½ äº†..."}
                            ],
                            choices: []
                        };
                    }
                }
            },
            
            // æ•™å®¤äº‹ä»¶
            attendClass: {
                name: "ä¸Šè¯¾",
                description: "å‚åŠ å•†æ³•è¯¾ç¨‹ã€‚",
                energyCost: 1,
                requirements: {},
                execute: function() {
                    changeAttribute("law", 6);
                    changeAttribute("wisdom", 3);
                    addToLog("æ´»åŠ¨", "ä½ è®¤çœŸå¬äº†å•†æ³•è¯¾ç¨‹ï¼ŒçŸ¥è¯†æœ‰äº†å¾ˆå¤§æå‡ã€‚");
                    return {
                        dialogue: [
                            {speaker: "ç³»ç»Ÿ", text: "ä½ è®¤çœŸå¬äº†å•†æ³•è¯¾ç¨‹ï¼ŒçŸ¥è¯†æœ‰äº†å¾ˆå¤§æå‡ã€‚"}
                        ],
                        choices: []
                    };
                }
            },
            groupStudy: {
                name: "å°ç»„å­¦ä¹ ",
                description: "å‚åŠ å°ç»„å­¦ä¹ æ´»åŠ¨ã€‚",
                energyCost: 2,
                requirements: {},
                execute: function() {
                    changeAttribute("law", 4);
                    changeAttribute("charm", 3);
                    changeAttribute("wisdom", 2);
                    addToLog("æ´»åŠ¨", "ä½ å‚åŠ äº†å•†æ³•è¯¾çš„å°ç»„å­¦ä¹ ï¼Œä¸åŒå­¦ä»¬ä¸€èµ·ç ”ç©¶æ¡ˆä¾‹ï¼Œå„æ–¹é¢èƒ½åŠ›éƒ½æœ‰æ‰€æå‡ã€‚");
                    
                    if (!hasItem("photoAlbum") && gameData.player.memoryFragments.length >= 1 && !hasMemoryFragment("memory2")) {
                        addToInventory("photoAlbum");
                        addToLog("è·å¾—ç‰©å“", "ä¸€ä½åŒå­¦ç»™äº†ä½ ä¸€æœ¬æ ¡å‹ç›¸å†Œã€‚");
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ å‚åŠ äº†å•†æ³•è¯¾çš„å°ç»„å­¦ä¹ ï¼Œä¸åŒå­¦ä»¬ä¸€èµ·ç ”ç©¶æ¡ˆä¾‹ã€‚"},
                                {speaker: "åŒå­¦", text: "å¯¹äº†ï¼Œä¸‹å‘¨æˆ‘ä»¬è¦åšæ ¡å‹å›é¡¾å±•ï¼Œæˆ‘æ‰¾åˆ°äº†ä¸€äº›å¾€å¹´çš„ç›¸å†Œï¼Œå¤§å®¶è¦ä¸è¦çœ‹çœ‹ï¼Ÿ"},
                                {speaker: "å¤å¥ˆ", text: "æ ¡å‹ç›¸å†Œï¼Ÿå¯ä»¥å•Š..."},
                                {speaker: "åŒå­¦", text: "å¤å¥ˆï¼Œè¿™æœ¬ä½ æ‹¿ç€å§ï¼Œå¯èƒ½ä¼šå¯¹ä½ çš„é¡¹ç›®æœ‰å¸®åŠ©ã€‚"},
                                {speaker: "å¤å¥ˆ", text: "è°¢è°¢ï¼Œæˆ‘ä¼šå¥½å¥½çœ‹çœ‹çš„ã€‚"}
                            ],
                            choices: []
                        };
                    } else {
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ å‚åŠ äº†å•†æ³•è¯¾çš„å°ç»„å­¦ä¹ ï¼Œä¸åŒå­¦ä»¬ä¸€èµ·ç ”ç©¶æ¡ˆä¾‹ï¼Œå„æ–¹é¢èƒ½åŠ›éƒ½æœ‰æ‰€æå‡ã€‚"}
                            ],
                            choices: []
                        };
                    }
                }
            },
            presentationEvent: {
                name: "è¯¾å ‚å±•ç¤º",
                description: "è¿›è¡Œå•†æ³•è¯¾é¢˜çš„å±•ç¤ºã€‚",
                energyCost: 2,
                requirements: {
                    attributes: {law: 35}
                },
                execute: function() {
                    changeAttribute("law", 5);
                    changeAttribute("charm", 5);
                    changeAttribute("wisdom", 3);
                    addToLog("æ´»åŠ¨", "ä½ åœ¨å•†æ³•è¯¾ä¸Šåšäº†ç²¾å½©çš„æ¡ˆä¾‹åˆ†æå±•ç¤ºï¼Œå¾—åˆ°äº†æ•™æˆçš„å¥½è¯„ã€‚å„é¡¹èƒ½åŠ›éƒ½æœ‰æ‰€æå‡ã€‚");
                    
                    if (gameData.characters.guoliang.metFlag && gameData.characters.guoliang.affection >= 20 && !hasCompleted("classPresentation")) {
                        completeEvent("classPresentation");
                        addToLog("å‰§æƒ…", "æå›½è‰¯ç‰¹æ„æ¥è§‚çœ‹ä½ çš„è¯¾å ‚å±•ç¤ºï¼Œå¯¹ä½ çš„è¡¨ç°å°è±¡æ·±åˆ»ã€‚");
                        return presentationSuccessEvent();
                    } else {
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ åœ¨å•†æ³•è¯¾ä¸Šåšäº†ç²¾å½©çš„æ¡ˆä¾‹åˆ†æå±•ç¤ºï¼Œå¾—åˆ°äº†æ•™æˆçš„å¥½è¯„ã€‚å„é¡¹èƒ½åŠ›éƒ½æœ‰æ‰€æå‡ã€‚"}
                            ],
                            choices: []
                        };
                    }
                }
            },
            
            // æ•™å¸ˆåŠå…¬å®¤äº‹ä»¶
            meetProfessor: {
                name: "æ‹œè®¿æ•™æˆ",
                description: "æ‹œè®¿å•†æ³•æ•™æˆè®¨è®ºå­¦ä¹ é—®é¢˜ã€‚",
                energyCost: 1,
                requirements: {},
                execute: function() {
                    changeAttribute("law", 5);
                    addToLog("æ´»åŠ¨", "ä½ å‘å•†æ³•æ•™æˆè¯·æ•™äº†ä¸€äº›å­¦ä¹ ä¸Šçš„é—®é¢˜ï¼Œè·å¾—äº†å®è´µçš„æŒ‡å¯¼ã€‚");
                    
                    if (gameData.gameState.storyFlag >= 3 && gameData.player.attributes.law >= 50 && !hasCompleted("professorAdvice")) {
                        completeEvent("professorAdvice");
                        addToLog("å‰§æƒ…", "æ•™æˆæš—ç¤ºæå›½è‰¯æ›¾ç»å¯¹å•†æ³•å¾ˆæ„Ÿå…´è¶£ï¼Œå¹¶æåˆ°äº†ä¸€ä¸ªæ„å¤–ã€‚");
                        return professorAdviceEvent();
                    } else {
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ å‘å•†æ³•æ•™æˆè¯·æ•™äº†ä¸€äº›å­¦ä¹ ä¸Šçš„é—®é¢˜ï¼Œè·å¾—äº†å®è´µçš„æŒ‡å¯¼ã€‚"},
                                {speaker: "æ•™æˆ", text: "ä½ åœ¨åˆåŒæ³•æ–¹é¢æœ‰å¾ˆå¥½çš„ç†è§£ï¼Œç»§ç»­ä¿æŒã€‚"}
                            ],
                            choices: []
                        };
                    }
                }
            },
            seekAdvice: {
                name: "å¯»æ±‚å»ºè®®",
                description: "è¯·æ•™æ•™æˆå…³äºæ³•å¾‹å®è·µçš„å»ºè®®ã€‚",
                energyCost: 1,
                requirements: {},
                execute: function() {
                    changeAttribute("wisdom", 4);
                    addToLog("æ´»åŠ¨", "ä½ å‘æ•™æˆè¯·æ•™äº†å…³äºæ³•å¾‹å®è·µçš„ä¸€äº›é—®é¢˜ï¼Œè·å¾—äº†å®è´µçš„äººç”Ÿå»ºè®®ã€‚");
                    
                    if (gameData.gameState.storyFlag >= 4 && !hasCompleted("finalAdvice") && gameData.player.memoryFragments.length >= 7) {
                        completeEvent("finalAdvice");
                        addToLog("å‰§æƒ…", "æ•™æˆæš—ç¤ºä½ å»æ‰¾æå›½è‰¯é—®æ¸…æ¥šçœŸç›¸ã€‚");
                        return finalAdviceEvent();
                    } else {
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ å‘æ•™æˆè¯·æ•™äº†å…³äºæ³•å¾‹å®è·µçš„ä¸€äº›é—®é¢˜ï¼Œè·å¾—äº†å®è´µçš„äººç”Ÿå»ºè®®ã€‚"}
                            ],
                            choices: []
                        };
                    }
                }
            },
            helpGrading: {
                name: "ååŠ©æ‰¹æ”¹",
                description: "å¸®åŠ©æ•™æˆæ‰¹æ”¹ä½œä¸šã€‚",
                energyCost: 2,
                requirements: {
                    attributes: {law: 30}
                },
                execute: function() {
                    changeAttribute("law", 3);
                    changeAttribute("wisdom", 4);
                    addToLog("æ´»åŠ¨", "ä½ å¸®åŠ©æ•™æˆæ‰¹æ”¹å•†æ³•ä½œä¸šï¼Œåœ¨è¿‡ç¨‹ä¸­å·©å›ºäº†çŸ¥è¯†å¹¶è·å¾—äº†æ–°çš„è§è§£ã€‚");
                    
                    if (gameData.player.memoryFragments.length >= 4 && !hasMemoryFragment("memory11")) {
                        collectMemoryFragment("memory11");
                        addToLog("è®°å¿†", "æ•™æˆæ— æ„ä¸­é€éœ²ä½ æ˜¯è½¬åˆ°å•†æ³•ä¸“ä¸šçš„ï¼Œè¿™è®©ä½ æ„Ÿåˆ°å›°æƒ‘ã€‚");
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ å¸®åŠ©æ•™æˆæ‰¹æ”¹å•†æ³•ä½œä¸šï¼Œåœ¨è¿‡ç¨‹ä¸­å±•ç°å‡ºå¾ˆå¼ºçš„ä¸“ä¸šç´ å…»ã€‚"},
                                {speaker: "æ•™æˆ", text: "å¤å¥ˆï¼Œä½ å¯¹å•†æ³•çš„ç†è§£çœŸæ˜¯ä¸ä¼—ä¸åŒã€‚è‡ªä»ä½ è½¬åˆ°è¿™ä¸ªä¸“ä¸šï¼Œè¿›æ­¥ä¹‹å¿«è®©äººæƒŠè®¶ã€‚"},
                                {speaker: "å¤å¥ˆ", text: "è½¬åˆ°è¿™ä¸ªä¸“ä¸šï¼Ÿæˆ‘ä¸€ç›´ä¸æ˜¯å•†æ³•ä¸“ä¸šçš„å—ï¼Ÿ"},
                                {speaker: "æ•™æˆ", text: "å•Šï¼ŒæŠ±æ­‰ï¼Œæˆ‘å¯èƒ½è®°é”™äº†ã€‚æ€»ä¹‹ï¼Œä½ å¾ˆæœ‰å¤©èµ‹ã€‚"},
                                {speaker: "ç³»ç»Ÿ", text: "æ•™æˆçš„è¯è®©ä½ æ„Ÿåˆ°å¥‡æ€ªï¼Œä¸€æ®µå…³äºä½ å•†æ³•æ‰èƒ½çš„è®°å¿†ç‰‡æ®µæ¶Œç°..."}
                            ],
                            choices: []
                        };
                    } else {
                        return {
                            dialogue: [
                                {speaker: "ç³»ç»Ÿ", text: "ä½ å¸®åŠ©æ•™æˆæ‰¹æ”¹å•†æ³•ä½œä¸šï¼Œåœ¨è¿‡ç¨‹ä¸­å·©å›ºäº†çŸ¥è¯†å¹¶è·å¾—äº†æ–°çš„è§è§£ã€‚"}
                            ],
                            choices: []
                        };
                    }
                }
            }
        };

        // å®šä¹‰å…³é”®å‰§æƒ…äº‹ä»¶
        // ç¬¬ä¸€å¹•ï¼šåˆæ¬¡ç›¸é‡
        function firstMeetingEvent() {
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "ä½ æ¥åˆ°ç¯®çƒåœºï¼Œçœ‹åˆ°çƒå‘˜ä»¬æ­£åœ¨è®­ç»ƒã€‚åœºè¾¹ä¸€ä½é«˜å¤§çš„ç”·ç”Ÿæ­£åœ¨æŒ‡å¯¼ä»–ä»¬ã€‚"},
                    {speaker: "å¤å¥ˆ", text: "é‚£å°±æ˜¯æå›½è‰¯å§..."},
                    {speaker: "å›½è‰¯", text: "ä¼ çƒè¦æœæ–­ï¼é˜²å®ˆç«™ä½å†ç´§ä¸€ç‚¹ï¼åŠ¨ä½œå¿«ï¼"},
                    {speaker: "ç³»ç»Ÿ", text: "ä»–ä¸¥è‚ƒçš„è¡¨æƒ…å’Œä¸“ä¸šçš„æŒ‡å¯¼è®©ä½ ä¸ç”±å¾—å¤šçœ‹äº†å‡ çœ¼ã€‚"},
                    {speaker: "å¤å¥ˆ", text: "å¥½å¸…å•Š...ä¸çŸ¥é“è¯¥æ€ä¹ˆæ¥è¿‘ä»–..."}
                ],
                choices: [
                    {
                        text: "é¼“èµ·å‹‡æ°”ä¸Šå‰æ‰“æ‹›å‘¼",
                        action: function() {
                            changeCharacterAffection("guoliang", 5);
                            addToLog("äº’åŠ¨", "ä½ é¼“èµ·å‹‡æ°”å‘æå›½è‰¯æ‰“æ‹›å‘¼ï¼Œè™½ç„¶ä»–çš„å›åº”å¾ˆç®€çŸ­ï¼Œä½†ä½ è¿ˆå‡ºäº†ç¬¬ä¸€æ­¥ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "ä½ å¥½ï¼Œæˆ‘æ˜¯ç»“åŸå¤å¥ˆï¼Œå•†æ³•ä¸“ä¸šçš„å­¦ç”Ÿ..."},
                                    {speaker: "å›½è‰¯", text: "æœ‰äº‹å—ï¼Ÿæˆ‘ä»¬æ­£åœ¨è®­ç»ƒã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "å•Šï¼ŒæŠ±æ­‰æ‰“æ‰°äº†ï¼æˆ‘...æˆ‘åªæ˜¯å¯¹ç¯®çƒå¾ˆæ„Ÿå…´è¶£..."},
                                    {speaker: "å›½è‰¯", text: "...è®­ç»ƒç»“æŸåï¼Œåœºåœ°å¯¹æ‰€æœ‰å­¦ç”Ÿå¼€æ”¾ã€‚ä½ å¯ä»¥é‚£æ—¶å€™æ¥ç»ƒä¹ ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "è™½ç„¶ä»–çš„å›åº”å¾ˆç®€çŸ­ï¼Œä½†è‡³å°‘ä½ è¿ˆå‡ºäº†ç¬¬ä¸€æ­¥ã€‚æå›½è‰¯ä¼¼ä¹å¯¹ä½ æœ‰äº›å°è±¡äº†ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "å…ˆé»˜é»˜è§‚å¯Ÿè®­ç»ƒ",
                        action: function() {
                            changeAttribute("basketball", 3);
                            addToLog("äº’åŠ¨", "ä½ å…ˆåœ¨åœºè¾¹è§‚å¯Ÿè®­ç»ƒï¼Œäº†è§£æ›´å¤šç¯®çƒçŸ¥è¯†ï¼Œç„¶ååœ¨è®­ç»ƒç»“æŸåä¸æå›½è‰¯ç®€çŸ­äº¤è°ˆã€‚");
                            return {
                                dialogue: [
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ å†³å®šå…ˆåœ¨åœºè¾¹è§‚å¯Ÿè®­ç»ƒï¼Œäº†è§£æ›´å¤šç¯®çƒçŸ¥è¯†ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "è®­ç»ƒç»“æŸåï¼Œçƒå‘˜ä»¬ä¸‰ä¸‰ä¸¤ä¸¤åœ°ç¦»å¼€ã€‚æå›½è‰¯ç•™ä¸‹æ¥æ”¶æ‹¾å™¨æã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "ï¼ˆè¿™æ˜¯ä¸ªæœºä¼šï¼ï¼‰é‚£ä¸ª...ä½ å¥½ï¼è®­ç»ƒå¾ˆç²¾å½©ï¼"},
                                    {speaker: "å›½è‰¯", text: "è°¢è°¢ã€‚ä½ æ˜¯...ï¼Ÿ"},
                                    {speaker: "å¤å¥ˆ", text: "æˆ‘æ˜¯ç»“åŸå¤å¥ˆï¼Œå•†æ³•ä¸“ä¸šçš„ã€‚æˆ‘æƒ³äº†è§£æ›´å¤šå…³äºç¯®çƒçš„äº‹..."},
                                    {speaker: "å›½è‰¯", text: "å›¾ä¹¦é¦†æœ‰å¾ˆå¤šç¯®çƒå…¥é—¨ä¹¦ç±ï¼Œå¯ä»¥ä»é‚£é‡Œå¼€å§‹ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–çš„å»ºè®®è™½ç„¶æœ‰ç‚¹ç”Ÿç¡¬ï¼Œä½†ä½ æ„Ÿè§‰ä»–å¹¶ä¸æ˜¯æ•…æ„å†·æ·¡ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "å‡è£…å¶ç„¶è·¯è¿‡",
                        action: function() {
                            changeAttribute("charm", 2);
                            addToLog("äº’åŠ¨", "ä½ å‡è£…å¶ç„¶è·¯è¿‡ç¯®çƒåœºï¼Œä¸€ä¸ªé£æ¥çš„ç¯®çƒè®©ä½ æœ‰æœºä¼šä¸æå›½è‰¯çŸ­æš‚äº¤è°ˆã€‚");
                            return {
                                dialogue: [
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ å‡è£…å¶ç„¶è·¯è¿‡ç¯®çƒåœºï¼Œå¸Œæœ›å¼•èµ·æå›½è‰¯çš„æ³¨æ„ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä¸€ä¸ªå¤±æ§çš„ç¯®çƒæœä½ é£æ¥ï¼"},
                                    {speaker: "å¤å¥ˆ", text: "å•Šï¼"},
                                    {speaker: "å›½è‰¯", text: "å°å¿ƒï¼"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯å¿«é€Ÿå†²è¿‡æ¥ï¼Œåœ¨çƒå‡»ä¸­ä½ ä¹‹å‰æ¥ä½äº†å®ƒã€‚"},
                                    {speaker: "å›½è‰¯", text: "æ²¡äº‹å§ï¼Ÿè®­ç»ƒæ—¶é—´æœ€å¥½ä¸è¦é è¿‘åœºåœ°ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "è°¢è°¢ä½ æ¥ä½çƒ...æˆ‘æ˜¯ç»“åŸå¤å¥ˆï¼Œå†’æ˜§æ‰“æ‰°äº†ã€‚"},
                                    {speaker: "å›½è‰¯", text: "æå›½è‰¯ã€‚ä¸‹æ¬¡å°å¿ƒç‚¹ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "è™½ç„¶äº¤æµå¾ˆçŸ­æš‚ï¼Œä½†ä½ æˆåŠŸåœ°å’Œä»–æœ‰äº†ç¬¬ä¸€æ¬¡æ¥è§¦ã€‚"}
                                ]
                            };
                        }
                    }
                ]
            };
        }
        
        // æ›´æ·±å…¥çš„å¯¹è¯äº‹ä»¶
        function deeperConversationEvent() {
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "ä½ é¼“èµ·å‹‡æ°”ï¼Œå†æ¬¡æ¥åˆ°ç¯®çƒåœºæ‰¾æå›½è‰¯ã€‚"},
                    {speaker: "å¤å¥ˆ", text: "ææ•™ç»ƒï¼Œæ‰“æ‰°ä¸€ä¸‹ï¼Œæœ‰æ—¶é—´èŠå‡ å¥å—ï¼Ÿ"},
                    {speaker: "å›½è‰¯", text: "ç»“åŸåŒå­¦ï¼Ÿæœ‰ä»€ä¹ˆäº‹å—ï¼Ÿ"},
                    {speaker: "å¤å¥ˆ", text: "æˆ‘æƒ³å¤šäº†è§£ä¸€ä¸‹ç¯®çƒ...é¡ºä¾¿ï¼Œå«æˆ‘å¤å¥ˆå°±å¥½ã€‚"}
                ],
                choices: [
                    {
                        text: "è¯¢é—®ä»–çš„ç¯®çƒç»å†",
                        action: function() {
                            changeCharacterAffection("guoliang", 5);
                            addToLog("äº’åŠ¨", "ä½ è¯¢é—®æå›½è‰¯çš„ç¯®çƒç»å†ï¼Œäº†è§£åˆ°ä»–å› è†ä¼¤è½¬å‹ä¸ºæ•™ç»ƒã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "å¬è¯´ä½ ä»¥å‰æ˜¯æ ¡é˜Ÿçš„ä¸»åŠ›çƒå‘˜ï¼Ÿä¸ºä»€ä¹ˆè½¬åšæ•™ç»ƒäº†å‘¢ï¼Ÿ"},
                                    {speaker: "å›½è‰¯", text: "..."},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çš„è¡¨æƒ…æ˜æ˜¾å˜å¾—æœ‰äº›å¤æ‚ã€‚"},
                                    {speaker: "å›½è‰¯", text: "è†ç›–å—ä¼¤äº†ã€‚ä¸èƒ½å†æ‰“æ¯”èµ›çº§åˆ«çš„ç¯®çƒã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "æˆ‘å¾ˆæŠ±æ­‰å¬åˆ°è¿™ä¸ª..."},
                                    {speaker: "å›½è‰¯", text: "æ²¡å…³ç³»ï¼Œèƒ½ç»§ç»­å‚ä¸ç¯®çƒå·²ç»å¾ˆæ»¡è¶³äº†ã€‚æ•™ç»ƒä¹Ÿèƒ½å¸®åŠ©é˜Ÿå‘˜æˆé•¿ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ æ³¨æ„åˆ°ä»–è¯´è¯æ—¶ï¼Œæ— æ„è¯†åœ°æ‘¸äº†æ‘¸å·¦è†ã€‚è¿™ä¸ªåŠ¨ä½œè«ååœ°è®©ä½ æ„Ÿåˆ°å¿ƒç–¼ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "æåˆ°è‡ªå·±çš„å•†æ³•ä¸“ä¸š",
                        action: function() {
                            changeCharacterAffection("guoliang", 3);
                            addToLog("äº’åŠ¨", "ä½ æåˆ°è‡ªå·±çš„å•†æ³•ä¸“ä¸šï¼Œå¼•èµ·äº†æå›½è‰¯å¯¹çƒé˜ŸèµåŠ©åˆåŒçš„å…´è¶£ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "æˆ‘æ˜¯å•†æ³•ä¸“ä¸šçš„å­¦ç”Ÿï¼Œæœ€è¿‘åœ¨å­¦ä¹ ä½“è‚²ç›¸å…³çš„åˆåŒæ³•ã€‚"},
                                    {speaker: "å›½è‰¯", text: "å•†æ³•ï¼Ÿè¿™å€’æ˜¯å·§åˆï¼Œæˆ‘ä»¬é˜Ÿæ­£å¥½æœ‰äº›èµåŠ©åˆåŒçš„äº‹æƒ…..."},
                                    {speaker: "å¤å¥ˆ", text: "çœŸçš„å—ï¼Ÿå¦‚æœéœ€è¦å¸®å¿™ï¼Œæˆ‘å¾ˆä¹æ„æä¾›ä¸€äº›å»ºè®®ã€‚"},
                                    {speaker: "å›½è‰¯", text: "é‚£...æœ‰æ—¶é—´çš„è¯ï¼Œä¹Ÿè®¸å¯ä»¥è¯·æ•™ä½ å‡ ä¸ªé—®é¢˜ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çœ‹èµ·æ¥å¯¹ä½ çš„ä¸“ä¸šçŸ¥è¯†å¾ˆæ„Ÿå…´è¶£ï¼Œè¿™å¯èƒ½æ˜¯æ¥è¿‘ä»–çš„å¥½æœºä¼šã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "ç›´æ¥è¡¨è¾¾å¥½æ„Ÿ",
                        action: function() {
                            addToLog("äº’åŠ¨", "ä½ ç›´æ¥è¡¨è¾¾äº†å¯¹æå›½è‰¯çš„å¥½æ„Ÿï¼Œä»–çš„ååº”æœ‰äº›å¥‡æ€ªï¼Œä¼¼ä¹è§‰å¾—ä½ å¾ˆçœ¼ç†Ÿã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "å…¶å®...æˆ‘æŒºæ¬£èµä½ çš„ã€‚å¯ä»¥å¤šäº†è§£ä½ å—ï¼Ÿ"},
                                    {speaker: "å›½è‰¯", text: "..."},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯æ˜æ˜¾æ„£äº†ä¸€ä¸‹ï¼Œè„¸ä¸Šé—ªè¿‡ä¸€ä¸å¤æ‚çš„è¡¨æƒ…ã€‚"},
                                    {speaker: "å›½è‰¯", text: "ä½ ...æ€»è§‰å¾—ä½ æœ‰ç‚¹çœ¼ç†Ÿï¼Œæˆ‘ä»¬ä»¥å‰è§è¿‡å—ï¼Ÿ"},
                                    {speaker: "å¤å¥ˆ", text: "åº”è¯¥æ²¡æœ‰å§ï¼Ÿæˆ‘æ˜¯ä»Šå¹´æ‰è½¬åˆ°å•†æ³•ä¸“ä¸šçš„ã€‚"},
                                    {speaker: "å›½è‰¯", text: "è¿™æ ·å•Š...æŠ±æ­‰ï¼Œæˆ‘è®­ç»ƒè¿˜æ²¡ç»“æŸï¼Œæ”¹å¤©å†èŠå§ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯åŒ†å¿™å›åˆ°äº†çƒåœºï¼Œä½†ä½ æ³¨æ„åˆ°ä»–ç¦»å¼€æ—¶åˆå›å¤´çœ‹äº†ä½ ä¸€çœ¼ã€‚"}
                                ]
                            };
                        }
                    }
                ]
            };
        }
        
        // å’–å•¡å…å¶é‡äº‹ä»¶
        function cafeEncounterEvent() {
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "ä½ æ­£åœ¨å’–å•¡å…äº«ç”¨ä¸€æ¯æ‹¿é“ï¼Œå¿½ç„¶çœ‹åˆ°æå›½è‰¯ç‹¬è‡ªä¸€äººèµ°äº†è¿›æ¥ã€‚"},
                    {speaker: "å¤å¥ˆ", text: "ï¼ˆæ˜¯æå›½è‰¯ï¼ä»–ä¸€ä¸ªäººå‘¢...è¦ä¸è¦æ‰“æ‹›å‘¼ï¼Ÿï¼‰"}
                ],
                choices: [
                    {
                        text: "ä¸»åŠ¨é‚€è¯·ä»–ä¸€èµ·å",
                        action: function() {
                            changeCharacterAffection("guoliang", 8);
                            addToLog("äº’åŠ¨", "ä½ ä¸»åŠ¨é‚€è¯·æå›½è‰¯ä¸€èµ·åï¼Œå‘ç°ä»–èµ°è·¯æ—¶å·¦è…¿æœ‰äº›ä¸è‡ªç„¶ã€‚");
                            if (gameData.player.memoryFragments.length >= 1 && !hasMemoryFragment("memory3")) {
                                collectMemoryFragment("memory3");
                                return {
                                    dialogue: [
                                        {speaker: "å¤å¥ˆ", text: "ææ•™ç»ƒï¼è¿™è¾¹æœ‰ç©ºä½ï¼Œè¦ä¸€èµ·åå—ï¼Ÿ"},
                                        {speaker: "å›½è‰¯", text: "ç»“åŸåŒå­¦...å¥½çš„ï¼Œè°¢è°¢ã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "ä»–èµ°è¿‡æ¥åä¸‹ï¼Œä½ æ³¨æ„åˆ°ä»–èµ°è·¯æ—¶å·¦è…¿ç¨æœ‰äº›ä¸è‡ªç„¶ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "è†ç›–è¿˜ä¼šç–¼å—ï¼Ÿ"},
                                        {speaker: "å›½è‰¯", text: "å¶å°”ä¼š...ç­‰ç­‰ï¼Œæˆ‘å‘Šè¯‰è¿‡ä½ æ˜¯å·¦è†å—ä¼¤å—ï¼Ÿ"},
                                        {speaker: "å¤å¥ˆ", text: "å‘ƒ...ä½ åˆšæ‰èµ°è·¯çš„å§¿åŠ¿ï¼Œæˆ‘çŒœçš„ï¼Ÿ"},
                                        {speaker: "ç³»ç»Ÿ", text: "ä¸€ä¸ªé—ªå›çš„ç”»é¢çªç„¶å‡ºç°åœ¨ä½ çš„è„‘æµ·ä¸­ï¼šçƒåœºä¸Šï¼Œä¸€ä¸ªçƒå‘˜é«˜é«˜è·ƒèµ·ï¼Œç„¶åé‡é‡æ‘”å€’..."}
                                    ]
                                };
                            } else {
                                return {
                                    dialogue: [
                                        {speaker: "å¤å¥ˆ", text: "ææ•™ç»ƒï¼è¿™è¾¹æœ‰ç©ºä½ï¼Œè¦ä¸€èµ·åå—ï¼Ÿ"},
                                        {speaker: "å›½è‰¯", text: "ç»“åŸåŒå­¦...å¥½çš„ï¼Œè°¢è°¢ã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "ä»–èµ°è¿‡æ¥åä¸‹ï¼Œä½ æ³¨æ„åˆ°ä»–é¢å‰æ”¾ç€ä¸€äº›æ–‡ä»¶ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "åœ¨å¿™å·¥ä½œï¼Ÿ"},
                                        {speaker: "å›½è‰¯", text: "å—¯ï¼Œç¯®çƒé˜Ÿçš„ä¸€äº›èµåŠ©æ–‡ä»¶ï¼Œè¯´å®è¯æœ‰äº›å¤´ç–¼ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "æˆ‘å¯ä»¥çœ‹çœ‹å—ï¼Ÿä¹Ÿè®¸èƒ½å¸®ä¸Šå¿™ã€‚"},
                                        {speaker: "å›½è‰¯", text: "é‚£çœŸæ˜¯å¤ªå¥½äº†...è¿™ä¸ªæ¡æ¬¾ä½ æ€ä¹ˆçœ‹ï¼Ÿ"}
                                    ]
                                };
                            }
                        }
                    },
                    {
                        text: "å‡è£…æ²¡çœ‹åˆ°ï¼Œç­‰ä»–æ³¨æ„åˆ°ä½ ",
                        action: function() {
                            changeCharacterAffection("guoliang", 3);
                            addToLog("äº’åŠ¨", "ä½ å‡è£…æ²¡æ³¨æ„åˆ°æå›½è‰¯ï¼Œç»“æœä»–ä¸»åŠ¨è·Ÿä½ æ‰“æ‹›å‘¼ï¼Œä½ ä»¬ååœ¨ä¸€èµ·èŠå¤©ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ å‡è£…æ²¡æœ‰æ³¨æ„åˆ°ä»–ï¼Œä¸“å¿ƒå–ç€å’–å•¡ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯ä¹°å®Œå’–å•¡è½¬èº«æ—¶ï¼Œæ³¨æ„åˆ°äº†ä½ ã€‚"},
                                    {speaker: "å›½è‰¯", text: "ç»“åŸåŒå­¦ï¼Ÿä¸€ä¸ªäººå—ï¼Ÿ"},
                                    {speaker: "å¤å¥ˆ", text: "å•Šï¼Œææ•™ç»ƒï¼æ˜¯çš„ï¼Œæˆ‘åœ¨å¤ä¹ åŠŸè¯¾ã€‚ä½ ä¹Ÿæ˜¯æ¥å–å’–å•¡çš„ï¼Ÿ"},
                                    {speaker: "å›½è‰¯", text: "å—¯ï¼Œé¡ºä¾¿å¤„ç†ä¸€äº›æ–‡ä»¶ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "è®­ç»ƒé˜Ÿå‘˜å¾ˆç´¯å§ï¼Ÿè¦ä¸€èµ·åä¼šå„¿å—ï¼Ÿ"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çŠ¹è±«äº†ä¸€ä¸‹ï¼Œç„¶åç‚¹ç‚¹å¤´ååœ¨äº†ä½ å¯¹é¢ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "è§‚å¯Ÿä»–ä¸€ä¼šå„¿å†å†³å®š",
                        action: function() {
                            changeAttribute("wisdom", 2);
                            addToLog("äº’åŠ¨", "ä½ å…ˆè§‚å¯Ÿäº†æå›½è‰¯ä¸€ä¼šå„¿ï¼Œå‘ç°ä»–ä¼¼ä¹åœ¨ä¸ºæ–‡ä»¶çƒ¦æ¼ï¼Œéšåä¸»åŠ¨æ­è¯ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ å†³å®šå…ˆè§‚å¯Ÿä»–ä¸€ä¼šå„¿å†å†³å®šæ˜¯å¦æ‰“æ‹›å‘¼ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯ç‚¹äº†æ¯é»‘å’–å•¡ï¼Œååœ¨è§’è½å¼€å§‹æŸ¥çœ‹ä¸€äº›æ–‡ä»¶ã€‚ä»–çœ‹èµ·æ¥å¾ˆä¸“æ³¨ï¼Œä½†æ—¶ä¸æ—¶çš±çœ‰ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "ï¼ˆä»–å¥½åƒåœ¨ä¸ºä»€ä¹ˆäº‹æƒ…çƒ¦æ¼...è¦è¿‡å»å—ï¼Ÿï¼‰"},
                                    {speaker: "ç³»ç»Ÿ", text: "å°±åœ¨ä½ çŠ¹è±«çš„æ—¶å€™ï¼Œæå›½è‰¯æŠ¬å¤´çœ‹åˆ°äº†ä½ ï¼Œå¾®å¾®ç‚¹å¤´ç¤ºæ„ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ é¼“èµ·å‹‡æ°”èµ°äº†è¿‡å»ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "åœ¨å¤„ç†çƒé˜Ÿçš„äº‹æƒ…å—ï¼Ÿçœ‹èµ·æ¥å¾ˆå¤æ‚çš„æ ·å­ã€‚"},
                                    {speaker: "å›½è‰¯", text: "æ˜¯çš„...ä¸€äº›èµåŠ©åˆåŒçš„é—®é¢˜ã€‚è¯´èµ·æ¥ï¼Œä½ ä¸æ˜¯å­¦å•†æ³•çš„å—ï¼Ÿ"}
                                ]
                            };
                        }
                    }
                ]
            };
        }
        
        // åˆåŒå¤ä¹ äº‹ä»¶
        function contractReviewEvent() {
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "ä½ åœ¨å’–å•¡å…å¤ä¹ å•†æ³•è¯¾ç¨‹ä¸­å…³äºä½“è‚²èµåŠ©åˆåŒçš„éƒ¨åˆ†ã€‚"},
                    {speaker: "å¤å¥ˆ", text: "è¿™ä¸ªæ¡ˆä¾‹åˆ†æå¾ˆæœ‰æ„æ€..."},
                    {speaker: "ç³»ç»Ÿ", text: "çªç„¶ï¼Œä½ æ„Ÿè§‰æœ‰äººåœ¨çœ‹ç€ä½ ã€‚æŠ¬å¤´ä¸€çœ‹ï¼Œæ˜¯æå›½è‰¯ã€‚"},
                    {speaker: "å›½è‰¯", text: "ç»“åŸåŒå­¦ï¼Œæ­£å¥½ï¼æˆ‘æƒ³è¯·æ•™ä½ ä¸€ä¸ªé—®é¢˜ã€‚"},
                    {speaker: "å¤å¥ˆ", text: "ä»€ä¹ˆé—®é¢˜ï¼Ÿ"},
                    {speaker: "å›½è‰¯", text: "ç¯®çƒé˜Ÿæœ€è¿‘æ”¶åˆ°ä¸€ä»½èµåŠ©åˆåŒï¼Œä½†æˆ‘å¯¹é‡Œé¢çš„æ¡æ¬¾æœ‰äº›ç–‘è™‘ã€‚ä½ èƒ½å¸®æˆ‘çœ‹çœ‹å—ï¼Ÿ"}
                ],
                choices: [
                    {
                        text: "å½“ç„¶æ„¿æ„å¸®å¿™",
                        action: function() {
                            changeCharacterAffection("guoliang", 10);
                            addToLog("äº’åŠ¨", "ä½ å¸®åŠ©æå›½è‰¯åˆ†æèµåŠ©åˆåŒï¼ŒæŒ‡å‡ºäº†å‡ å¤„å¯¹çƒé˜Ÿä¸åˆ©çš„æ¡æ¬¾ï¼Œè·å¾—äº†ä»–çš„èµèµã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "å½“ç„¶å¯ä»¥ï¼Œæ­£å¥½æˆ‘æœ€è¿‘åœ¨å­¦è¿™æ–¹é¢çš„çŸ¥è¯†ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯æ‹¿å‡ºåˆåŒï¼Œä½ ä»”ç»†é˜…è¯»åå‘ç°äº†å‡ å¤„å¯¹çƒé˜Ÿä¸åˆ©çš„æ¡æ¬¾ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "è¿™é‡Œå’Œè¿™é‡Œçš„æ¡æ¬¾éœ€è¦æ³¨æ„ï¼Œè¿™æ ·å†™çš„è¯å¯¹çƒé˜Ÿå¾ˆä¸åˆ©..."},
                                    {speaker: "å›½è‰¯", text: "çœŸçš„ï¼Ÿæˆ‘å®Œå…¨æ²¡æ³¨æ„åˆ°..."},
                                    {speaker: "å¤å¥ˆ", text: "æˆ‘å»ºè®®ä½ ä»¬è¦æ±‚ä¿®æ”¹è¿™äº›æ¡æ¬¾ï¼Œæˆ–è€…å¯»æ‰¾å…¶ä»–èµåŠ©å•†ã€‚"},
                                    {speaker: "å›½è‰¯", text: "å¤ªæ„Ÿè°¢äº†ï¼ä½ çš„ä¸“ä¸šçŸ¥è¯†çœŸæ˜¯å¸®äº†å¤§å¿™ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯è¯šæ³çš„æ„Ÿè°¢è®©ä½ æ„Ÿåˆ°å¾ˆå¼€å¿ƒï¼Œä½ ä»¬çš„å…³ç³»æ›´è¿›ä¸€æ­¥äº†ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "è°¦è™šåœ°è¡¨ç¤ºè‡ªå·±åªæ˜¯å­¦ç”Ÿ",
                        action: function() {
                            changeCharacterAffection("guoliang", 5);
                            addToLog("äº’åŠ¨", "ä½ è°¦è™šåœ°è¡¨ç¤ºè‡ªå·±åªæ˜¯å­¦ç”Ÿï¼Œä½†ä»ç„¶å¸®åŠ©æå›½è‰¯åˆ†æäº†åˆåŒï¼Œä»–é‚€è¯·ä½ æ‹…ä»»çƒé˜Ÿçš„ä¸´æ—¶æ³•å¾‹é¡¾é—®ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "æˆ‘åªæ˜¯å­¦ç”Ÿï¼Œæ°´å¹³æœ‰é™...ä¸è¿‡æˆ‘å¾ˆä¹æ„è¯•è¯•çœ‹ã€‚"},
                                    {speaker: "å›½è‰¯", text: "å·²ç»å¾ˆæ„Ÿè°¢äº†ï¼Œæˆ‘ç›¸ä¿¡ä½ çš„èƒ½åŠ›ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ è®¤çœŸå®¡é˜…äº†åˆåŒï¼ŒæŒ‡å‡ºäº†å‡ å¤„éœ€è¦æ³¨æ„çš„åœ°æ–¹ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "æ ¹æ®æˆ‘çš„ç†è§£ï¼Œè¿™äº›æ¡æ¬¾å¯¹çƒé˜Ÿä¸å¤ªæœ‰åˆ©..."},
                                    {speaker: "å›½è‰¯", text: "åŸæ¥å¦‚æ­¤ï¼Œè¿™ç¡®å®æ˜¯ä¸ªé—®é¢˜ã€‚ä½ çš„å»ºè®®å¾ˆä¸“ä¸šã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "å¦‚æœéœ€è¦ï¼Œæˆ‘å¯ä»¥å¸®ä½ ä»¬èµ·è‰ä¸€ä¸ªä¿®æ”¹æ–¹æ¡ˆã€‚"},
                                    {speaker: "å›½è‰¯", text: "é‚£å°±å¤ªå¥½äº†ã€‚å¯¹äº†ï¼Œä½ æ„¿æ„æ‹…ä»»çƒé˜Ÿçš„ä¸´æ—¶æ³•å¾‹é¡¾é—®å—ï¼Ÿ"}
                                ]
                            };
                        }
                    },
                    {
                        text: "å»ºè®®å’¨è¯¢ä¸“ä¸šäººå£«",
                        action: function() {
                            addToLog("äº’åŠ¨", "ä½ å»ºè®®æå›½è‰¯å’¨è¯¢ä¸“ä¸šå¾‹å¸ˆï¼Œä½†åœ¨ä»–åšæŒä¸‹ä»ç»™å‡ºäº†åˆæ­¥å»ºè®®ï¼Œä»–å¯¹ä½ çš„åˆ†æå¾ˆæ»¡æ„ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "è¿™ç±»åˆåŒæœ€å¥½å’¨è¯¢ä¸“ä¸šå¾‹å¸ˆï¼Œæˆ‘åªæ˜¯å­¦ç”Ÿ..."},
                                    {speaker: "å›½è‰¯", text: "æˆ‘ä»¬é¢„ç®—æœ‰é™ï¼Œè¯·ä¸èµ·ä¸“ä¸šå¾‹å¸ˆã€‚å°±ç®—ç»™ä¸ªåˆæ­¥æ„è§ä¹Ÿå¾ˆæœ‰å¸®åŠ©ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "é‚£...æˆ‘å¯ä»¥è¯•ç€çœ‹çœ‹ï¼Œä½†ç»“æœä»…ä¾›å‚è€ƒã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ ä»”ç»†æ£€æŸ¥äº†åˆåŒï¼Œå‘ç°äº†å‡ å¤„é—®é¢˜ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "è¿™äº›æ¡æ¬¾çœ‹èµ·æ¥å¯¹çƒé˜Ÿä¸å¤ªå…¬å¹³ï¼Œå»ºè®®è°¨æ…è€ƒè™‘ã€‚"},
                                    {speaker: "å›½è‰¯", text: "æˆ‘å°±çŸ¥é“æœ‰é—®é¢˜...ä½ çš„åˆ†æå¾ˆåˆ°ä½ï¼Œæ¯”æˆ‘æƒ³è±¡çš„è¦ä¸“ä¸šå¤šäº†ã€‚"},
                                    {speaker: "å›½è‰¯", text: "æœ‰æ²¡æœ‰å…´è¶£å¸®çƒé˜Ÿé•¿æœŸæä¾›ä¸€äº›æ³•å¾‹å»ºè®®ï¼Ÿ"}
                                ]
                            };
                        }
                    }
                ]
            };
        }
        
        // åˆåŒè®¨è®ºäº‹ä»¶
        function contractDiscussionEvent() {
            completeEvent("contractHelp");
            gameData.gameState.storyFlag = 4;
            addToLog("å‰§æƒ…è¿›å±•", "ä½ æˆåŠŸå¸®åŠ©æå›½è‰¯ä¿®æ”¹äº†ç¯®çƒé˜Ÿçš„èµåŠ©åˆåŒï¼Œä»–å¯¹ä½ çš„ä¸“ä¸šèƒ½åŠ›éå¸¸æ¬£èµã€‚");
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "ä½ æ‰¾åˆ°äº†æ­£åœ¨ç¯®çƒåœºè¾¹ä¼‘æ¯çš„æå›½è‰¯ã€‚"},
                    {speaker: "å¤å¥ˆ", text: "ææ•™ç»ƒï¼Œæˆ‘å‡†å¤‡äº†ä¸€ä»½åˆåŒä¿®æ”¹å»ºè®®ã€‚"},
                    {speaker: "å›½è‰¯", text: "å¤ªåŠæ—¶äº†ï¼èµåŠ©å•†æ­£å¥½ç»™äº†å›å¤ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "ä½ ä»¬ä¸€èµ·åä¸‹æ¥è®¨è®ºåˆåŒç»†èŠ‚ã€‚"},
                    {speaker: "å›½è‰¯", text: "ä½ çš„å»ºè®®éå¸¸ä¸“ä¸šï¼Œæˆ‘çœŸæ²¡æƒ³åˆ°èƒ½å¾—åˆ°è¿™ä¹ˆå¥½çš„å¸®åŠ©ã€‚"},
                    {speaker: "å¤å¥ˆ", text: "ä¸å®¢æ°”ï¼Œèƒ½å¸®ä¸Šå¿™æˆ‘å¾ˆå¼€å¿ƒã€‚"},
                    {speaker: "å›½è‰¯", text: "è¯´å®è¯ï¼Œä½ è®©æˆ‘æƒ³èµ·äº†ä¸€ä¸ªäºº...ä¹Ÿå¾ˆæ“…é•¿è¿™äº›ã€‚"}
                ],
                choices: [
                    {
                        text: "è¯¢é—®é‚£ä¸ªäººæ˜¯è°",
                        action: function() {
                            if (gameData.player.memoryFragments.length >= 3) {
                                collectMemoryFragment("memory6");
                                addToLog("è®°å¿†", "æå›½è‰¯æåˆ°æ›¾æœ‰ä¸€ä¸ªäººåœ¨ä»–æœ€éœ€è¦æ—¶ç»™äºˆæ”¯æŒï¼Œä½ å¾—åˆ°äº†å…³äºå¤±æ„å¤œæ™šçš„è®°å¿†ç¢ç‰‡ã€‚");
                                return {
                                    dialogue: [
                                        {speaker: "å¤å¥ˆ", text: "æ˜¯è°å•Šï¼Ÿå‰å¥³å‹å—ï¼Ÿ"},
                                        {speaker: "å›½è‰¯", text: "...ä¸€ä¸ªå¾ˆé‡è¦çš„äººã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çš„è¡¨æƒ…å˜å¾—å¤æ‚è€Œæ€€å¿µã€‚"},
                                        {speaker: "å›½è‰¯", text: "å¥¹æ€»æ˜¯åœ¨æˆ‘æœ€éœ€è¦çš„æ—¶å€™ç»™æˆ‘æ”¯æŒã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "é‚£...ä½ ä»¬ç°åœ¨è¿˜è”ç³»å—ï¼Ÿ"},
                                        {speaker: "å›½è‰¯", text: "å‘½è¿æœ‰æ—¶å¾ˆå¥‡å¦™ï¼Œä¹Ÿè®¸å¥¹ä»æœªçœŸæ­£ç¦»å¼€..."},
                                        {speaker: "ç³»ç»Ÿ", text: "ä»–çš„è¯è®©ä½ æ„Ÿåˆ°è«åç†Ÿæ‚‰ï¼Œä¸€æ®µå…³äºé›¨å¤œå’Œå¤±è½çš„è®°å¿†é—ªç°..."}
                                    ]
                                };
                            } else {
                                return {
                                    dialogue: [
                                        {speaker: "å¤å¥ˆ", text: "æ˜¯è°å•Šï¼Ÿä½ çš„æœ‹å‹å—ï¼Ÿ"},
                                        {speaker: "å›½è‰¯", text: "...ä¸€ä¸ªå¾ˆé‡è¦çš„äººã€‚ä¸è¿‡ç°åœ¨ä¸æ–¹ä¾¿å¤šè¯´ã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯æ˜æ˜¾ä¸æƒ³ç»§ç»­è¿™ä¸ªè¯é¢˜ã€‚"},
                                        {speaker: "å›½è‰¯", text: "å¯¹äº†ï¼Œçƒé˜Ÿä¸‹å‘¨æœ‰ä¸€åœºå‹è°Šèµ›ï¼Œä½ æœ‰å…´è¶£æ¥çœ‹å—ï¼Ÿ"},
                                        {speaker: "å¤å¥ˆ", text: "å½“ç„¶ï¼æˆ‘å¾ˆä¹æ„ã€‚"},
                                        {speaker: "å›½è‰¯", text: "é‚£å°±è¿™ä¹ˆå®šäº†ã€‚æ¯”èµ›ç»“æŸåï¼Œçƒé˜Ÿä¼šæœ‰ä¸ªå°èšä¼šï¼Œä½ ä¹Ÿæ¥å§ã€‚"}
                                    ]
                                };
                            }
                        }
                    },
                    {
                        text: "æ¥å—çƒé˜Ÿæ³•å¾‹é¡¾é—®çš„èŒä½",
                        action: function() {
                            changeCharacterAffection("guoliang", 12);
                            addToLog("äº’åŠ¨", "ä½ æ¥å—äº†çƒé˜Ÿæ³•å¾‹é¡¾é—®çš„èŒä½ï¼Œæå›½è‰¯æåˆ°æ›¾æœ‰ä½é˜Ÿå‘˜ä¹Ÿå¯¹æ³•å¾‹å¾ˆç²¾é€šï¼Œè¡¨æƒ…ä¸­æœ‰ç§æœŸå¾…ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "å¦‚æœçƒé˜Ÿéœ€è¦ï¼Œæˆ‘å¾ˆä¹æ„æ­£å¼æ‹…ä»»çƒé˜Ÿçš„æ³•å¾‹é¡¾é—®ã€‚"},
                                    {speaker: "å›½è‰¯", text: "çœŸçš„å—ï¼Ÿé‚£å¤ªå¥½äº†ï¼è¿™å¯¹çƒé˜Ÿå¸®åŠ©å¾ˆå¤§ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çœŸè¯šåœ°æ¡äº†æ¡ä½ çš„æ‰‹ï¼Œä½ æ„Ÿè§‰åˆ°ä¸€ç§å¥‡å¦™çš„ç†Ÿæ‚‰æ„Ÿã€‚"},
                                    {speaker: "å›½è‰¯", text: "æ¬¢è¿åŠ å…¥çƒé˜Ÿå¤§å®¶åº­ã€‚è¯´èµ·æ¥...æˆ‘ä»¬æ›¾ç»æœ‰ä¸ªé˜Ÿå‘˜ä¹Ÿå¯¹æ³•å¾‹å¾ˆç²¾é€š..."},
                                    {speaker: "å¤å¥ˆ", text: "æ˜¯å—ï¼Ÿç°åœ¨æ€ä¹ˆæ ·äº†ï¼Ÿ"},
                                    {speaker: "å›½è‰¯", text: "å¥¹...æœ‰äº›ç‰¹æ®ŠåŸå› ç¦»å¼€äº†ã€‚ä½†æˆ‘ä¸€ç›´å¸Œæœ›å¥¹èƒ½å›æ¥ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çœ‹ç€ä½ çš„çœ¼ç¥ä¸­æœ‰ä¸€ç§éš¾ä»¥è¨€è¯´çš„æœŸå¾…ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "è¯¢é—®çƒé˜Ÿçš„æ—¥å¸¸è¿ä½œ",
                        action: function() {
                            changeAttribute("wisdom", 3);
                            addToLog("äº’åŠ¨", "ä½ è¯¢é—®äº†çƒé˜Ÿçš„æ—¥å¸¸è¿ä½œï¼Œæå›½è‰¯è°ˆèµ·çƒé˜Ÿæ—¶å……æ»¡çƒ­æƒ…ï¼Œæåˆ°æ›¾æœ‰äººæ•™ä¼šä»–æ°¸ä¸æ”¾å¼ƒçš„ç²¾ç¥ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "çƒé˜Ÿå¹³æ—¶æ˜¯æ€ä¹ˆè¿ä½œçš„ï¼Ÿé™¤äº†è®­ç»ƒè¿˜æœ‰å“ªäº›æ´»åŠ¨ï¼Ÿ"},
                                    {speaker: "å›½è‰¯", text: "è®­ç»ƒã€æ¯”èµ›ã€ç¤¾åŒºæ´»åŠ¨ã€é˜Ÿå†…èšä¼š...ç¯®çƒé˜Ÿæ˜¯ä¸ªå¤§å®¶åº­ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯è°ˆèµ·çƒé˜Ÿæ—¶ï¼Œçœ¼ä¸­å……æ»¡äº†çƒ­æƒ…ã€‚"},
                                    {speaker: "å›½è‰¯", text: "æˆ‘ä»¬å¼ºè°ƒå›¢é˜Ÿç²¾ç¥å’Œäº’ç›¸æ”¯æŒï¼Œè¿™ä¸ä»…ä»…æ˜¯æ¯”èµ›çš„éœ€è¦ï¼Œä¹Ÿæ˜¯ç”Ÿæ´»çš„æ€åº¦ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "å¬èµ·æ¥å¾ˆæ¸©æš–ã€‚"},
                                    {speaker: "å›½è‰¯", text: "æ˜¯å•Š...æ›¾ç»æœ‰äººæ•™ä¼šæˆ‘ï¼Œåœ¨æŒ«æŠ˜é¢å‰æ°¸ä¸æ”¾å¼ƒçš„ç²¾ç¥ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–çš„ç›®å…‰å˜å¾—æŸ”å’Œï¼Œä¼¼ä¹æ²‰æµ¸åœ¨æŸç§å›å¿†ä¸­ã€‚"}
                                ]
                            };
                        }
                    }
                ]
            };
        }
        
        // é‡åˆ°ç¾å’²äº‹ä»¶
        function meetMisakiEvent() {
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "å’–å•¡å…é‡Œï¼Œä½ é‡åˆ°äº†å‡ ä½æœ‹å‹ï¼Œå¥¹ä»¬æ­£å’Œä¸€ä½æ°”è´¨ä¸å‡¡çš„å­¦å§èŠå¤©ã€‚"},
                    {speaker: "æœ‹å‹", text: "å¤å¥ˆï¼æ¥ï¼Œç»™ä½ ä»‹ç»ä¸€ä¸‹ï¼Œè¿™æ˜¯ç›¸æ³½ç¾å’²å­¦å§ï¼Œå­¦ç”Ÿä¼šä½“è‚²éƒ¨éƒ¨é•¿ã€‚"},
                    {speaker: "ç¾å’²", text: "ä½ å¥½ï¼Œç»“åŸåŒå­¦ã€‚å¬è¯´è¿‡ä½ ï¼Œå•†æ³•ç³»çš„ä¼˜ç§€å­¦ç”Ÿï¼Ÿ"},
                    {speaker: "å¤å¥ˆ", text: "å­¦å§å¥½ï¼Œè¿‡å¥–äº†..."},
                    {speaker: "ç¾å’²", text: "æœ€è¿‘å¬è¯´ä½ å’Œæå›½è‰¯èµ°å¾—å¾ˆè¿‘ï¼Ÿ"}
                ],
                choices: [
                    {
                        text: "å¦ç„¶æ‰¿è®¤",
                        action: function() {
                            addToLog("äº’åŠ¨", "ä½ å¦ç„¶æ‰¿è®¤ä¸æå›½è‰¯çš„æ¥è§¦ï¼Œç¾å’²æš—ç¤ºæå›½è‰¯å¯¹ä½ çš„æ€åº¦ä¸åŒå¯»å¸¸ï¼Œè¨€è¯­ä¸­æœ‰éšéšçš„æ•Œæ„ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "æ˜¯çš„ï¼Œæˆ‘åœ¨å¸®ç¯®çƒé˜Ÿå¤„ç†ä¸€äº›æ³•å¾‹äº‹åŠ¡ã€‚"},
                                    {speaker: "ç¾å’²", text: "å“¦ï¼ŸçœŸæ˜¯çƒ­å¿ƒå‘¢ã€‚ä¸è¿‡ï¼Œæå›½è‰¯è¿™ä¸ªäººæ¯”è¾ƒç‰¹åˆ«ï¼Œä¸æ˜¯å¾ˆå®¹æ˜“æ¥è¿‘çš„ç±»å‹ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "æˆ‘è§‰å¾—ä»–äººæŒºå¥½çš„ï¼Œè™½ç„¶æœ‰ç‚¹ä¸¥è‚ƒã€‚"},
                                    {speaker: "ç¾å’²", text: "æ˜¯å—ï¼Ÿé‚£çœ‹æ¥ä»–å¯¹ä½ æ€åº¦å¾ˆä¸ä¸€èˆ¬å‘¢ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ç›¸æ³½ç¾å’²å¾®ç¬‘ç€ï¼Œä½†ä½ æ„Ÿè§‰åˆ°ä¸€ç§éšéšçš„æ•Œæ„ã€‚"},
                                    {speaker: "ç¾å’²", text: "æ”¹å¤©æœ‰ç©ºä¸€èµ·èŠèŠå§ï¼Œæˆ‘å¯¹æå›½è‰¯çš„äº‹æƒ…...å¾ˆäº†è§£ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "ä½è°ƒå›åº”",
                        action: function() {
                            changeAttribute("wisdom", 2);
                            addToLog("äº’åŠ¨", "ä½ ä½è°ƒå›åº”ç¾å’²çš„é—®é¢˜ï¼Œå¥¹æåˆ°è‡ªå·±æ˜¯æå›½è‰¯çš„è€åŒå­¦ï¼Œå¹¶æš—ç¤ºäº†ä¸€äº›ä»–çš„è¿‡å»ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "åªæ˜¯å¶å°”å¸®ä¸€äº›å¿™è€Œå·²ï¼Œæ²¡ä»€ä¹ˆç‰¹åˆ«çš„å…³ç³»ã€‚"},
                                    {speaker: "ç¾å’²", text: "æ˜¯å—ï¼Ÿæå›½è‰¯å¯ä¸æ˜¯éšä¾¿è®©äººå¸®å¿™çš„ç±»å‹ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ç›¸æ³½ç¾å’²æ„å‘³æ·±é•¿åœ°çœ‹ç€ä½ ã€‚"},
                                    {speaker: "ç¾å’²", text: "æˆ‘å’Œæå›½è‰¯æ˜¯åŒä¸€å±Šçš„è€åŒå­¦äº†ï¼Œä»–ä»æ¥ä¸è½»æ˜“æ¥å—å¤–äººçš„å¸®åŠ©..."},
                                    {speaker: "å¤å¥ˆ", text: "ä¹Ÿè®¸æ˜¯çƒé˜ŸçœŸçš„éœ€è¦æ³•å¾‹æ–¹é¢çš„å»ºè®®å§ã€‚"},
                                    {speaker: "ç¾å’²", text: "æœ‰æ„æ€ã€‚ä½ çŸ¥é“ä»–ä¸ºä»€ä¹ˆä»çƒå‘˜å˜æˆæ•™ç»ƒå—ï¼Ÿ"}
                                ]
                            };
                        }
                    },
                    {
                        text: "åé—®å¥¹ä¸æå›½è‰¯çš„å…³ç³»",
                        action: function() {
                            changeAttribute("charm", 3);
                            addToLog("äº’åŠ¨", "ä½ åé—®ç¾å’²ä¸æå›½è‰¯çš„å…³ç³»ï¼Œå‡ºä¹å¥¹çš„æ„æ–™ï¼Œå¥¹æš—ç¤ºäº†æå›½è‰¯è¿‡å»çš„æŸäº›äº‹ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "å­¦å§ä¼¼ä¹å¯¹ææ•™ç»ƒå¾ˆå…³æ³¨å•Šï¼Ÿä½ ä»¬å…³ç³»å¾ˆå¥½å—ï¼Ÿ"},
                                    {speaker: "ç³»ç»Ÿ", text: "ç›¸æ³½ç¾å’²æ˜æ˜¾æ²¡æ–™åˆ°ä½ ä¼šè¿™ä¹ˆç›´æ¥ã€‚"},
                                    {speaker: "ç¾å’²", text: "æˆ‘ä»¬æ˜¯åŒå±ŠåŒå­¦ï¼Œåˆéƒ½åœ¨ä½“è‚²åœˆï¼Œäº†è§£æ˜¯å¾ˆè‡ªç„¶çš„äº‹ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "åŸæ¥å¦‚æ­¤ï¼Œé‚£å­¦å§åº”è¯¥å¾ˆäº†è§£ä»–çš„è¿‡å»å§ï¼Ÿ"},
                                    {speaker: "ç¾å’²", text: "å½“ç„¶ï¼ŒåŒ…æ‹¬ä»–æ˜¯æ€ä¹ˆå—ä¼¤çš„ï¼Œè¿˜æœ‰é‚£ä¸ª...ç®—äº†ï¼Œä¸è¯´ä¹Ÿç½¢ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "é‚£ä¸ªä»€ä¹ˆï¼Ÿå­¦å§å¦‚æœçŸ¥é“ä»€ä¹ˆï¼Œèƒ½å‘Šè¯‰æˆ‘å—ï¼Ÿ"},
                                    {speaker: "ç¾å’²", text: "æŠ±æ­‰ï¼Œæœ‰äº›äº‹ä¸æ˜¯æˆ‘è¯¥è¯´çš„ã€‚ä¸è¿‡...å°å¿ƒä¸è¦é‡è¹ˆåˆ«äººçš„è¦†è¾™ã€‚"}
                                ]
                            };
                        }
                    }
                ]
            };
        }
        
        // ç¾å’²å¯¹å³™äº‹ä»¶
        function misakiConfrontationEvent() {
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "ä½ åœ¨å¥èº«æˆ¿çœ‹åˆ°äº†æ­£åœ¨é”»ç‚¼çš„ç›¸æ³½ç¾å’²å­¦å§ã€‚"},
                    {speaker: "å¤å¥ˆ", text: "ç¾å’²å­¦å§ï¼Œå¥½å·§ã€‚"},
                    {speaker: "ç¾å’²", text: "ç»“åŸåŒå­¦...çœ‹æ¥ä½ æœ€è¿‘å’Œæå›½è‰¯è¿›å±•ä¸é”™ï¼Ÿ"},
                    {speaker: "å¤å¥ˆ", text: "æˆ‘ä»¬åˆä½œå¾—å¾ˆæ„‰å¿«ã€‚"}
                ],
                choices: [
                    {
                        text: "ç›´æ¥è¯¢é—®å¥¹å’Œæå›½è‰¯çš„å…³ç³»",
                        action: function() {
                            if (gameData.player.memoryFragments.length >= 5) {
                                collectMemoryFragment("memory9");
                                addToLog("è®°å¿†", "ç¾å’²é€éœ²ä½ çš„çˆ¶æ¯åœ¨é‚£æ¬¡æ„å¤–åè®©ä½ è½¬ä¸“ä¸šï¼Œè¿œç¦»å¯èƒ½è§¦å‘è®°å¿†çš„äººå’Œäº‹ã€‚");
                                return {
                                    dialogue: [
                                        {speaker: "å¤å¥ˆ", text: "å­¦å§å’Œææ•™ç»ƒæ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿä½ ä¼¼ä¹å¯¹æˆ‘ä»¬èµ°å¾—è¿‘å¾ˆåœ¨æ„ã€‚"},
                                        {speaker: "ç¾å’²", text: "å“¼ï¼Œç›´æ¥å•Šã€‚æˆ‘åªæ˜¯ä¸æƒ³çœ‹åˆ°å†å²é‡æ¼”ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "ä»€ä¹ˆå†å²ï¼Ÿ"},
                                        {speaker: "ç¾å’²", text: "ä½ çœŸçš„ä»€ä¹ˆéƒ½ä¸è®°å¾—äº†ï¼Ÿæœ‰æ„æ€..."},
                                        {speaker: "å¤å¥ˆ", text: "ä»€ä¹ˆæ„æ€ï¼Ÿæˆ‘è¯¥è®°å¾—ä»€ä¹ˆï¼Ÿ"},
                                        {speaker: "ç¾å’²", text: "ä½ çš„çˆ¶æ¯åšå¾—å¾ˆå½»åº•å˜›ã€‚é‚£æ¬¡æ„å¤–åï¼Œä»–ä»¬åšæŒè®©ä½ è½¬ä¸“ä¸šï¼Œè¿œç¦»ä¸€åˆ‡å¯èƒ½è§¦å‘è®°å¿†çš„äººå’Œäº‹..."},
                                        {speaker: "ç³»ç»Ÿ", text: "ç¾å’²çš„è¯è®©ä½ éœ‡æƒŠï¼Œä¸€æ®µå…³äºåŒ»é™¢å’Œçˆ¶æ¯è°ˆè¯çš„è®°å¿†æµ®ç°..."}
                                    ]
                                };
                            } else {
                                addToLog("äº’åŠ¨", "ä½ ç›´æ¥é—®ç¾å’²ä¸æå›½è‰¯çš„å…³ç³»ï¼Œå¥¹è¡¨ç¤ºåªæ˜¯å…³å¿ƒä»–ï¼Œæš—ç¤ºä»–ç»å†è¿‡ä¸€äº›ä¼¤å®³ã€‚");
                                return {
                                    dialogue: [
                                        {speaker: "å¤å¥ˆ", text: "å­¦å§å’Œææ•™ç»ƒæ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿä½ ä¼¼ä¹å¯¹æˆ‘ä»¬èµ°å¾—è¿‘å¾ˆåœ¨æ„ã€‚"},
                                        {speaker: "ç¾å’²", text: "åˆ«è¯¯ä¼šï¼Œæˆ‘åªæ˜¯ä½œä¸ºå­¦é•¿å…³å¿ƒä»–ã€‚æå›½è‰¯...ç»å†è¿‡ä¸€äº›äº‹æƒ…ï¼Œæˆ‘ä¸æƒ³çœ‹ä»–å†å—ä¼¤ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "å—ä¼¤ï¼Ÿé™¤äº†è†ä¼¤è¿˜æœ‰ä»€ä¹ˆï¼Ÿ"},
                                        {speaker: "ç¾å’²", text: "æœ‰äº›ä¼¤å£æ˜¯çœ‹ä¸è§çš„ã€‚å¦‚æœä½ åªæ˜¯ä¸€æ—¶å…´èµ·ï¼Œå»ºè®®ä½ ä¸è¦å¤ªæ·±å…¥ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "æˆ‘å¯¹ä»–æ˜¯è®¤çœŸçš„ã€‚"},
                                        {speaker: "ç¾å’²", text: "å¸Œæœ›å¦‚æ­¤ã€‚å¯¹äº†ï¼Œä½ çŸ¥é“æ¨±èŠ±æ ‘ä¸‹çš„çº¦å®šå—ï¼Ÿ"}
                                    ]
                                };
                            }
                        }
                    },
                    {
                        text: "å¹³é™åœ°è¡¨è¾¾å¯¹æå›½è‰¯çš„çœŸè¯šæ„Ÿæƒ…",
                        action: function() {
                            changeCharacterAffection("guoliang", 5);
                            addToLog("äº’åŠ¨", "ä½ è¡¨è¾¾äº†å¯¹æå›½è‰¯çš„çœŸè¯šæ„Ÿæƒ…ï¼Œç¾å’²è¢«æ‰“åŠ¨ï¼Œæåˆ°ä½ åƒæå›½è‰¯ä»¥å‰è®¤è¯†çš„é‚£ä¸ªå¥³å­©ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "æˆ‘å¾ˆçè§†ä¸ææ•™ç»ƒçš„æ¯ä¸€æ¬¡ç›¸å¤„ã€‚è¿™ä¸åªæ˜¯ä¸€æ—¶å…´èµ·çš„æ„Ÿæƒ…ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ç¾å’²ä¼¼ä¹è¢«ä½ çš„çœŸè¯šæ‰“åŠ¨ã€‚"},
                                    {speaker: "ç¾å’²", text: "...ä½ è¿™æ ·è¯´ï¼ŒçœŸçš„å¾ˆåƒå¥¹ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "åƒè°ï¼Ÿ"},
                                    {speaker: "ç¾å’²", text: "æ²¡ä»€ä¹ˆã€‚åªæ˜¯è§‰å¾—ä½ å’Œæå›½è‰¯ä»¥å‰è®¤è¯†çš„é‚£ä¸ªå¥³å­©å¾ˆåƒã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "ä»–ä»¥å‰çš„...å¥³æœ‹å‹ï¼Ÿ"},
                                    {speaker: "ç¾å’²", text: "æŸç§æ„ä¹‰ä¸Šæ˜¯å§ã€‚è¿™ä¸ªè¯é¢˜åˆ°æ­¤ä¸ºæ­¢ã€‚è®°ä½ï¼Œæœ‰äº›è®°å¿†æˆ–è®¸è¢«é—å¿˜æ˜¯æœ‰åŸå› çš„ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "è¯¢é—®å¥¹å¯¹è‡ªå·±çš„æ•Œæ„",
                        action: function() {
                            changeAttribute("wisdom", 3);
                            addToLog("äº’åŠ¨", "ä½ è¯¢é—®ç¾å’²å¯¹ä½ çš„æ•Œæ„ï¼Œå¥¹è§£é‡Šæ˜¯å‡ºäºè­¦æƒ•ï¼Œæš—ç¤ºæå›½è‰¯æ›¾å› ä¸€æ®µæ„Ÿæƒ…å—è¿‡ä¼¤ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "å­¦å§ï¼Œæˆ‘èƒ½æ„Ÿè§‰åˆ°ä½ å¯¹æˆ‘æœ‰äº›æ•Œæ„ï¼Œä¸ºä»€ä¹ˆï¼Ÿ"},
                                    {speaker: "ç¾å’²", text: "æ•Œæ„ï¼Ÿä¸ï¼Œæ˜¯è­¦æƒ•ã€‚æå›½è‰¯ä¸æ˜¯ç©å…·ï¼Œä»–å·²ç»å› ä¸ºä¸€æ®µæ„Ÿæƒ…å—è¿‡ä¼¤ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "æˆ‘ä»æœªæŠŠä»–å½“ç©å…·ã€‚ä¸è¿‡ï¼Œä½ è¯´çš„é‚£æ®µæ„Ÿæƒ…æ˜¯ä»€ä¹ˆï¼Ÿ"},
                                    {speaker: "ç¾å’²", text: "æˆ‘è¯´å¤ªå¤šäº†ã€‚æ€»ä¹‹ï¼Œå¦‚æœä½ åªæ˜¯æŠŠä»–å½“ä½œæ ¡å›­æ‹çˆ±çš„ç›®æ ‡ï¼Œè¯·åŠæ—¶æ”¶æ‰‹ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "æˆ‘ä¸çŸ¥é“ä½ æŒ‡çš„æ˜¯ä»€ä¹ˆï¼Œä½†æˆ‘å¯¹ä»–çš„æ„Ÿæƒ…æ˜¯çœŸå¿ƒçš„ã€‚"},
                                    {speaker: "ç¾å’²", text: "å¸Œæœ›å¦‚æ­¤ã€‚å‘½è¿æœ‰æ—¶å€™çœŸçš„å¾ˆå¥‡å¦™ï¼Œä¸æ˜¯å—ï¼Ÿ"}
                                ]
                            };
                        }
                    }
                ]
            };
        }
        
        // ç¯®çƒè®­ç»ƒäº‹ä»¶
        function basketballTrainingEvent() {
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "ä½ æ­£åœ¨ç¯®çƒåœºä¸€è§’ç»ƒä¹ æŠ•ç¯®ï¼Œè¿›æ­¥è™½ç„¶ä¸å¤§ï¼Œä½†ä½ æ²¡æœ‰æ”¾å¼ƒã€‚"},
                    {speaker: "å›½è‰¯", text: "æ‰‹è…•çš„åŠ›åº¦è¦å‡åŒ€ï¼ŒæŠ•ç¯®æ—¶ä¸¤åªæ‰‹è¦åè°ƒã€‚"},
                    {speaker: "å¤å¥ˆ", text: "å•Šï¼ææ•™ç»ƒ..."},
                    {speaker: "å›½è‰¯", text: "æˆ‘çœ‹ä½ æœ€è¿‘ç»å¸¸æ¥ç»ƒä¹ ï¼Œå¾ˆæœ‰æ¯…åŠ›ã€‚éœ€è¦æŒ‡å¯¼å—ï¼Ÿ"}
                ],
                choices: [
                    {
                        text: "æ¬£ç„¶æ¥å—",
                        action: function() {
                            changeCharacterAffection("guoliang", 8);
                            changeAttribute("basketball", 8);
                            addToLog("äº’åŠ¨", "æå›½è‰¯äº²è‡ªæŒ‡å¯¼ä½ æŠ•ç¯®æŠ€å·§ï¼Œä½ å­¦å¾—å¾ˆå¿«ï¼Œä»–æåˆ°æ›¾æœ‰äººé¼“åŠ±ä»–è½¬å‹åšæ•™ç»ƒã€‚");
                            if (gameData.player.memoryFragments.length >= 2 && !hasMemoryFragment("memory7")) {
                                collectMemoryFragment("memory7");
                                addToLog("è®°å¿†", "ä½ æƒ³èµ·è‡ªå·±æ›¾ç»é¼“åŠ±æŸäººä¸è¦æ”¾å¼ƒç¯®çƒï¼Œå»ºè®®ä»–å°è¯•åšæ•™ç»ƒã€‚");
                                return {
                                    dialogue: [
                                        {speaker: "å¤å¥ˆ", text: "çœŸçš„å—ï¼Ÿé‚£å¤ªå¥½äº†ï¼è¯·å¤šæŒ‡æ•™ï¼"},
                                        {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯ç«™åœ¨ä½ èº«åï¼Œè°ƒæ•´ä½ çš„å§¿åŠ¿ã€‚ä»–çš„åŠ¨ä½œå¾ˆä¸“ä¸šï¼Œä½†åˆå……æ»¡è€å¿ƒã€‚"},
                                        {speaker: "å›½è‰¯", text: "é‡å¿ƒè¦ç¨³ï¼Œç›®å…‰è¦ç›¯ä½ç¯®ç­ä¸Šçš„ä¸€ç‚¹...å¯¹ï¼Œå°±æ˜¯è¿™æ ·ã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "åœ¨ä»–çš„æŒ‡å¯¼ä¸‹ï¼Œä½ çš„çƒç«Ÿç„¶è¿›äº†ï¼"},
                                        {speaker: "å¤å¥ˆ", text: "è¿›äº†ï¼å¤ªç¥å¥‡äº†ï¼"},
                                        {speaker: "å›½è‰¯", text: "ä½ å­¦å¾—å¾ˆå¿«ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "å› ä¸ºæœ‰å¥½è€å¸ˆå•Šã€‚ä½ çœŸçš„å¾ˆæ“…é•¿æ•™åˆ«äººï¼Œå½“æ•™ç»ƒå¾ˆé€‚åˆä½ ã€‚"},
                                        {speaker: "å›½è‰¯", text: "...è°¢è°¢ã€‚å…¶å®å½“åˆæ˜¯æœ‰äººé¼“åŠ±æˆ‘è½¬å‹åšæ•™ç»ƒçš„ã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "ä»–çš„è¯è§¦å‘äº†ä½ çš„æŸæ®µè®°å¿†...ä½ æƒ³èµ·è‡ªå·±æ›¾ç»é¼“åŠ±æŸäººä¸è¦æ”¾å¼ƒç¯®çƒï¼Œå°è¯•åšæ•™ç»ƒ..."}
                                    ]
                                };
                            } else {
                                return {
                                    dialogue: [
                                        {speaker: "å¤å¥ˆ", text: "çœŸçš„å—ï¼Ÿé‚£å¤ªå¥½äº†ï¼è¯·å¤šæŒ‡æ•™ï¼"},
                                        {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯è¯¦ç»†åœ°æ•™å¯¼ä½ æ­£ç¡®çš„æŠ•ç¯®å§¿åŠ¿å’ŒæŠ€å·§ã€‚"},
                                        {speaker: "å›½è‰¯", text: "æŠ•ç¯®æ˜¯èŠ‚å¥å’Œæ„Ÿè§‰çš„ç»“åˆï¼Œå¤šç»ƒä¹ å°±ä¼šè¿›æ­¥çš„ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "è°¢è°¢ä½ çš„æŒ‡å¯¼ï¼Œæˆ‘ä¸€å®šä¼šåŠªåŠ›çš„ï¼"},
                                        {speaker: "å›½è‰¯", text: "ä½ çš„æ€åº¦å¾ˆå¥½ã€‚ç¯®çƒæœ€é‡è¦çš„ä¸æ˜¯å¤©èµ‹ï¼Œè€Œæ˜¯æ°¸ä¸æ”¾å¼ƒçš„ç²¾ç¥ã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "ä½ ä»¬ä¸€èµ·ç»ƒä¹ äº†å°†è¿‘ä¸€å°æ—¶ï¼Œä¸çŸ¥ä¸è§‰ä¸­ï¼Œä½ å’Œæå›½è‰¯çš„è·ç¦»ä¼¼ä¹è¿‘äº†ä¸å°‘ã€‚"}
                                    ]
                                };
                            }
                        }
                    },
                    {
                        text: "è¯·ä»–å±•ç¤ºç¤ºèŒƒ",
                        action: function() {
                            changeCharacterAffection("guoliang", 5);
                            addToLog("äº’åŠ¨", "æå›½è‰¯ç¤ºèŒƒäº†ä¼˜ç¾æµç•…çš„æŠ•ç¯®åŠ¨ä½œï¼Œç„¶åæ‰‹æŠŠæ‰‹æ•™ä½ æ­£ç¡®å§¿åŠ¿ï¼Œè¿‘è·ç¦»æ¥è§¦è®©ä½ å¿ƒè·³åŠ é€Ÿã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "èƒ½å…ˆçœ‹ä½ ç¤ºèŒƒä¸€ä¸‹æ ‡å‡†åŠ¨ä½œå—ï¼Ÿ"},
                                    {speaker: "å›½è‰¯", text: "å¯ä»¥ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯æ‹¿èµ·ç¯®çƒï¼Œè™½ç„¶åŠ¨ä½œå› ä¸ºè†ä¼¤æœ‰äº›é™åˆ¶ï¼Œä½†ä»–çš„æŠ•ç¯®å§¿åŠ¿ä¾ç„¶ä¼˜ç¾æµç•…ã€‚çƒç¨³ç¨³å‘½ä¸­ç¯®ç­ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "å¤ªå‰å®³äº†ï¼å³ä½¿å—ä¼¤ä¹Ÿè¿™ä¹ˆå‡†ï¼"},
                                    {speaker: "å›½è‰¯", text: "è†ä¼¤å½±å“çš„æ˜¯çˆ†å‘åŠ›å’Œå¼¹è·³ï¼ŒåŸºæœ¬åŠŸä¸ä¼šä¸¢ã€‚æ¥ï¼Œä½ è¯•è¯•ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–æ‰‹æŠŠæ‰‹æ•™ä½ æ­£ç¡®çš„æŠ•ç¯®å§¿åŠ¿ï¼Œè¿™ç§äº²å¯†çš„æŒ‡å¯¼è®©ä½ æœ‰äº›å¿ƒè·³åŠ é€Ÿã€‚"},
                                    {speaker: "å›½è‰¯", text: "é›†ä¸­æ³¨æ„åŠ›ï¼Œä¸è¦åˆ†å¿ƒã€‚ç¯®çƒéœ€è¦ä¸“æ³¨ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "è°¦è™šåœ°è¯´è‡ªå·±å¯èƒ½æ²¡æœ‰å¤©èµ‹",
                        action: function() {
                            changeAttribute("wisdom", 3);
                            addToLog("äº’åŠ¨", "ä½ è°¦è™šåœ°è¯´è‡ªå·±å¯èƒ½æ²¡æœ‰ç¯®çƒå¤©èµ‹ï¼Œæå›½è‰¯é¼“åŠ±ä½ ï¼Œç§°èµä½ åœ¨å•†æ³•ä¸Šçš„å¤©èµ‹ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "æˆ‘å¯èƒ½æ²¡æœ‰ç¯®çƒå¤©èµ‹...åªæ˜¯æƒ³å¤šäº†è§£ä½ çš„ä¸–ç•Œã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çœ‹ç€ä½ ï¼Œçœ¼ç¥ä¸­é—ªè¿‡ä¸€ä¸æ¸©æŸ”ã€‚"},
                                    {speaker: "å›½è‰¯", text: "å¤©èµ‹ä¸æ˜¯æœ€é‡è¦çš„ã€‚åšæŒå’Œçƒ­çˆ±æ‰æ˜¯ã€‚æ¥ï¼Œè¯•è¯•è¿™æ ·..."},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–è€å¿ƒåœ°æŒ‡å¯¼ä½ åŸºç¡€åŠ¨ä½œï¼Œä¸åŒå…¶çƒ¦åœ°çº æ­£æ¯ä¸€ä¸ªç»†èŠ‚ã€‚"},
                                    {speaker: "å›½è‰¯", text: "ä½ æ¯”ä½ æƒ³è±¡çš„è¦æœ‰å¤©èµ‹ã€‚åªæ˜¯éœ€è¦æ‰¾åˆ°æ­£ç¡®çš„æ–¹æ³•ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "çœŸçš„å—ï¼Ÿæˆ‘ä»¥ä¸ºè‡ªå·±å¾ˆç¬¨æ‹™..."},
                                    {speaker: "å›½è‰¯", text: "æ¯ä¸ªäººéƒ½æœ‰è‡ªå·±æ“…é•¿çš„é¢†åŸŸã€‚å°±åƒä½ åœ¨å•†æ³•ä¸Šçš„å¤©èµ‹ä¸€æ ·ä»¤äººå°è±¡æ·±åˆ»ã€‚"}
                                ]
                            };
                        }
                    }
                ]
            };
        }
        
        // è¯¾å ‚å±•ç¤ºæˆåŠŸäº‹ä»¶
        function presentationSuccessEvent() {
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "ä½ åœ¨å•†æ³•è¯¾ä¸Šåšäº†ä¸€ä¸ªå‡ºè‰²çš„ä½“è‚²èµåŠ©åˆåŒæ¡ˆä¾‹åˆ†æã€‚"},
                    {speaker: "æ•™æˆ", text: "ç»“åŸåŒå­¦çš„åˆ†æéå¸¸ä¸“ä¸šï¼Œç‰¹åˆ«æ˜¯å¯¹æ¡æ¬¾æ¼æ´çš„è§£è¯»å¾ˆæœ‰æ·±åº¦ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "ä¸‹è¯¾åï¼Œä½ æƒŠè®¶åœ°å‘ç°æå›½è‰¯ç«™åœ¨æ•™å®¤é—¨å£ã€‚"},
                    {speaker: "å¤å¥ˆ", text: "ææ•™ç»ƒï¼Ÿä½ æ€ä¹ˆåœ¨è¿™ï¼Ÿ"},
                    {speaker: "å›½è‰¯", text: "æˆ‘å¬è¯´ä½ ä»Šå¤©æœ‰ä¸ªé‡è¦çš„è¯¾å ‚å±•ç¤ºï¼Œæƒ³æ¥çœ‹çœ‹ã€‚ä½ çš„è¡¨ç°çœŸæ˜¯ä»¤äººå°è±¡æ·±åˆ»ã€‚"}
                ],
                choices: [
                    {
                        text: "æ„Ÿè°¢ä»–çš„æ”¯æŒ",
                        action: function() {
                            changeCharacterAffection("guoliang", 10);
                            addToLog("äº’åŠ¨", "ä½ æ„Ÿè°¢æå›½è‰¯ç‰¹æ„æ¥çœ‹ä½ çš„å±•ç¤ºï¼Œä»–é‚€è¯·ä½ ä¸€èµ·å–å’–å•¡ï¼Œæœ‰äººæš—ä¸­è§‚å¯Ÿç€ä½ ä»¬ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "è°¢è°¢ä½ ç‰¹æ„æ¥çœ‹æˆ‘çš„å±•ç¤ºï¼Œè¿™å¯¹æˆ‘æ„ä¹‰é‡å¤§ã€‚"},
                                    {speaker: "å›½è‰¯", text: "ä¸å®¢æ°”ã€‚ä½ å¸®äº†çƒé˜Ÿå¾ˆå¤šï¼Œè¿™æ˜¯æˆ‘åº”è¯¥åšçš„ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "ä½ çš„æ”¯æŒç»™äº†æˆ‘å¾ˆå¤§ä¿¡å¿ƒã€‚å¯¹äº†ï¼Œä½ æ˜¯æ€ä¹ˆçŸ¥é“æˆ‘ä»Šå¤©æœ‰å±•ç¤ºçš„ï¼Ÿ"},
                                    {speaker: "å›½è‰¯", text: "æˆ‘...å¶ç„¶å¬è¯´çš„ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–çš„è¡¨æƒ…æœ‰äº›ä¸è‡ªç„¶ï¼Œä¼¼ä¹éšç’äº†ä»€ä¹ˆã€‚"},
                                    {speaker: "å›½è‰¯", text: "æœ‰ç©ºä¸€èµ·å–æ¯å’–å•¡å—ï¼Ÿæˆ‘æƒ³è¯·ä½ å¸®ä¸ªå¿™ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "å½“ç„¶å¯ä»¥ï¼ç°åœ¨å°±èµ°å—ï¼Ÿ"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ ä»¬ä¸€èµ·ç¦»å¼€äº†æ•™å®¤ï¼Œæ²¡æ³¨æ„åˆ°è§’è½é‡Œç›¸æ³½ç¾å’²è‹¥æœ‰æ‰€æ€çš„ç›®å…‰ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "å¥½å¥‡ä»–ä¸ºä½•è€Œæ¥",
                        action: function() {
                            changeAttribute("wisdom", 3);
                            addToLog("äº’åŠ¨", "ä½ è¯¢é—®æå›½è‰¯ä¸ºä»€ä¹ˆæ¥çœ‹ä½ çš„å±•ç¤ºï¼Œä»–çš„è§£é‡Šæœ‰äº›ç‰µå¼ºï¼Œä¼¼ä¹éšè—ç€æ›´æ·±çš„å«ä¹‰ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "ä½ æ˜¯ç‰¹æ„æ¥çœ‹æˆ‘çš„å±•ç¤ºçš„å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"},
                                    {speaker: "å›½è‰¯", text: "..."},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯ç¨å¾®çŠ¹è±«äº†ä¸€ä¸‹ã€‚"},
                                    {speaker: "å›½è‰¯", text: "å› ä¸ºæˆ‘æƒ³äº†è§£æ›´å¤šä½ åœ¨ä¸“ä¸šä¸Šçš„è¡¨ç°ã€‚ä½œä¸ºçƒé˜Ÿæ³•å¾‹é¡¾é—®ï¼Œæˆ‘éœ€è¦ç¡®è®¤ä½ çš„èƒ½åŠ›ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "çœŸçš„åªæ˜¯å› ä¸ºè¿™ä¸ªï¼Ÿ"},
                                    {speaker: "å›½è‰¯", text: "è¿˜æœ‰...æˆ‘æƒ³æ”¯æŒä½ ï¼Œå°±åƒä½ ä¸€ç›´æ”¯æŒçƒé˜Ÿä¸€æ ·ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–çš„è¯ä¼¼ä¹æœ‰æ›´æ·±çš„å«ä¹‰ï¼Œä½†ä½ æ²¡èƒ½å®Œå…¨ç†è§£ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "å®³ç¾åœ°é‚€è¯·ä»–å…±è¿›æ™šé¤",
                        action: function() {
                            changeCharacterAffection("guoliang", 7);
                            addToLog("äº’åŠ¨", "ä½ é‚€è¯·æå›½è‰¯å…±è¿›æ™šé¤ï¼ŒæƒŠè®¶åœ°å‘ç°ä»–çŸ¥é“ä½ å–œæ¬¢çš„é£Ÿç‰©ï¼Œä»–çš„ååº”æœ‰äº›å¥‡æ€ªã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "æ—¢ç„¶ä½ æ¥äº†...è¦ä¸è¦ä¸€èµ·åƒæ™šé¥­ï¼Ÿä½œä¸ºä½ æ”¯æŒæˆ‘çš„æ„Ÿè°¢ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯ä¼¼ä¹æœ‰äº›æ„å¤–ï¼Œä½†éšå³å¾®ç¬‘ç‚¹å¤´ã€‚"},
                                    {speaker: "å›½è‰¯", text: "ä¹æ„ä¹‹è‡³ã€‚ä½ æœ‰ä»€ä¹ˆæƒ³åƒçš„å—ï¼Ÿ"},
                                    {speaker: "å¤å¥ˆ", text: "æˆ‘çŸ¥é“å­¦æ ¡é™„è¿‘æœ‰å®¶ä¸é”™çš„æ—¥æ–™åº—..."},
                                    {speaker: "å›½è‰¯", text: "æ—¥æ–™ï¼Ÿä½ å–œæ¬¢åƒä¸‰æ–‡é±¼åˆºèº«é…ç™½èåœæ³¥å—ï¼Ÿ"},
                                    {speaker: "å¤å¥ˆ", text: "æ˜¯å•Šï¼é‚£æ­£æ˜¯æˆ‘æœ€çˆ±çš„ï¼ä½ æ€ä¹ˆçŸ¥é“ï¼Ÿ"},
                                    {speaker: "å›½è‰¯", text: "åªæ˜¯...çŒœçš„ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–çš„çœ¼ç¥ä¸­é—ªè¿‡ä¸€ä¸å¤æ‚çš„æƒ…ç»ªï¼Œä½†å¾ˆå¿«æ¢å¤äº†å¹³é™ã€‚"}
                                ]
                            };
                        }
                    }
                ]
            };
        }
        
        // æ•™æˆå»ºè®®äº‹ä»¶
        function professorAdviceEvent() {
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "ä½ æ¥åˆ°åŠå…¬å®¤å‘å•†æ³•æ•™æˆè¯·æ•™å­¦ä¹ é—®é¢˜ã€‚"},
                    {speaker: "æ•™æˆ", text: "å¤å¥ˆï¼Œä½ æœ€è¿‘åœ¨åˆåŒæ³•æ–¹é¢çš„è¿›æ­¥å¾ˆå¤§ã€‚å°¤å…¶æ˜¯ä½“è‚²ç›¸å…³åˆåŒçš„åˆ†æå¾ˆæœ‰æ·±åº¦ã€‚"},
                    {speaker: "å¤å¥ˆ", text: "è°¢è°¢æ•™æˆã€‚æˆ‘æœ€è¿‘åœ¨å¸®ç¯®çƒé˜Ÿå¤„ç†ä¸€äº›èµåŠ©åˆåŒã€‚"},
                    {speaker: "æ•™æˆ", text: "æå›½è‰¯çš„çƒé˜Ÿå§ï¼Ÿæˆ‘å¬è¯´äº†ã€‚ä½ çŸ¥é“ä»–ä»¥å‰ä¹Ÿå¯¹å•†æ³•å¾ˆæ„Ÿå…´è¶£å—ï¼Ÿ"}
                ],
                choices: [
                    {
                        text: "è¡¨ç¤ºæƒŠè®¶",
                        action: function() {
                            if (gameData.player.memoryFragments.length >= 6 && !hasMemoryFragment("memory10")) {
                                collectMemoryFragment("memory10");
                                addToLog("è®°å¿†", "æ•™æˆæ— æ„ä¸­æåˆ°ä¸€æ¬¡æ„å¤–åæå›½è‰¯æ¥æ‰¾è¿‡ä»–ï¼Œè§¦å‘äº†ä½ å…³äºç—…æˆ¿å¤–è°ˆè¯çš„è®°å¿†ã€‚");
                                return {
                                    dialogue: [
                                        {speaker: "å¤å¥ˆ", text: "çœŸçš„å—ï¼Ÿæˆ‘ä¸çŸ¥é“ä»–è¿˜æœ‰è¿™æ–¹é¢çš„å…´è¶£ã€‚"},
                                        {speaker: "æ•™æˆ", text: "æ˜¯çš„ï¼Œä»–æ›¾ç»é€‰ä¿®è¿‡æˆ‘çš„è¯¾ã€‚é‚£æ¬¡æ„å¤–åï¼Œä»–æ¥æ‰¾è¿‡æˆ‘..."},
                                        {speaker: "å¤å¥ˆ", text: "ä»€ä¹ˆæ„å¤–ï¼Ÿ"},
                                        {speaker: "æ•™æˆ", text: "å•Šï¼Œæˆ‘å¯èƒ½è®°é”™äº†...æ€»ä¹‹ï¼Œå¤å¥ˆï¼Œæœ‰æ—¶å€™å‘½è¿çš„å®‰æ’å¾ˆå¾®å¦™ã€‚äººä¸äººä¹‹é—´çš„è¿æ¥ï¼Œå¾€å¾€æ¯”æˆ‘ä»¬æƒ³è±¡çš„è¦æ·±ã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "æ•™æˆçš„è¯è®©ä½ é™·å…¥æ€è€ƒã€‚ä¸€æ®µæ¨¡ç³Šçš„è®°å¿†æµ®ç°ï¼šç—…æˆ¿å¤–ï¼Œä¸¤ä¸ªäººåœ¨ä½å£°äº¤è°ˆ..."}
                                    ]
                                };
                            } else {
                                addToLog("äº’åŠ¨", "æ•™æˆå‘Šè¯‰ä½ æå›½è‰¯æ›¾å¯¹å•†æ³•æœ‰å…´è¶£ï¼Œæš—ç¤ºå¶ç„¶ç›¸é‡èƒŒåå¯èƒ½æœ‰æ›´å¤šæ•…äº‹ã€‚");
                                return {
                                    dialogue: [
                                        {speaker: "å¤å¥ˆ", text: "çœŸçš„å—ï¼Ÿæˆ‘ä¸çŸ¥é“ä»–è¿˜æœ‰è¿™æ–¹é¢çš„å…´è¶£ã€‚"},
                                        {speaker: "æ•™æˆ", text: "äººæ€»æ˜¯æœ‰å¾ˆå¤šé¢çš„ã€‚æœ‰æ—¶å€™ï¼Œçœ‹ä¼¼å¶ç„¶çš„ç›¸é‡èƒŒåï¼Œæˆ–è®¸è—ç€æ›´å¤šæ•…äº‹ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "æ•™æˆï¼Œæ‚¨è¿™è¯æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ"},
                                        {speaker: "æ•™æˆ", text: "æ²¡ä»€ä¹ˆï¼Œåªæ˜¯æ„Ÿæ…¨è€Œå·²ã€‚å¯¹äº†ï¼Œä¸‹å‘¨æœ‰ä¸ªä½“è‚²æ³•ç ”è®¨ä¼šï¼Œä½ æœ‰å…´è¶£å‚åŠ å—ï¼Ÿ"},
                                        {speaker: "å¤å¥ˆ", text: "å½“ç„¶æœ‰å…´è¶£ï¼"},
                                        {speaker: "æ•™æˆ", text: "å¾ˆå¥½ã€‚åˆ°æ—¶å€™ä½ å¯ä»¥é‚€è¯·æå›½è‰¯ä¸€èµ·ï¼Œä»–åº”è¯¥ä¼šæ„Ÿå…´è¶£ã€‚"}
                                    ]
                                };
                            }
                        }
                    },
                    {
                        text: "è¯¢é—®æ›´å¤šå…³äºæå›½è‰¯çš„äº‹",
                        action: function() {
                            changeAttribute("wisdom", 5);
                            addToLog("äº’åŠ¨", "ä½ è¯¢é—®æ•™æˆå¯¹æå›½è‰¯çš„äº†è§£ï¼Œä»–æåˆ°æå›½è‰¯æ˜¯ç‰¹åˆ«çš„å­¦ç”Ÿï¼Œæ‹¥æœ‰ç‹¬ç‰¹çš„æ³•å¾‹æ€è€ƒå’Œåº”å¯¹é€†å¢ƒçš„èƒ½åŠ›ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "æ•™æˆè®¤è¯†æå›½è‰¯å¾ˆä¹…äº†å—ï¼Ÿèƒ½å‘Šè¯‰æˆ‘æ›´å¤šå…³äºä»–çš„äº‹å—ï¼Ÿ"},
                                    {speaker: "æ•™æˆ", text: "æˆ‘å¯¹æ‰€æœ‰å­¦ç”Ÿéƒ½è®°å¿†æ·±åˆ»ï¼Œå°¤å…¶æ˜¯é‚£äº›ç‰¹åˆ«çš„å­¦ç”Ÿã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "ç‰¹åˆ«ï¼Ÿä»–æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„ï¼Ÿ"},
                                    {speaker: "æ•™æˆ", text: "é™¤äº†æ˜¯æ ¡é˜Ÿçš„æ˜æ˜Ÿçƒå‘˜å¤–ï¼Œä»–å¯¹æ³•å¾‹çš„æ€è€ƒå¾ˆæœ‰ç‹¬ç‰¹è§è§£ã€‚ä¸è¿‡åæ¥..."},
                                    {speaker: "å¤å¥ˆ", text: "åæ¥æ€ä¹ˆäº†ï¼Ÿ"},
                                    {speaker: "æ•™æˆ", text: "äººç”Ÿæ€»æœ‰èµ·ä¼ã€‚é‡è¦çš„æ˜¯å¦‚ä½•åœ¨é€†å¢ƒä¸­æ‰¾åˆ°æ–°çš„æ–¹å‘ã€‚æå›½è‰¯åšåˆ°äº†è¿™ç‚¹ï¼Œä»çƒå‘˜è½¬å‹ä¸ºæ•™ç»ƒã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æ•™æˆä¼¼ä¹æœ‰æ„å›é¿æŸäº›è¯é¢˜ï¼Œä½†ä½ è¿˜æ˜¯è·å¾—äº†ä¸€äº›å…³äºæå›½è‰¯çš„ä¿¡æ¯ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "è°ˆè®ºè‡ªå·±å¯¹å•†æ³•çš„å…´è¶£",
                        action: function() {
                            changeAttribute("law", 7);
                            addToLog("äº’åŠ¨", "ä½ è°ˆè®ºè‡ªå·±å¯¹å•†æ³•çš„å…´è¶£ï¼Œæ•™æˆæš—ç¤ºä½ å¥½åƒæ›¾æ¥è§¦è¿‡è¿™äº›çŸ¥è¯†ï¼Œæå‡ºäº†å…³äºè®°å¿†çš„å“²å­¦æ€è€ƒã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "æˆ‘å¾ˆäº«å—å­¦ä¹ å•†æ³•çš„è¿‡ç¨‹ï¼Œå°¤å…¶æ˜¯èƒ½å°†ç†è®ºåº”ç”¨åˆ°å®è·µä¸­ã€‚"},
                                    {speaker: "æ•™æˆ", text: "ä½ æœ‰å¤©èµ‹ï¼Œå¤å¥ˆã€‚æœ‰æ—¶å€™æˆ‘ç”šè‡³æ„Ÿè§‰ä½ å¥½åƒæ›¾ç»æ¥è§¦è¿‡è¿™äº›çŸ¥è¯†..."},
                                    {speaker: "å¤å¥ˆ", text: "æ€ä¹ˆä¼šï¼Ÿæˆ‘æ˜¯ç¬¬ä¸€æ¬¡å­¦ä¹ è¿™äº›å†…å®¹å•Šã€‚"},
                                    {speaker: "æ•™æˆ", text: "æœ‰æ—¶å€™ï¼ŒçŸ¥è¯†çš„å­¦ä¹ ä¸ä»…æ¥è‡ªè¯¾å ‚ï¼Œè¿˜å¯èƒ½æ¥è‡ªæˆ‘ä»¬é—å¿˜æˆ–å°šæœªå‘ç°çš„ç»å†ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "æ•™æˆä»Šå¤©è¯´è¯å¾ˆæœ‰å“²ç†å•Šã€‚"},
                                    {speaker: "æ•™æˆ", text: "å‘µå‘µï¼Œå¹´çºªå¤§äº†å°±å–œæ¬¢æ€è€ƒè¿™äº›ã€‚å¯¹äº†ï¼Œä½ å¯¹ä½“è‚²æ³•æœ‰å…´è¶£å—ï¼Ÿæˆ‘æœ‰ä¸€æœ¬å¾ˆå¥½çš„å‚è€ƒä¹¦å¯ä»¥å€Ÿç»™ä½ ã€‚"}
                                ]
                            };
                        }
                    }
                ]
            };
        }
        
        // æœ€ç»ˆå»ºè®®äº‹ä»¶
        function finalAdviceEvent() {
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "éšç€æ”¶é›†åˆ°çš„è®°å¿†ç¢ç‰‡è¶Šæ¥è¶Šå¤šï¼Œä½ å¼€å§‹å¯¹è‡ªå·±çš„è¿‡å»æ„Ÿåˆ°å›°æƒ‘ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "ä½ å†³å®šå»æ‰¾æ•™æˆå¯»æ±‚å»ºè®®ã€‚"},
                    {speaker: "æ•™æˆ", text: "å¤å¥ˆï¼Œä½ çœ‹èµ·æ¥æœ‰å¿ƒäº‹ï¼Ÿ"},
                    {speaker: "å¤å¥ˆ", text: "æ•™æˆ...å¦‚æœä¸€ä¸ªäººå¤±å»äº†é‡è¦çš„è®°å¿†ï¼Œåº”è¯¥æ€ä¹ˆåŠï¼Ÿ"}
                ],
                choices: [
                    {
                        text: "ç›´æ¥è¯¢é—®è‡ªå·±çš„è¿‡å»",
                        action: function() {
                            if (gameData.player.memoryFragments.length >= 10) {
                                collectMemoryFragment("memory12");
                                addToLog("è®°å¿†", "æ•™æˆé¼“åŠ±ä½ å»æ‰¾æå›½è‰¯é—®æ¸…çœŸç›¸ï¼Œä½ ç»ˆäºå¾—åˆ°æœ€åä¸€å—è®°å¿†ç¢ç‰‡ï¼Œç†è§£äº†å®Œæ•´çš„è¿‡å»ã€‚");
                                return {
                                    dialogue: [
                                        {speaker: "å¤å¥ˆ", text: "æ•™æˆï¼Œæˆ‘å’Œæå›½è‰¯ä»¥å‰è®¤è¯†ï¼Œå¯¹å—ï¼Ÿä¸åªæ˜¯æ™®é€šè®¤è¯†ï¼Œè€Œæ˜¯å¾ˆäº²å¯†çš„å…³ç³»..."},
                                        {speaker: "æ•™æˆ", text: "...ä½ æƒ³èµ·æ¥äº†ï¼Ÿ"},
                                        {speaker: "å¤å¥ˆ", text: "ä¸€äº›ç‰‡æ®µã€‚ä½†è¿˜ä¸å®Œæ•´ã€‚"},
                                        {speaker: "æ•™æˆ", text: "æœ‰äº›äº‹æƒ…ï¼Œæˆ–è®¸æ˜¯å‘½è¿çš„å®‰æ’ã€‚å¦‚æœä½ çœŸçš„æƒ³çŸ¥é“å…¨éƒ¨çœŸç›¸ï¼Œåº”è¯¥å»é—®æå›½è‰¯æœ¬äººã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "ä»–ä¸€ç›´çŸ¥é“ï¼Œå´æ²¡æœ‰å‘Šè¯‰æˆ‘ï¼Ÿ"},
                                        {speaker: "æ•™æˆ", text: "ä»–æœ‰ä»–çš„ç†ç”±ã€‚è®°å¿†æ˜¯å¾ˆå¤æ‚çš„ï¼Œå¼ºè¡Œå”¤é†’å¯èƒ½ä¼šé€ æˆä¼¤å®³ã€‚å»æ‰¾ä»–å§ï¼Œåœ¨æ¨±èŠ±æ ‘ä¸‹ã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "éšç€æ•™æˆçš„è¯ï¼Œæ‰€æœ‰è®°å¿†ç¢ç‰‡çªç„¶è”ç³»åœ¨ä¸€èµ·ï¼Œä½ ç»ˆäºæƒ³èµ·äº†å®Œæ•´çš„è¿‡å»..."}
                                    ]
                                };
                            } else {
                                addToLog("äº’åŠ¨", "ä½ è¯¢é—®è‡ªå·±ä¸æå›½è‰¯çš„è¿‡å»ï¼Œæ•™æˆå»ºè®®è®©è®°å¿†è‡ªç„¶æ¢å¤ï¼Œä¸è¦å¼ºè¡Œå›å¿†ã€‚");
                                return {
                                    dialogue: [
                                        {speaker: "å¤å¥ˆ", text: "æ•™æˆï¼Œæˆ‘å’Œæå›½è‰¯ä»¥å‰æ˜¯ä¸æ˜¯è®¤è¯†ï¼Ÿ"},
                                        {speaker: "æ•™æˆ", text: "è¿™ä¸ªé—®é¢˜...ä¸ºä»€ä¹ˆè¿™ä¹ˆé—®ï¼Ÿ"},
                                        {speaker: "å¤å¥ˆ", text: "æˆ‘æœ‰ä¸€äº›å¥‡æ€ªçš„æ„Ÿè§‰å’Œç‰‡æ®µè®°å¿†ï¼Œä½†æ— æ³•å®Œå…¨ç†è§£ã€‚"},
                                        {speaker: "æ•™æˆ", text: "å¤å¥ˆï¼Œè®°å¿†æ˜¯å¾ˆå¤æ‚çš„ã€‚æœ‰æ—¶å€™ï¼ŒçœŸç›¸ä¼šåœ¨é€‚å½“çš„æ—¶å€™è‡ªç„¶æ˜¾ç°ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "ä½†è¿™ç§ä¸ç¡®å®šæ„Ÿè®©æˆ‘å¾ˆå›°æ‰°..."},
                                        {speaker: "æ•™æˆ", text: "æˆ‘ç†è§£ã€‚ä¹Ÿè®¸ä½ éœ€è¦æ”¶é›†æ›´å¤šçº¿ç´¢ï¼Œè®©è®°å¿†è‡ªç„¶æ¢å¤ã€‚å¼ºè¡Œå›å¿†å¯èƒ½ä¼šé€‚å¾—å…¶åã€‚"}
                                    ]
                                };
                            }
                        }
                    },
                    {
                        text: "è¯¢é—®è®°å¿†æ¢å¤çš„æ–¹æ³•",
                        action: function() {
                            changeAttribute("wisdom", 5);
                            addToLog("äº’åŠ¨", "æ•™æˆä»å¿ƒç†å­¦è§’åº¦è§£é‡Šç†Ÿæ‚‰çš„ç¯å¢ƒå¯èƒ½è§¦å‘è®°å¿†ï¼Œæå‡ºé—å¿˜æœ‰æ—¶æ˜¯ä¸ºäº†è‡ªæˆ‘ä¿æŠ¤ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥å¸®åŠ©æ¢å¤é—å¤±çš„è®°å¿†å—ï¼Ÿ"},
                                    {speaker: "æ•™æˆ", text: "ä»å¿ƒç†å­¦è§’åº¦çœ‹ï¼Œç†Ÿæ‚‰çš„ç¯å¢ƒã€ç‰©å“æˆ–äººç‰©å¯èƒ½ä¼šè§¦å‘è®°å¿†ã€‚ä½†è¿™ä¸ªè¿‡ç¨‹éœ€è¦è‡ªç„¶å‘å±•ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "å¦‚æœ...è¿™äº›è®°å¿†å¾ˆé‡è¦å‘¢ï¼Ÿ"},
                                    {speaker: "æ•™æˆ", text: "é‡è¦çš„è®°å¿†å¾€å¾€ä¸ä¼šçœŸæ­£æ¶ˆå¤±ï¼Œåªæ˜¯æš‚æ—¶éšè—ã€‚å½“ä½ å‡†å¤‡å¥½é¢å¯¹å®ƒä»¬æ—¶ï¼Œå®ƒä»¬ä¼šå›æ¥çš„ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "å‡†å¤‡å¥½...æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ"},
                                    {speaker: "æ•™æˆ", text: "æœ‰æ—¶å€™æˆ‘ä»¬å¿˜è®°äº‹æƒ…æ˜¯æœ‰åŸå› çš„ã€‚å¯èƒ½æ˜¯ä¸ºäº†ä¿æŠ¤è‡ªå·±ï¼Œä¹Ÿå¯èƒ½æ˜¯éœ€è¦ä»¥æ–°çš„è§†è§’é‡æ–°è®¤è¯†ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æ•™æˆçš„è¯è®©ä½ è‹¥æœ‰æ‰€æ€ã€‚ä¹Ÿè®¸æ”¶é›†æ›´å¤šçš„è®°å¿†ç¢ç‰‡æ˜¯å…³é”®ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "è°ˆè®ºæ¨±èŠ±æ ‘çš„è®°å¿†",
                        action: function() {
                            if (hasMemoryFragment("memory5")) {
                                collectMemoryFragment("memory8");
                                addToLog("è®°å¿†", "æ•™æˆæåˆ°ä½ åœ¨é›¨å¤©ä¸ºäº†è§æŸäººå¥”è·‘æ‘”å€’çš„æ„å¤–ï¼Œè§¦å‘äº†ä½ å…³äºé‚£ä¸ªé›¨å¤©çš„è®°å¿†ã€‚");
                                return {
                                    dialogue: [
                                        {speaker: "å¤å¥ˆ", text: "æˆ‘ç»å¸¸æ¢¦åˆ°æ¨±èŠ±æ ‘ä¸‹çš„åœºæ™¯...æ„Ÿè§‰é‚£é‡Œå‘ç”Ÿè¿‡å¯¹æˆ‘å¾ˆé‡è¦çš„äº‹ã€‚"},
                                        {speaker: "æ•™æˆ", text: "æ ¡å›­é‡Œçš„é‚£æ£µæ¨±èŠ±æ ‘ç¡®å®è§è¯äº†è®¸å¤šçº¦å®šã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "æˆ‘ä¼¼ä¹å’ŒæŸäººåœ¨é‚£é‡Œæœ‰è¿‡çº¦å®š..."},
                                        {speaker: "æ•™æˆ", text: "ä¹Ÿè®¸ä½ åº”è¯¥å»é‚£é‡Œèµ°èµ°ï¼Œè®©è®°å¿†è‡ªç„¶æµ®ç°ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "è¿˜æœ‰ï¼Œæˆ‘å¥½åƒè®°å¾—ä¸€åœºé›¨...æˆ‘åœ¨æ ¡å›­é‡Œå¥”è·‘ï¼Œç„¶å...ä¸€ç‰‡é»‘æš—ã€‚"},
                                        {speaker: "æ•™æˆ", text: "...é‚£æ¬¡æ„å¤–ã€‚æ˜¯çš„ï¼Œé‚£å¤©é›¨å¾ˆå¤§ï¼Œä½ ä¸ºäº†èµ¶å»è§æŸäººï¼Œåœ¨æ ¡å›­é‡Œè·‘å¾—å¤ªå¿«ï¼Œä¸å°å¿ƒæ»‘å€’..."},
                                        {speaker: "ç³»ç»Ÿ", text: "æ•™æˆçš„è¯è§¦å‘äº†ä½ å…³äºé‚£ä¸ªé›¨å¤©çš„è®°å¿†...ä½ æƒ³èµ·è‡ªå·±åœ¨é›¨ä¸­å¥”è·‘ï¼Œæ‘”å€’ï¼Œç„¶ååœ¨åŒ»é™¢é†’æ¥..."}
                                    ]
                                };
                            } else {
                                addToLog("äº’åŠ¨", "ä½ æåˆ°æ¨±èŠ±æ ‘ç»™ä½ çš„å¥‡æ€ªæ„Ÿè§‰ï¼Œæ•™æˆå»ºè®®å¤šå»é‚£é‡Œèµ°èµ°ï¼Œè®©è®°å¿†è‡ªç„¶æµ®ç°ã€‚");
                                return {
                                    dialogue: [
                                        {speaker: "å¤å¥ˆ", text: "æ¯æ¬¡çœ‹åˆ°æ ¡å›­é‡Œçš„æ¨±èŠ±æ ‘ï¼Œæˆ‘éƒ½æœ‰ç§å¥‡æ€ªçš„æ„Ÿè§‰..."},
                                        {speaker: "æ•™æˆ", text: "æ¨±èŠ±æ ‘å¯¹å¾ˆå¤šäººæ¥è¯´éƒ½æ˜¯ç‰¹åˆ«çš„åœ°æ–¹ã€‚æœ‰äººåœ¨é‚£é‡Œå‘Šç™½ï¼Œæœ‰äººåœ¨é‚£é‡Œçº¦å®š..."},
                                        {speaker: "å¤å¥ˆ", text: "çº¦å®š...è¿™ä¸ªè¯è®©æˆ‘å¿ƒè·³åŠ é€Ÿã€‚"},
                                        {speaker: "æ•™æˆ", text: "ä¹Ÿè®¸ä½ è¯¥å¤šå»é‚£é‡Œèµ°èµ°ï¼Œè®©è®°å¿†è‡ªç„¶æµ®ç°ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "æ‚¨è¯´å¾—å¯¹ï¼Œæˆ‘ä¼šè¯•è¯•çš„ã€‚"},
                                        {speaker: "æ•™æˆ", text: "è®°ä½ï¼Œæœ‰äº›äº‹ä¸éœ€è¦æ€¥äºæ±‚æˆã€‚é¡ºå…¶è‡ªç„¶ï¼Œç­”æ¡ˆä¼šåœ¨é€‚å½“çš„æ—¶å€™å‡ºç°ã€‚"}
                                    ]
                                };
                            }
                        }
                    }
                ]
            };
        }
        
        // æ¨±èŠ±æ ‘ä¸‹çš„çœŸç›¸
        function finalRevealEvent() {
            gameData.gameState.storyFlag = 5;
            addToLog("å‰§æƒ…è¿›å±•", "ä½ åœ¨æ¨±èŠ±æ ‘ä¸‹ä¸æå›½è‰¯ç›¸è§ï¼Œä»–æ‰¿è®¤ä¸€ç›´çŸ¥é“ä½ ä»¬çš„è¿‡å»ã€‚");
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "æ”¶é›†åˆ°è¶³å¤Ÿå¤šçš„è®°å¿†ç¢ç‰‡åï¼Œä½ å†³å®šå‰å¾€æ ¡å›­ä¸­é‚£æ£µæ¨±èŠ±æ ‘ï¼Œå¸Œæœ›åœ¨é‚£é‡Œæ‰¾åˆ°æœ€åçš„ç­”æ¡ˆã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "å½“ä½ åˆ°è¾¾æ—¶ï¼Œæå›½è‰¯å·²ç»ç«™åœ¨é‚£é‡Œç­‰ä½ äº†ï¼Œä»¿ä½›ä»–çŸ¥é“ä½ ä¼šæ¥ã€‚"},
                    {speaker: "å¤å¥ˆ", text: "ä½ ä¸€ç›´éƒ½çŸ¥é“ï¼Œæ˜¯å—ï¼Ÿ"},
                    {speaker: "å›½è‰¯", text: "...æ˜¯çš„ã€‚"},
                    {speaker: "å¤å¥ˆ", text: "ä¸ºä»€ä¹ˆä¸å‘Šè¯‰æˆ‘ï¼Ÿ"}
                ],
                choices: [
                    {
                        text: "è¡¨è¾¾å¯¹è¢«éšç’çš„å¤±æœ›",
                        action: function() {
                            addToLog("äº’åŠ¨", "ä½ è¡¨è¾¾äº†å¯¹è¢«éšç’çœŸç›¸çš„å¤±æœ›ï¼Œæå›½è‰¯è§£é‡Šæ˜¯éµåŒ»å˜±å’Œä½ çˆ¶æ¯æ„æ„¿ï¼Œæ‹…å¿ƒå¼ºè¡Œå”¤é†’è®°å¿†ä¼šä¼¤å®³ä½ ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "ä½ çŸ¥é“æˆ‘æœ‰å¤šå›°æƒ‘å—ï¼Ÿä¸€ä¸ªä¸ªç¢ç‰‡è®°å¿†æŠ˜ç£¨ç€æˆ‘ï¼Œè€Œä½ å´ä»€ä¹ˆéƒ½ä¸è¯´ã€‚"},
                                    {speaker: "å›½è‰¯", text: "åŒ»ç”Ÿè¯´å¼ºè¡Œå”¤é†’è®°å¿†å¯èƒ½ä¼šå¯¹ä½ é€ æˆäºŒæ¬¡ä¼¤å®³ã€‚ä½ çˆ¶æ¯ä¹Ÿå¸Œæœ›ä½ è¿œç¦»é‚£äº›ç—›è‹¦çš„å›å¿†..."},
                                    {speaker: "å¤å¥ˆ", text: "ä¸æ˜¯ä½ å†³å®šçš„äº‹ï¼è¿™æ˜¯æˆ‘çš„è®°å¿†ï¼Œæˆ‘çš„äººç”Ÿï¼"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯ä½ä¸‹å¤´ï¼Œç¥æƒ…æ„§ç–šã€‚"},
                                    {speaker: "å›½è‰¯", text: "å¯¹ä¸èµ·...æˆ‘åªæ˜¯ä¸æƒ³å†æ¬¡ä¼¤å®³ä½ ã€‚é‚£æ¬¡æ„å¤–æ˜¯å› ä¸ºæˆ‘..."},
                                    {speaker: "å¤å¥ˆ", text: "å› ä¸ºä½ å—ä¼¤ï¼Œæˆ‘å¤ªæ‹…å¿ƒï¼Œåœ¨é›¨ä¸­å¥”è·‘å»çœ‹ä½ ï¼Œç„¶åæ»‘å€’...å¯¹å—ï¼Ÿ"},
                                    {speaker: "å›½è‰¯", text: "ä½ æƒ³èµ·æ¥äº†ï¼Ÿæ˜¯çš„ï¼Œæˆ‘ä¸€ç›´è´£å¤‡è‡ªå·±ã€‚å¦‚æœä¸æ˜¯æˆ‘å—ä¼¤ï¼Œä½ å°±ä¸ä¼š..."},
                                    {speaker: "å¤å¥ˆ", text: "é‚£ä¸æ˜¯ä½ çš„é”™ã€‚é‚£æ˜¯æˆ‘è‡ªå·±çš„é€‰æ‹©ã€‚æˆ‘ä»¬...åœ¨è¿™æ£µæ¨±èŠ±æ ‘ä¸‹æœ‰ä¸ªçº¦å®šï¼Œå¯¹å—ï¼Ÿ"}
                                ]
                            };
                        }
                    },
                    {
                        text: "å¹³é™åœ°è¯¢é—®è¿‡å»",
                        action: function() {
                            changeCharacterAffection("guoliang", 10);
                            addToLog("äº’åŠ¨", "æå›½è‰¯è®²è¿°äº†ä½ ä»¬çš„è¿‡å»ï¼šé«˜ä¸­åŒå­¦ã€ç›¸æ‹ã€ä»–çš„æ¯”èµ›å—ä¼¤ã€ä½ çš„é¼“åŠ±ã€æ¨±èŠ±æ ‘ä¸‹çš„çº¦å®šï¼Œä»¥åŠä½ çš„æ„å¤–å¤±å¿†ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "èƒ½å‘Šè¯‰æˆ‘æˆ‘ä»¬ä¹‹é—´çš„è¿‡å»å—ï¼Ÿå®Œæ•´çš„ç‰ˆæœ¬ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯æ·±æ·±åœ°çœ‹ç€ä½ ï¼Œçœ¼ä¸­æ»¡æ˜¯å¤æ‚çš„æƒ…æ„Ÿã€‚"},
                                    {speaker: "å›½è‰¯", text: "æˆ‘ä»¬æ˜¯é«˜ä¸­åŒå­¦ï¼Œä¸€èµ·ä¸Šå•†æ³•é€‰ä¿®è¯¾ã€‚ä½ å¾ˆæœ‰å¤©èµ‹ï¼Œç»å¸¸å¸®æˆ‘è§£ç­”é—®é¢˜ã€‚"},
                                    {speaker: "å›½è‰¯", text: "åæ¥æˆ‘ä»¬ç›¸çˆ±äº†ã€‚æˆ‘æ˜¯çƒé˜Ÿçš„ä¸»åŠ›ï¼Œä½ æ€»æ˜¯åœ¨çœ‹å°ä¸Šä¸ºæˆ‘åŠ æ²¹ã€‚"},
                                    {speaker: "å›½è‰¯", text: "é‚£åœºæ¯”èµ›æˆ‘æƒ³ç»™ä½ ä¸€ä¸ªå®Œç¾è¡¨ç°ï¼Œå†’é™©åšäº†ä¸€ä¸ªé«˜éš¾åº¦åŠ¨ä½œï¼Œç»“æœè†ç›–å—ä¼¤..."},
                                    {speaker: "å›½è‰¯", text: "ä½ æ¯å¤©éƒ½æ¥åŒ»é™¢é™ªæˆ‘ï¼Œé¼“åŠ±æˆ‘ä¸è¦æ”¾å¼ƒç¯®çƒï¼Œå¯ä»¥è½¬å‹åšæ•™ç»ƒã€‚"},
                                    {speaker: "å›½è‰¯", text: "å°±åœ¨è¿™æ£µæ¨±èŠ±æ ‘ä¸‹ï¼Œæˆ‘ä»¬çº¦å®šï¼šç­‰æˆ‘æˆä¸ºæ•™ç»ƒçš„é‚£å¤©ï¼Œä½ è¦ç­”åº”åšæˆ‘çš„å¥³æœ‹å‹ã€‚"},
                                    {speaker: "å›½è‰¯", text: "ä½†ä¸€ä¸ªé›¨å¤©ï¼Œä½ åŒ†å¿™æ¥åŒ»é™¢çœ‹æˆ‘ï¼Œåœ¨æ ¡å›­é‡Œè·‘å¾—å¤ªå¿«...é‚£æ¬¡æ„å¤–åï¼Œä½ å¤±å»äº†å…³äºæˆ‘ä»¬çš„è®°å¿†ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "ä¸»åŠ¨åˆ†äº«æ¢å¤çš„è®°å¿†",
                        action: function() {
                            changeCharacterAffection("guoliang", 15);
                            addToLog("äº’åŠ¨", "ä½ åˆ†äº«äº†å·²æ¢å¤çš„è®°å¿†ç‰‡æ®µï¼Œæå›½è‰¯æ—¢æƒŠå–œåˆæ„ŸåŠ¨ï¼Œè§£é‡ŠåŒ»ç”Ÿå’Œä½ çˆ¶æ¯ä¸ºä½•éšç’çœŸç›¸ï¼Œæ„Ÿå¹å‘½è¿çš„å®‰æ’ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "æˆ‘è®°èµ·æ¥äº†ã€‚ä¸æ˜¯å…¨éƒ¨ï¼Œä½†è¶³å¤Ÿå¤š...æˆ‘ä»¬çš„å•†æ³•è¯¾ï¼Œä½ çš„æ¯”èµ›ï¼ŒåŒ»é™¢çš„æ—¥å­ï¼Œè¿˜æœ‰è¿™æ£µæ ‘ä¸‹çš„çº¦å®šã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çš„çœ¼ç›äº®äº†èµ·æ¥ï¼Œä»¿ä½›æœ‰æ˜Ÿå…‰é—ªçƒã€‚"},
                                    {speaker: "å›½è‰¯", text: "ä½ ...çœŸçš„è®°å¾—ï¼Ÿ"},
                                    {speaker: "å¤å¥ˆ", text: "å—¯ã€‚è™½ç„¶è¿˜æœ‰äº›æ¨¡ç³Šï¼Œä½†æˆ‘è®°å¾—æœ€é‡è¦çš„éƒ¨åˆ†ã€‚ä½ ç­‰äº†æˆ‘è¿™ä¹ˆä¹…..."},
                                    {speaker: "å›½è‰¯", text: "æˆ‘è¯´è¿‡ä¼šç­‰ä½ è®°èµ·æ¥ã€‚æ— è®ºå¤šä¹…ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "åŒ»ç”Ÿå’Œæˆ‘çˆ¶æ¯ä¸ºä»€ä¹ˆè¦éšç’ï¼Ÿ"},
                                    {speaker: "å›½è‰¯", text: "æ„å¤–åï¼ŒåŒ»ç”Ÿè¯´ä½ çš„è®°å¿†åˆ›ä¼¤éœ€è¦æ—¶é—´è‡ªæ„ˆï¼Œå¼ºè¡Œå”¤é†’å¯èƒ½å¯¼è‡´æ›´ä¸¥é‡çš„é—®é¢˜ã€‚"},
                                    {speaker: "å›½è‰¯", text: "ä½ çˆ¶æ¯è®¤ä¸ºæ˜¯æˆ‘é—´æ¥å¯¼è‡´äº†æ„å¤–ï¼Œå¸Œæœ›ä½ è¿œç¦»ç¯®çƒå’Œæˆ‘...æ‰€ä»¥ä½ è¢«è½¬åˆ°å•†æ³•ä¸“ä¸šã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "ä½†å‘½è¿è¿˜æ˜¯è®©æˆ‘ä»¬ç›¸é‡äº†..."}
                                ]
                            };
                        }
                    }
                ]
            };
        }
        
        // é«˜äº²å¯†åº¦ç‰¹æ®Šå‰§æƒ… - é›¨ä¸­ç›¸æ‹¥
        function specialRainEvent() {
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "ä¸€åœºçªå¦‚å…¶æ¥çš„å¤§é›¨æŠŠä½ å›°åœ¨äº†ç¯®çƒé¦†ã€‚è®­ç»ƒç»“æŸåï¼Œåªå‰©ä¸‹ä½ å’Œæå›½è‰¯ä¸¤äººã€‚"},
                    {speaker: "å›½è‰¯", text: "é›¨å¤ªå¤§äº†ï¼Œæˆ‘é€ä½ å›å»å§ã€‚"},
                    {speaker: "å¤å¥ˆ", text: "ä½†ä½ æ²¡å¸¦ä¼å•Šã€‚"},
                    {speaker: "å›½è‰¯", text: "æ•™ç»ƒåŠå…¬å®¤æœ‰ä¸€æŠŠã€‚è™½ç„¶ä¸å¤§ï¼Œä½†æŒ¤ä¸€æŒ¤åº”è¯¥å¤Ÿäº†ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯æ‹¿æ¥ä¸€æŠŠé»‘è‰²æŠ˜å ä¼ï¼Œä½ ä»¬ä¸€èµ·èµ°å…¥é›¨ä¸­ã€‚å°ä¼ä¸‹ï¼Œä½ ä»¬ä¸å¾—ä¸é å¾—å¾ˆè¿‘ã€‚"}
                ],
                choices: [
                    {
                        text: "è‡ªç„¶åœ°æŒ½ä½ä»–çš„æ‰‹è‡‚",
                        action: function() {
                            changeCharacterAffection("guoliang", 12);
                            addToLog("ç‰¹æ®Šäº’åŠ¨", "é›¨ä¸­å…±ä¼æ—¶ä½ æŒ½ä½æå›½è‰¯çš„æ‰‹è‡‚ï¼Œä¸€é˜µå¼ºé£è®©ä»–ä¿æŠ¤æ€§åœ°ç¯ä½ä½ çš„è‚©è†€ï¼Œä»–è½»å»äº†ä½ çš„é¢å¤´ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ è‡ªç„¶åœ°æŒ½ä½æå›½è‰¯çš„æ‰‹è‡‚ï¼Œæ„Ÿå—åˆ°ä»–èº«ä½“ç¬é—´çš„åƒµç¡¬ï¼Œç„¶åæ…¢æ…¢æ”¾æ¾ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "é›¨å£°æ·…æ²¥ï¼Œä¼ä¸‹çš„ä¸–ç•Œä»¿ä½›åªæœ‰ä½ ä»¬ä¸¤äººã€‚æå›½è‰¯çš„ä½“æ¸©é€è¿‡è¡£æœä¼ æ¥ï¼Œè®©ä½ æ„Ÿåˆ°å®‰å¿ƒã€‚"},
                                    {speaker: "å›½è‰¯", text: "å°å¿ƒè·¯æ»‘..."},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–çš„å£°éŸ³æ¯”å¹³æ—¶ä½æ²‰ï¼Œå¸¦ç€ä¸€ä¸ä½ ä»æœªå¬è¿‡çš„æ¸©æŸ”ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "å—¯...è°¢è°¢ä½ ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ ä»¬èµ°åˆ°ä¸€ä¸ªæ‹è§’ï¼Œçªç„¶ä¸€é˜µå¼ºé£å¹æ¥ï¼Œé›¨ä¼å‡ ä¹è¢«å¹ç¿»ã€‚æå›½è‰¯è¿…é€Ÿè½¬èº«ï¼Œä¸€æ‰‹æŠ“ç´§é›¨ä¼ï¼Œä¸€æ‰‹ä¿æŠ¤æ€§åœ°ç¯ä½ä½ çš„è‚©è†€ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "è¿™ä¸ªçªç„¶çš„æ‹¥æŠ±è®©ä½ ä»¬éƒ½æ„£ä½äº†ã€‚é›¨æ°´æ‰“æ¹¿äº†ä½ ä»¬çš„è¡£æœï¼Œä½†æ­¤åˆ»è°éƒ½æ²¡æœ‰åœ¨æ„ã€‚"},
                                    {speaker: "å›½è‰¯", text: "å¯¹ä¸èµ·ï¼Œæˆ‘..."},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ æŠ¬å¤´çœ‹ç€ä»–ï¼Œé›¨æ°´é¡ºç€ä»–çš„è„¸é¢Šæ»‘è½ã€‚ä¸€ç§å¥‡æ€ªçš„ç†Ÿæ‚‰æ„Ÿæ¶Œä¸Šå¿ƒå¤´ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "ä¸...æ²¡å…³ç³»ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ ä»¬çš„ç›®å…‰åœ¨é›¨ä¸­äº¤æ±‡ï¼Œæ—¶é—´ä»¿ä½›é™æ­¢ã€‚æå›½è‰¯æ…¢æ…¢ä½ä¸‹å¤´ï¼Œè½»è½»å»äº†ä½ çš„é¢å¤´ï¼Œå¦‚æ­¤è‡ªç„¶ï¼Œåˆå¦‚æ­¤ç†Ÿæ‚‰ã€‚"},
                                    {speaker: "å›½è‰¯", text: "æˆ‘ä»¬è¯¥ç»§ç»­èµ°äº†...é›¨è¶Šæ¥è¶Šå¤§äº†ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "è¿™ä¸€åˆ»ï¼Œè™½ç„¶çŸ­æš‚ï¼Œå´åœ¨ä½ å¿ƒä¸­ç•™ä¸‹äº†æ·±åˆ»çš„å°è®°ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "ä¸å°å¿ƒæ»‘å€’",
                        action: function() {
                            changeCharacterAffection("guoliang", 10);
                            addToLog("ç‰¹æ®Šäº’åŠ¨", "é›¨ä¸­ä½ ä¸å°å¿ƒæ»‘å€’ï¼Œæå›½è‰¯ç´§æ€¥æŠ±ä½ä½ é˜²æ­¢æ‘”å€’ï¼Œè§¦å‘äº†ä½ å¯¹é‚£ä¸ªæ„å¤–é›¨å¤©çš„è®°å¿†ã€‚");
                            if (gameData.player.memoryFragments.length >= 4 && !hasMemoryFragment("memory8")) {
                                collectMemoryFragment("memory8");
                                return {
                                    dialogue: [
                                        {speaker: "ç³»ç»Ÿ", text: "ä½ ä»¬èµ°åœ¨æ¹¿æ»‘çš„è·¯ä¸Šï¼Œçªç„¶ä½ ä¸€ä¸ªè¸‰è·„ï¼Œè„šä¸‹æ‰“æ»‘ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "å•Šï¼"},
                                        {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯ååº”æå¿«ï¼Œä¸¢ä¸‹é›¨ä¼ï¼Œä¸€æŠŠæŠ±ä½ä½ é˜²æ­¢ä½ æ‘”å€’ã€‚é›¨æ°´ç¬é—´æ‰“æ¹¿äº†ä½ ä»¬ä¸¤äººã€‚"},
                                        {speaker: "å›½è‰¯", text: "æ²¡äº‹å§ï¼Ÿå¤ªå±é™©äº†..."},
                                        {speaker: "ç³»ç»Ÿ", text: "ä»–çš„çœ¼ä¸­å……æ»¡æ‹…å¿§ï¼Œç´§ç´§æŠ±ç€ä½ çš„å§¿åŠ¿è®©ä½ æƒ³èµ·äº†ä»€ä¹ˆ..."},
                                        {speaker: "å¤å¥ˆ", text: "è¿™ç§æ„Ÿè§‰...å¥½ç†Ÿæ‚‰..."},
                                        {speaker: "ç³»ç»Ÿ", text: "ä¸€æ®µå…³äºé›¨å¤©å’Œæ„å¤–çš„è®°å¿†çªç„¶é—ªç°...ä½ çœ‹åˆ°è‡ªå·±åœ¨é›¨ä¸­å¥”è·‘ï¼Œç„¶åæ»‘å€’..."},
                                        {speaker: "å¤å¥ˆ", text: "é‚£ä¸ªé›¨å¤©...æˆ‘åœ¨å»åŒ»é™¢çœ‹ä½ çš„è·¯ä¸Šæ‘”å€’äº†ï¼Œå¯¹å—ï¼Ÿ"},
                                        {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯éœ‡æƒŠåœ°çœ‹ç€ä½ ï¼Œç„¶åæ…¢æ…¢ç‚¹å¤´ã€‚"},
                                        {speaker: "å›½è‰¯", text: "ä½ è®°èµ·æ¥äº†ï¼Ÿ"},
                                        {speaker: "å¤å¥ˆ", text: "ä¸€äº›ç‰‡æ®µ...é‚£æ¬¡æ„å¤–åæˆ‘å¤±å»äº†è®°å¿†ï¼Ÿ"},
                                        {speaker: "å›½è‰¯", text: "æ˜¯çš„...ä½ è®°èµ·äº†å¤šå°‘ï¼Ÿ"},
                                        {speaker: "å¤å¥ˆ", text: "ä¸å¤šï¼Œä½†...æˆ‘ä»¬æ›¾ç»å¾ˆäº²å¯†ï¼Œå¯¹å—ï¼Ÿ"},
                                        {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çš„çœ¼ç¥å¤æ‚è€Œæ·±æƒ…ï¼Œä»–è½»è½»æŠšæ‘¸ä½ æ¹¿æ¼‰æ¼‰çš„å¤´å‘ã€‚"},
                                        {speaker: "å›½è‰¯", text: "è®°å¿†ä¼šæ…¢æ…¢å›æ¥çš„ã€‚æˆ‘ä¼šä¸€ç›´åœ¨è¿™é‡Œç­‰ä½ ..."}
                                    ]
                                };
                            } else {
                                return {
                                    dialogue: [
                                        {speaker: "ç³»ç»Ÿ", text: "ä½ ä»¬èµ°åœ¨æ¹¿æ»‘çš„è·¯ä¸Šï¼Œçªç„¶ä½ ä¸€ä¸ªè¸‰è·„ï¼Œè„šä¸‹æ‰“æ»‘ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "å•Šï¼"},
                                        {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯ååº”æå¿«ï¼Œä¸¢ä¸‹é›¨ä¼ï¼Œä¸€æŠŠæŠ±ä½ä½ é˜²æ­¢ä½ æ‘”å€’ã€‚é›¨æ°´ç¬é—´æ‰“æ¹¿äº†ä½ ä»¬ä¸¤äººã€‚"},
                                        {speaker: "å›½è‰¯", text: "å°å¿ƒ...ä½ æ²¡äº‹å§ï¼Ÿ"},
                                        {speaker: "å¤å¥ˆ", text: "æˆ‘æ²¡äº‹...è°¢è°¢ä½ ã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "ä½ ä»¬å››ç›®ç›¸å¯¹ï¼Œè¿‘è·ç¦»æ„Ÿå—ç€å½¼æ­¤çš„å‘¼å¸ã€‚æå›½è‰¯çš„æ‰‹è‡‚ä»ç¯ç»•ç€ä½ çš„è…°ï¼Œä¿æŠ¤æ€§åœ°æŠ±ç€ä½ ã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "é›¨æ°´é¡ºç€ä»–çš„ç«æ¯›æ»´è½ï¼Œä»–çš„å˜´å”‡è¿‘åœ¨å’«å°º..."},
                                        {speaker: "å›½è‰¯", text: "æˆ‘..."},
                                        {speaker: "ç³»ç»Ÿ", text: "ä¸€é˜µæ±½è½¦é¸£ç¬›å£°æ‰“ç ´äº†è¿™ç¾å¦™çš„æ—¶åˆ»ã€‚æå›½è‰¯æ…¢æ…¢æ¾å¼€æ‰‹ï¼Œå¼¯è…°æ¡èµ·é›¨ä¼ã€‚"},
                                        {speaker: "å›½è‰¯", text: "æˆ‘ä»¬å¾—æ‰¾ä¸ªåœ°æ–¹é¿é›¨ï¼Œä½ å·²ç»æ¹¿é€äº†ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "å—¯..."},
                                        {speaker: "ç³»ç»Ÿ", text: "è™½ç„¶åªæ˜¯çŸ­æš‚çš„æ‹¥æŠ±ï¼Œä½†è¿™ä¸€åˆ»å·²ç»åœ¨ä½ å¿ƒé‡Œç•™ä¸‹äº†æ·±åˆ»çš„å°è®°ã€‚"}
                                    ]
                                };
                            }
                        }
                    },
                    {
                        text: "åˆ†äº«ä¼ä¸‹çš„æ„Ÿå—",
                        action: function() {
                            changeCharacterAffection("guoliang", 8);
                            addToLog("ç‰¹æ®Šäº’åŠ¨", "ä½ åˆ†äº«é›¨ä¸­å…±ä¼çš„ç‰¹åˆ«æ„Ÿå—ï¼Œæå›½è‰¯æš—ç¤ºä½ ä»¬å¯èƒ½åœ¨å¦ä¸€ä¸ªé›¨å¤©ä¹Ÿæ›¾è¿™æ ·èµ°è¿‡ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "è¿™æ ·é å¾—å¾ˆè¿‘...æœ‰ç‚¹ç´§å¼ ã€‚"},
                                    {speaker: "å›½è‰¯", text: "å¦‚æœä¸èˆ’æœï¼Œæˆ‘å¯ä»¥èµ°å¤–ä¾§ï¼Œè®©ä½ æ‰“å¾—æ›´å¤šä¸€äº›ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "ä¸ï¼Œä¸æ˜¯é‚£ä¸ªæ„æ€...åªæ˜¯...è¿™æ„Ÿè§‰å¾ˆç‰¹åˆ«ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯ä¾§å¤´çœ‹ä½ ï¼Œç›®å…‰æ¸©æŸ”ã€‚"},
                                    {speaker: "å›½è‰¯", text: "æ˜¯å—ï¼Ÿä»€ä¹ˆæ„Ÿè§‰ï¼Ÿ"},
                                    {speaker: "å¤å¥ˆ", text: "å®‰å¿ƒï¼Œåˆæœ‰äº›æ€€å¿µ...å¥½åƒæˆ‘ä»¬æ›¾ç»è¿™æ ·èµ°è¿‡ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çš„çœ¼ç¥é—ªçƒï¼Œä¼¼ä¹æƒ³è¯´ä»€ä¹ˆï¼Œå´åˆæ­¢ä½äº†ã€‚"},
                                    {speaker: "å›½è‰¯", text: "ä¹Ÿè®¸...åœ¨å¦ä¸€ä¸ªé›¨å¤©ï¼Ÿ"},
                                    {speaker: "å¤å¥ˆ", text: "å¯èƒ½å§..."},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ ä»¬è‚©å¹¶è‚©èµ°åœ¨é›¨ä¸­ï¼Œå½¼æ­¤é å¾—å¾ˆè¿‘ã€‚è¿™ç§å¾®å¦™çš„äº²å¯†æ„Ÿï¼Œè®©ä½ çš„å¿ƒè·³ä¸ç”±è‡ªä¸»åœ°åŠ å¿«ã€‚"}
                                ]
                            };
                        }
                    }
                ]
            };
        }
        
        // é«˜äº²å¯†åº¦ç‰¹æ®Šå‰§æƒ… - å¤œé—´åŠå…¬å®¤
        function specialOfficeEvent() {
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "ä½ å¸®æå›½è‰¯æ•´ç†çƒé˜Ÿæ–‡ä»¶ï¼Œä¸çŸ¥ä¸è§‰å·²ç»åˆ°äº†æ·±å¤œã€‚ç¯®çƒé¦†é‡Œåªå‰©ä¸‹ä½ ä»¬ä¸¤äººï¼Œçª—å¤–æ˜¯ç¹æ˜Ÿç‚¹ç‚¹ã€‚"},
                    {speaker: "å›½è‰¯", text: "æŠ±æ­‰è®©ä½ å·¥ä½œåˆ°è¿™ä¹ˆæ™š..."},
                    {speaker: "å¤å¥ˆ", text: "æ²¡å…³ç³»ï¼Œæˆ‘å¾ˆä¹æ„å¸®å¿™ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "åŠå…¬å®¤çš„ç¯å…‰æŸ”å’Œï¼Œæ˜ ç…§ç€ä½ ä»¬ç–²æƒ«å´æ»¡è¶³çš„è„¸åºã€‚å®Œæˆå·¥ä½œåï¼Œä¸€ç§å¥‡å¦™çš„å®é™ç¬¼ç½©ç€ä½ ä»¬ã€‚"}
                ],
                choices: [
                    {
                        text: "ä¸»åŠ¨é è¿‘ä»–",
                        action: function() {
                            changeCharacterAffection("guoliang", 15);
                            addToLog("ç‰¹æ®Šäº’åŠ¨", "ä½ ä¸»åŠ¨é åœ¨æå›½è‰¯è‚©è†€ä¸Šï¼Œä»–æ¸©æŸ”åœ°å›åº”äº†ä½ ï¼Œè½»å»ä½ çš„å”‡ï¼Œç§°è¿™æ„Ÿè§‰åƒä¹…è¿çš„é‡é€¢ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ é¼“èµ·å‹‡æ°”ï¼Œèµ°åˆ°æå›½è‰¯èº«è¾¹ï¼Œè½»è½»é åœ¨äº†ä»–çš„è‚©è†€ä¸Šã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "æœ‰ç‚¹ç´¯äº†...å¯ä»¥è¿™æ ·é ä¸€ä¼šå„¿å—ï¼Ÿ"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çš„èº«ä½“æ˜æ˜¾åœ°åƒµäº†ä¸€ä¸‹ï¼Œä½†å¾ˆå¿«å°±æ”¾æ¾ä¸‹æ¥ï¼Œå°å¿ƒç¿¼ç¿¼åœ°ç¯ä½ä½ çš„è‚©è†€ã€‚"},
                                    {speaker: "å›½è‰¯", text: "å—¯...å½“ç„¶å¯ä»¥ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "åŠå…¬å®¤é‡Œåªæœ‰ä½ ä»¬å¹³ç¨³çš„å‘¼å¸å£°ã€‚æ—¶é—´ä»¿ä½›é™æ­¢ï¼Œä½ æ„Ÿå—ç€ä»–èƒ¸è†›çš„æ¸©æš–å’Œå¿ƒè·³çš„èŠ‚å¥ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "ææ•™ç»ƒ...å›½è‰¯...æˆ‘æƒ³è¯´..."},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ æŠ¬å¤´çœ‹ä»–ï¼Œè¯è¯­åœ¨å˜´è¾¹å´åˆè¯´ä¸å‡ºå£ã€‚æå›½è‰¯ä½å¤´ä¸ä½ å››ç›®ç›¸å¯¹ï¼Œä»–çš„çœ¼ä¸­æ»¡æ˜¯æ·±æƒ…å’Œå…‹åˆ¶ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "åœ¨è¿™å®‰é™çš„å¤œæ™šï¼Œä½ ä»¬çš„è·ç¦»è¶Šæ¥è¶Šè¿‘ã€‚æœ€ç»ˆï¼Œæå›½è‰¯è½»è½»æ§èµ·ä½ çš„è„¸ï¼Œå»ä¸Šäº†ä½ çš„å”‡ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "è¿™ä¸ªå»æ¸©æŸ”è€Œå…‹åˆ¶ï¼Œåƒæ˜¯ä¸€ç§ä¹…è¿çš„é‡é€¢ã€‚ä½ é—­ä¸Šçœ¼ç›ï¼Œæ„Ÿå—ç€è¿™ç†Ÿæ‚‰åˆé™Œç”Ÿçš„è§¦æ„Ÿï¼Œå¿ƒè·³åŠ é€Ÿã€‚"},
                                    {speaker: "å›½è‰¯", text: "å¯¹ä¸èµ·ï¼Œæˆ‘ä¸è¯¥..."},
                                    {speaker: "å¤å¥ˆ", text: "ä¸...è¿™æ„Ÿè§‰å¾ˆå¯¹ã€‚å¥½åƒ...æˆ‘ä»¬æœ¬è¯¥å¦‚æ­¤ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çš„çœ¼ä¸­é—ªè¿‡ä¸€ä¸å¸Œæœ›å’Œå–œæ‚¦ï¼Œä»–è½»è½»æŠšæ‘¸ä½ çš„è„¸é¢Šã€‚"},
                                    {speaker: "å›½è‰¯", text: "å¤å¥ˆ...ç­‰ä½ æƒ³èµ·ä¸€åˆ‡ï¼Œæˆ‘ä¼šå‘Šè¯‰ä½ æˆ‘æœ‰å¤šä¹ˆæƒ³å¿µè¿™ä¸€åˆ»ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "è¿™ä¸ªå¤œæ™šï¼Œæˆä¸ºäº†ä½ ä»¬å…³ç³»ä¸­é‡è¦çš„è½¬æŠ˜ç‚¹ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "è¯¢é—®ä»–çš„æ„Ÿå—",
                        action: function() {
                            changeCharacterAffection("guoliang", 8);
                            addToLog("ç‰¹æ®Šäº’åŠ¨", "ä½ è¯¢é—®æå›½è‰¯å¯¹ä½ çš„æ„Ÿå—ï¼Œä»–è¡¨è¾¾ä½ å¯¹ä»–å¾ˆé‡è¦ï¼Œæ— æ³•ç”¨è¯­è¨€è¡¨è¾¾çš„æ„Ÿæƒ…ï¼Œè½»å»äº†ä½ çš„é¢å¤´ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "ææ•™ç»ƒ...ä½ å¯¹æˆ‘ï¼Œæ˜¯ä»€ä¹ˆæ„Ÿè§‰ï¼Ÿ"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯æ˜æ˜¾æ„£äº†ä¸€ä¸‹ï¼Œçœ¼ä¸­é—ªè¿‡å¤æ‚çš„æƒ…ç»ªã€‚"},
                                    {speaker: "å›½è‰¯", text: "æˆ‘..."},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–æ·±å¸ä¸€å£æ°”ï¼Œä¼¼ä¹åœ¨ç»„ç»‡è¯­è¨€ã€‚"},
                                    {speaker: "å›½è‰¯", text: "ä½ å¯¹æˆ‘å¾ˆé‡è¦ï¼Œæ¯”ä½ æƒ³è±¡çš„è¦é‡è¦å¾—å¤šã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "åªæ˜¯å› ä¸ºæˆ‘å¸®åŠ©çƒé˜Ÿå—ï¼Ÿ"},
                                    {speaker: "å›½è‰¯", text: "ä¸ï¼Œä¸åªæ˜¯è¿™æ ·..."},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–çš„ç›®å…‰å˜å¾—æ·±é‚ƒï¼Œæ…¢æ…¢é è¿‘ä½ ã€‚"},
                                    {speaker: "å›½è‰¯", text: "æœ‰äº›æ„Ÿæƒ…ï¼Œæ— æ³•ç”¨è¯­è¨€è¡¨è¾¾..."},
                                    {speaker: "ç³»ç»Ÿ", text: "åœ¨è¿™å®‰é™çš„åŠå…¬å®¤é‡Œï¼Œæå›½è‰¯è½»è½»æ¡ä½ä½ çš„æ‰‹ï¼Œæ¸©æš–è€Œåšå®šã€‚ä½ ä»¬ç›¸è§†è€Œç¬‘ï¼Œæ— éœ€è¨€è¯­ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–æ…¢æ…¢ä½å¤´ï¼Œè½»è½»å»äº†ä½ çš„é¢å¤´ï¼Œè¿™ä¸ªåŠ¨ä½œå¦‚æ­¤è‡ªç„¶ï¼Œä»¿ä½›ä½ ä»¬å·²ç»è¿™æ ·åšè¿‡æ— æ•°æ¬¡ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "å‡è£…ç–²æƒ«é åœ¨æ²™å‘ä¸Š",
                        action: function() {
                            changeAttribute("charm", 5);
                            addToLog("ç‰¹æ®Šäº’åŠ¨", "ä½ å‡è£…ç–²æƒ«é åœ¨æ²™å‘ä¸Šï¼Œæå›½è‰¯æ¸©æŸ”åœ°ç»™ä½ ç›–ä¸Šå¤–å¥—ï¼Œä½ ä»¬æœ€ç»ˆå…±äº«ä¸€ä»¶å¤–å¥—çš„æ¸©æš–ï¼Œç›¸äº’ä¾åã€‚");
                            return {
                                dialogue: [
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ å‡è£…ç–²æƒ«ï¼Œè½»è½»é åœ¨åŠå…¬å®¤çš„å°æ²™å‘ä¸Šï¼Œé—­ä¸Šçœ¼ç›ã€‚"},
                                    {speaker: "å›½è‰¯", text: "å¤ªç´¯äº†å—ï¼Ÿè¦ä¸è¦é€ä½ å›å»ï¼Ÿ"},
                                    {speaker: "å¤å¥ˆ", text: "å†ä¼‘æ¯ä¸€ä¼šå„¿å°±å¥½..."},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ æ„Ÿè§‰æœ‰äººé è¿‘ï¼Œç„¶åä¸€ä»¶å¤–å¥—è½»è½»ç›–åœ¨äº†ä½ èº«ä¸Šï¼Œå¸¦ç€æå›½è‰¯çš„æ°”æ¯å’Œæ¸©åº¦ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ å¾®å¾®çå¼€çœ¼ï¼Œçœ‹åˆ°æå›½è‰¯ååœ¨æ—è¾¹çš„æ¤…å­ä¸Šï¼ŒæŸ”å’Œçš„ç¯å…‰ä¸‹ï¼Œä»–çš„ä¾§è„¸çº¿æ¡åˆ†æ˜è€Œæ¸©æŸ”ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "è°¢è°¢...ä½†ä½ ä¸å†·å—ï¼Ÿ"},
                                    {speaker: "å›½è‰¯", text: "æˆ‘æ²¡äº‹ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ åèµ·èº«ï¼ŒæŠŠå¤–å¥—å±•å¼€ï¼Œç¤ºæ„ä»–ä¹Ÿä¸€èµ·ç›–ä¸Šã€‚æå›½è‰¯çŠ¹è±«äº†ä¸€ä¸‹ï¼Œæœ€ç»ˆååˆ°ä½ èº«è¾¹ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ ä»¬è‚©å¹¶è‚©ååœ¨å°æ²™å‘ä¸Šï¼Œå…±äº«ä¸€ä»¶å¤–å¥—çš„æ¸©æš–ã€‚è¿™ç§äº²å¯†æ„Ÿè®©äººå¿ƒè·³åŠ é€Ÿã€‚"},
                                    {speaker: "å›½è‰¯", text: "å¤å¥ˆ...æˆ‘..."},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–çš„è¯è¯­è¿˜æœªå‡ºå£ï¼Œä½ å´æ„Ÿåˆ°ä¸€ç§è«åçš„å®‰å¿ƒå’Œç†Ÿæ‚‰ï¼Œä¸ç”±è‡ªä¸»åœ°é åœ¨äº†ä»–çš„è‚©è†€ä¸Šã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯è½»è½»ç¯æŠ±ä½ä½ ï¼Œåœ¨è¿™é™è°§çš„å¤œæ™šï¼Œæ—¶é—´ä»¿ä½›åœæ»ï¼Œåªæœ‰å½¼æ­¤çš„å¿ƒè·³å£°ã€‚"}
                                ]
                            };
                        }
                    }
                ]
            };
        }
        
        // é«˜äº²å¯†åº¦ç‰¹æ®Šå‰§æƒ… - æ¨±èŠ±æ ‘ä¸‹çš„å»
        function specialCherryBlossomEvent() {
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "æ¨±èŠ±ç››å¼€çš„å­£èŠ‚ï¼Œä½ å’Œæå›½è‰¯åœ¨é‚£æ£µç‰¹åˆ«çš„æ¨±èŠ±æ ‘ä¸‹æ¼«æ­¥ã€‚ç²‰è‰²èŠ±ç“£å¦‚é›ªèˆ¬é£˜è½ï¼Œæ™¯è‰²ç¾ä¸èƒœæ”¶ã€‚"},
                    {speaker: "å¤å¥ˆ", text: "çœŸç¾å•Š..."},
                    {speaker: "å›½è‰¯", text: "æ˜¯å•Šï¼Œæ¯å¹´è¿™ä¸ªæ—¶å€™ï¼Œè¿™é‡Œéƒ½æ˜¯æœ€ç¾çš„ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çš„çœ¼ç¥ä¸­å……æ»¡äº†æ€€å¿µï¼Œä»–çœ‹ç€æ¨±èŠ±æ ‘ï¼Œåˆçœ‹ç€ä½ ï¼Œç›®å…‰å¤æ‚è€Œæ·±æƒ…ã€‚"}
                ],
                choices: [
                    {
                        text: "é—®ä»–ä¸ºä½•å¦‚æ­¤æ€€å¿µ",
                        action: function() {
                            if (hasMemoryFragment("memory5")) {
                                addToLog("ç‰¹æ®Šäº’åŠ¨", "ä½ æèµ·æ¨±èŠ±æ ‘ä¸‹çš„çº¦å®šï¼Œæå›½è‰¯æƒŠå–œäºä½ çš„è®°å¿†æ¢å¤ï¼Œåœ¨æ¼«å¤©æ¨±èŠ±ä¸­çƒ­çƒˆåœ°å»äº†ä½ ã€‚");
                                return {
                                    dialogue: [
                                        {speaker: "å¤å¥ˆ", text: "ä½ çœ‹èµ·æ¥å¾ˆæ€€å¿µè¿™é‡Œ...ä¸ºä»€ä¹ˆï¼Ÿ"},
                                        {speaker: "å›½è‰¯", text: "å› ä¸º...è¿™é‡Œæœ‰ä¸ªçº¦å®šã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "æ˜¯æˆ‘ä»¬çš„çº¦å®šå—ï¼Ÿåœ¨æˆ‘å¤±å¿†å‰..."},
                                        {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯æƒŠè®¶åœ°çœ‹ç€ä½ ã€‚"},
                                        {speaker: "å›½è‰¯", text: "ä½ ...è®°å¾—ï¼Ÿ"},
                                        {speaker: "å¤å¥ˆ", text: "ä¸€äº›ç‰‡æ®µã€‚ä½ è¯´è¿‡ï¼Œç­‰ä½ æˆä¸ºæ•™ç»ƒçš„é‚£å¤©ï¼Œæˆ‘è¦ç­”åº”åšä½ çš„å¥³æœ‹å‹ã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çš„çœ¼ç›äº®äº†èµ·æ¥ï¼Œåƒæ˜¯ç‚¹ç‡ƒäº†å¸Œæœ›ã€‚ä»–æ…¢æ…¢é è¿‘ä½ ã€‚"},
                                        {speaker: "å›½è‰¯", text: "å¤å¥ˆ...æˆ‘å·²ç»æˆä¸ºæ•™ç»ƒäº†ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "æˆ‘çŸ¥é“..."},
                                        {speaker: "ç³»ç»Ÿ", text: "åœ¨æ¼«å¤©é£èˆçš„æ¨±èŠ±ä¸­ï¼Œæå›½è‰¯è½»è½»æ§èµ·ä½ çš„è„¸ï¼Œå»ä¸Šäº†ä½ çš„å”‡ã€‚è¿™ä¸ªå»æ¸©æŸ”è€Œçƒ­çƒˆï¼Œä»¿ä½›è¦å¼¥è¡¥æ‰€æœ‰å¤±å»çš„æ—¶å…‰ã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "ä½ é—­ä¸Šçœ¼ç›ï¼Œå›åº”ç€è¿™ä¸ªå»ã€‚æ¨±èŠ±ç“£è½åœ¨ä½ ä»¬èº«ä¸Šï¼Œè§è¯ç€è¿™åœºè¿Ÿæ¥çš„é‡é€¢ã€‚"},
                                        {speaker: "å›½è‰¯", text: "æˆ‘ç­‰äº†è¿™ä¸€åˆ»...å¤ªä¹…å¤ªä¹…..."},
                                        {speaker: "å¤å¥ˆ", text: "æˆ‘ä»¬ä¸ä¼šå†åˆ†å¼€äº†ï¼Œå¯¹å—ï¼Ÿ"},
                                        {speaker: "å›½è‰¯", text: "æ°¸è¿œä¸ä¼šã€‚è¿™ä¸€æ¬¡ï¼Œæˆ‘ä¼šç‰¢ç‰¢æŠ“ä½ä½ çš„æ‰‹ï¼Œä¸å†è®©ä»»ä½•äº‹æƒ…åˆ†å¼€æˆ‘ä»¬ã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "åœ¨è¿™ä¸ªæ¨±èŠ±çº·é£çš„æµªæ¼«æ—¶åˆ»ï¼Œä½ ä»¬é‡æ–°è®¸ä¸‹äº†å½¼æ­¤çš„æ‰¿è¯ºã€‚"}
                                    ]
                                };
                            } else {
                                changeCharacterAffection("guoliang", 10);
                                addToLog("ç‰¹æ®Šäº’åŠ¨", "ä½ è¯¢é—®æå›½è‰¯å¯¹æ¨±èŠ±æ ‘çš„æ€€å¿µï¼Œä»–æåˆ°è¿™é‡Œå¯¹ä»–ç‰¹åˆ«ï¼Œæ›¾æœ‰äººç»™äº†ä»–é‡æ–°å¼€å§‹çš„å‹‡æ°”ï¼Œéšååœ¨æ¨±èŠ±ä¸­å»äº†ä½ ã€‚");
                                return {
                                    dialogue: [
                                        {speaker: "å¤å¥ˆ", text: "ä½ çœ‹èµ·æ¥å¾ˆæ€€å¿µè¿™é‡Œ...ä¸ºä»€ä¹ˆï¼Ÿ"},
                                        {speaker: "å›½è‰¯", text: "è¿™é‡Œ...å¯¹æˆ‘æ¥è¯´æ˜¯ä¸ªç‰¹åˆ«çš„åœ°æ–¹ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "ç‰¹åˆ«ï¼Ÿæ€ä¹ˆç‰¹åˆ«ï¼Ÿ"},
                                        {speaker: "å›½è‰¯", text: "æ›¾ç»åœ¨è¿™é‡Œï¼Œæœ‰äººç»™äº†æˆ‘é‡æ–°å¼€å§‹çš„å‹‡æ°”ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "æ˜¯...å¥³æœ‹å‹å—ï¼Ÿ"},
                                        {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çœ‹ç€ä½ ï¼Œçœ¼ç¥ä¸­æœ‰æ— é™æŸ”æƒ…ã€‚"},
                                        {speaker: "å›½è‰¯", text: "æŸç§æ„ä¹‰ä¸Š...æ˜¯çš„ã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "ä½ æ„Ÿåˆ°ä¸€ä¸è«åçš„é…¸æ¥šå’Œå«‰å¦’ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "å¥¹...ç°åœ¨åœ¨å“ªé‡Œï¼Ÿ"},
                                        {speaker: "å›½è‰¯", text: "æ¯”ä½ æƒ³è±¡çš„è¦è¿‘å¾—å¤šã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "ä»–çš„è¯è®©ä½ å›°æƒ‘ã€‚å°±åœ¨è¿™æ—¶ï¼Œä¸€é˜µå¾®é£å¹è¿‡ï¼Œæ¨±èŠ±ç“£çº·çº·æ‰¬æ‰¬è½ä¸‹ï¼Œæœ‰ä¸€ç‰‡æ­£å¥½è½åœ¨ä½ çš„å”‡ä¸Šã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯æƒ…ä¸è‡ªç¦åœ°ä¼¸æ‰‹ï¼Œè½»è½»æ‹‚å»é‚£ç‰‡èŠ±ç“£ï¼Œæ‰‹æŒ‡ä¸ç»æ„é—´è§¦ç¢°åˆ°ä½ çš„å˜´å”‡ï¼Œå¼•èµ·ä¸€é˜µå¾®å¦™çš„ç”µæµã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "åœ¨è¿™ä¸ªç¬é—´ï¼Œä½ ä»¬çš„ç›®å…‰äº¤æ±‡ï¼Œä»–æ…¢æ…¢ä½å¤´ï¼Œå»ä¸Šäº†ä½ çš„å”‡ã€‚è¿™ä¸ªå»æ¸©æŸ”è€Œè¯•æ¢ï¼Œå´åˆå……æ»¡æ·±æƒ…ã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "å½“ä½ ä»¬åˆ†å¼€æ—¶ï¼Œä»–è½»å£°è¯´é“ï¼š"},
                                        {speaker: "å›½è‰¯", text: "å¯¹ä¸èµ·...æˆ‘ä¸è¯¥...ä½†æˆ‘æ— æ³•å†ç­‰å¾…äº†ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "ä¸...è¿™æ„Ÿè§‰å¾ˆå¯¹..."},
                                        {speaker: "ç³»ç»Ÿ", text: "åœ¨æ¨±èŠ±é£èˆä¸­ï¼Œä½ ä»¬å†æ¬¡æ‹¥å»ï¼Œä»¿ä½›è¿™ä¸€åˆ»å·²ç»ç­‰å¾…äº†å¤ªä¹…å¤ªä¹…ã€‚"}
                                    ]
                                };
                            }
                        }
                    },
                    {
                        text: "ä¸»åŠ¨æ‹‰ä½ä»–çš„æ‰‹",
                        action: function() {
                            changeCharacterAffection("guoliang", 12);
                            addToLog("ç‰¹æ®Šäº’åŠ¨", "ä½ ä¸»åŠ¨æ‹‰ä½æå›½è‰¯çš„æ‰‹ï¼Œä»–å‘Šè¯‰ä½ æ›¾ç»ä½ ä»¬ä¹Ÿè¿™æ ·ç‰µæ‰‹ç«™åœ¨è¿™æ£µæ ‘ä¸‹ï¼Œæ¨±èŠ±æ ‘ä¸‹ä½ ä»¬æ·±æƒ…ç›¸å»ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "ç³»ç»Ÿ", text: "åœ¨æ¨±èŠ±çº·é£ä¸­ï¼Œä½ é¼“èµ·å‹‡æ°”ï¼Œè½»è½»æ‹‰ä½äº†æå›½è‰¯çš„æ‰‹ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–æ˜æ˜¾åœ°æ„£äº†ä¸€ä¸‹ï¼Œä½å¤´çœ‹ç€ä½ ä»¬äº¤æ¡çš„æ‰‹ï¼Œçœ¼ä¸­é—ªè¿‡æƒŠè®¶å’Œå–œæ‚¦ã€‚"},
                                    {speaker: "å›½è‰¯", text: "å¤å¥ˆ..."},
                                    {speaker: "å¤å¥ˆ", text: "ä¸çŸ¥é“ä¸ºä»€ä¹ˆ...è¿™æ ·ç‰µç€ä½ çš„æ‰‹ï¼Œæ„Ÿè§‰å¾ˆè‡ªç„¶ï¼Œå¾ˆç†Ÿæ‚‰..."},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çš„çœ¼ç¥å˜å¾—æ·±é‚ƒï¼Œä»–è½»è½»æ”¶ç´§äº†æ¡ç€ä½ çš„æ‰‹ã€‚"},
                                    {speaker: "å›½è‰¯", text: "å› ä¸º...æˆ‘ä»¬æ›¾ç»æ— æ•°æ¬¡è¿™æ ·ç‰µç€æ‰‹ï¼Œç«™åœ¨è¿™æ£µæ ‘ä¸‹ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "çœŸçš„å—ï¼Ÿåœ¨æˆ‘å¤±å»è®°å¿†ä¹‹å‰ï¼Ÿ"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–ç‚¹ç‚¹å¤´ï¼Œçœ¼ä¸­æœ‰äº›æ¹¿æ¶¦ã€‚"},
                                    {speaker: "å›½è‰¯", text: "æˆ‘ä»¬åœ¨è¿™é‡Œè®¸ä¸‹äº†çº¦å®š..."},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯æ…¢æ…¢é è¿‘ä½ ï¼Œä¸€åªæ‰‹è½»æŠšä½ çš„è„¸é¢Šã€‚"},
                                    {speaker: "å›½è‰¯", text: "æˆ‘å¯ä»¥å»ä½ å—ï¼Ÿå°±åƒ...ä»å‰é‚£æ ·ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ æ²¡æœ‰å›ç­”ï¼Œåªæ˜¯é—­ä¸Šçœ¼ç›ï¼Œè½»è½»ç‚¹å¤´ã€‚ä¸‹ä¸€åˆ»ï¼Œä»–çš„å”‡æ¸©æŸ”åœ°è¦†ä¸Šä½ çš„ï¼Œæ¨±èŠ±åœ¨ä½ ä»¬å‘¨å›´é£èˆã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "è¿™ä¸ªå»å”¤é†’äº†æ²‰ç¡çš„æƒ…æ„Ÿï¼Œä»¿ä½›è¿‡å»ä¸ç°åœ¨åœ¨æ­¤åˆ»äº¤æ±‡ã€‚ä½ ä¼¸æ‰‹ç¯æŠ±ä½ä»–çš„è„–å­ï¼ŒåŠ æ·±äº†è¿™ä¸ªå»ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "å½“ä½ ä»¬ä¾ä¾ä¸èˆåœ°åˆ†å¼€æ—¶ï¼Œä»–çš„é¢å¤´æŠµç€ä½ çš„ï¼Œè½»å£°è¯´ï¼š"},
                                    {speaker: "å›½è‰¯", text: "æˆ‘çˆ±ä½ ï¼Œä¸€ç›´éƒ½æ˜¯ã€‚æ— è®ºä½ è®°ä¸è®°å¾—ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "æèµ·ä½ çš„æ¢¦å’Œè®°å¿†ç¢ç‰‡",
                        action: function() {
                            if (gameData.player.memoryFragments.length >= 8) {
                                changeCharacterAffection("guoliang", 20);
                                addToLog("ç‰¹æ®Šäº’åŠ¨", "ä½ åˆ†äº«äº†å…³äºæ¨±èŠ±æ ‘ä¸‹çº¦å®šçš„è®°å¿†ç¢ç‰‡ï¼Œæå›½è‰¯æ¿€åŠ¨åœ°æ‹¥æŠ±å¹¶çƒ­å»äº†ä½ ï¼Œä½ ä»¬æ‰¿è¯ºé‡æ–°å¼€å§‹ä½ ä»¬çš„æ•…äº‹ã€‚");
                                return {
                                    dialogue: [
                                        {speaker: "å¤å¥ˆ", text: "æˆ‘ç»å¸¸æ¢¦åˆ°è¿™æ£µæ¨±èŠ±æ ‘...è¿˜æœ‰æˆ‘ä»¬ç«™åœ¨è¿™é‡Œï¼Œä½ æ¡ç€æˆ‘çš„æ‰‹ï¼Œæˆ‘ä»¬æœ‰ä¸ªçº¦å®š..."},
                                        {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯éœ‡æƒŠåœ°çœ‹ç€ä½ ï¼Œä»¿ä½›ä¸æ•¢ç›¸ä¿¡è‡ªå·±çš„è€³æœµã€‚"},
                                        {speaker: "å›½è‰¯", text: "ä½ ...è®°å¾—é‚£ä¸ªçº¦å®šï¼Ÿ"},
                                        {speaker: "å¤å¥ˆ", text: "ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œä½†...æ˜¯å…³äºä½ æˆä¸ºæ•™ç»ƒï¼Œè€Œæˆ‘ç­”åº”åšä½ å¥³æœ‹å‹çš„çº¦å®šï¼Ÿ"},
                                        {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çš„çœ¼ä¸­ç¬é—´æ¶Œå‡ºæ³ªæ°´ï¼Œä»–ç´§ç´§æŠ±ä½ä½ ï¼Œä»¿ä½›å®³æ€•ä½ ä¼šå†æ¬¡æ¶ˆå¤±ã€‚"},
                                        {speaker: "å›½è‰¯", text: "æ˜¯çš„ï¼å°±æ˜¯è¿™ä¸ªçº¦å®šï¼ä½ çœŸçš„è®°èµ·æ¥äº†..."},
                                        {speaker: "å¤å¥ˆ", text: "ä¸åªæ˜¯è¿™ä¸ª...æˆ‘è¿˜è®°å¾—ä½ çš„æ¯”èµ›ï¼Œä½ çš„å—ä¼¤ï¼ŒåŒ»é™¢é‡Œçš„æ—¥å­...è™½ç„¶éƒ½æ˜¯äº›ç‰‡æ®µ..."},
                                        {speaker: "ç³»ç»Ÿ", text: "ä»–æ§èµ·ä½ çš„è„¸ï¼Œæ€¥åˆ‡åœ°å»ä¸Šä½ çš„å”‡ã€‚è¿™ä¸ªå»å……æ»¡äº†æ¸´æœ›ã€å–œæ‚¦å’Œå¤šå¹´çš„ç­‰å¾…ã€‚ä½ çƒ­çƒˆåœ°å›åº”ç€ï¼Œæ„Ÿå—ç€å½¼æ­¤çš„å¿ƒè·³ã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "æ¨±èŠ±ç“£åœ¨ä½ ä»¬å‘¨å›´é£èˆï¼Œå®›å¦‚ä¸€åœºç²‰è‰²çš„é›ªã€‚è¿™ä¸ªå»æ·±æ²‰è€Œç»µé•¿ï¼Œä»¿ä½›è¦å¼¥è¡¥æ‰€æœ‰å¤±å»çš„æ—¶å…‰ã€‚"},
                                        {speaker: "å›½è‰¯", text: "æˆ‘ç­‰äº†è¿™ä¸€åˆ»...æ•´æ•´ä¸¤å¹´ã€‚æ¯å¤©éƒ½åœ¨æƒ³ï¼Œä½ æ˜¯å¦ä¼šè®°èµ·æˆ‘ï¼Œè®°èµ·æˆ‘ä»¬ã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "ä»–çš„æ‰‹è½»æŠšä½ çš„å¤´å‘ã€è„¸é¢Šã€é¢ˆé¡¹ï¼ŒåŠ¨ä½œè½»æŸ”åˆå……æ»¡çƒ­æƒ…ï¼Œåƒæ˜¯ç¡®è®¤ä½ çœŸå®å­˜åœ¨ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "å¯¹ä¸èµ·ï¼Œè®©ä½ ç­‰äº†è¿™ä¹ˆä¹…..."},
                                        {speaker: "å›½è‰¯", text: "ä¸ï¼Œé‡è¦çš„æ˜¯ä½ å›æ¥äº†ã€‚æˆ‘ä»¬å¯ä»¥é‡æ–°å¼€å§‹...ä¸ï¼Œæ˜¯ç»§ç»­æˆ‘ä»¬çš„æ•…äº‹ã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "åœ¨è¿™ä¸ªæ¨±èŠ±çº·é£çš„ç¾ä¸½æ—¶åˆ»ï¼Œä½ ä»¬é‡æ–°æ‰¾å›äº†å½¼æ­¤ï¼Œå¼¥åˆäº†æ—¶é—´çš„è£‚ç¼ã€‚"}
                                    ]
                                };
                            } else {
                                addToLog("ç‰¹æ®Šäº’åŠ¨", "ä½ æåŠå¯¹æ¨±èŠ±æ ‘çš„æ¢¦å¢ƒï¼Œæå›½è‰¯æ˜¾å¾—å¼‚å¸¸ä¸“æ³¨ï¼Œæš—ç¤ºå¼ºè¡Œå”¤é†’è®°å¿†å¯èƒ½æœ‰é£é™©ï¼Œä½†è¿˜æ˜¯æƒ…ä¸è‡ªç¦åœ°å»äº†ä½ ã€‚");
                                return {
                                    dialogue: [
                                        {speaker: "å¤å¥ˆ", text: "æˆ‘ç»å¸¸æ¢¦åˆ°è¿™æ£µæ¨±èŠ±æ ‘...æ„Ÿè§‰è¿™é‡Œå¯¹æˆ‘æ¥è¯´å¾ˆç‰¹åˆ«ã€‚"},
                                        {speaker: "å›½è‰¯", text: "æ˜¯å—ï¼Ÿæ¢¦åˆ°äº†ä»€ä¹ˆï¼Ÿ"},
                                        {speaker: "å¤å¥ˆ", text: "ä¸€äº›æ¨¡ç³Šçš„åœºæ™¯...å¥½åƒæœ‰äººåœ¨è¿™é‡Œå¯¹æˆ‘è¯´ç€ä»€ä¹ˆé‡è¦çš„è¯ã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çš„çœ¼ç¥å˜å¾—å¼‚å¸¸ä¸“æ³¨ï¼Œä»–æ…¢æ…¢é è¿‘ä½ ã€‚"},
                                        {speaker: "å›½è‰¯", text: "é‚£ä¸ªäºº...æ˜¯æˆ‘å—ï¼Ÿ"},
                                        {speaker: "å¤å¥ˆ", text: "æˆ‘ä¸ç¡®å®š...ä½†æ„Ÿè§‰å¾ˆåƒã€‚æˆ‘ä»¬ä¹‹å‰çœŸçš„åœ¨è¿™é‡Œæœ‰è¿‡å›å¿†å—ï¼Ÿ"},
                                        {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯æ·±å¸ä¸€å£æ°”ï¼Œè½»è½»æ‹‰èµ·ä½ çš„æ‰‹ã€‚"},
                                        {speaker: "å›½è‰¯", text: "å¤å¥ˆ...æœ‰äº›äº‹æƒ…ï¼Œä¸æ˜¯æˆ‘èƒ½å‘Šè¯‰ä½ çš„ã€‚éœ€è¦ä½ è‡ªå·±æƒ³èµ·æ¥ã€‚"},
                                        {speaker: "å¤å¥ˆ", text: "ä¸ºä»€ä¹ˆï¼Ÿå¦‚æœæˆ‘ä»¬çœŸçš„æœ‰è¿‡å»ï¼Œä¸ºä»€ä¹ˆä¸èƒ½å‘Šè¯‰æˆ‘ï¼Ÿ"},
                                        {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çš„çœ¼ä¸­å……æ»¡ç—›è‹¦å’ŒæŒ£æ‰ï¼Œä»–çš„æ‹‡æŒ‡è½»è½»æ‘©æŒ²ç€ä½ çš„æ‰‹èƒŒã€‚"},
                                        {speaker: "å›½è‰¯", text: "å› ä¸º...åŒ»ç”Ÿè¯´è¿‡ï¼Œè®°å¿†éœ€è¦è‡ªç„¶æ¢å¤ã€‚å¼ºè¡Œå”¤é†’å¯èƒ½ä¼š..."},
                                        {speaker: "ç³»ç»Ÿ", text: "ä»–æ²¡æœ‰è¯´å®Œï¼Œä½†ä½ æ˜ç™½äº†ä»–çš„é¡¾è™‘ã€‚å°±åœ¨è¿™æ—¶ï¼Œä¸€é˜µé£å¹è¿‡ï¼Œå·èµ·æ¼«å¤©æ¨±èŠ±ã€‚ä¸€ç‰‡èŠ±ç“£è½åœ¨ä½ çš„å”‡ä¸Šã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯æƒ…ä¸è‡ªç¦åœ°ä¼¸æ‰‹ï¼Œè½»è½»æ‹‚å»é‚£ç‰‡èŠ±ç“£ï¼Œæ‰‹æŒ‡ä¸ç»æ„é—´è§¦ç¢°åˆ°ä½ çš„å˜´å”‡ã€‚ä½ ä»¬çš„ç›®å…‰åœ¨è¿™ä¸€åˆ»äº¤æ±‡ï¼Œæ—¶é—´ä»¿ä½›é™æ­¢ã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "ä»–ç¼“ç¼“ä½å¤´ï¼Œå»ä¸Šäº†ä½ çš„å”‡ã€‚è¿™ä¸ªå»å°å¿ƒç¿¼ç¿¼ï¼Œå´åˆå……æ»¡æ¸´æœ›ã€‚å½“ä»–è¦ç¦»å¼€æ—¶ï¼Œä½ æœ¬èƒ½åœ°è¿½é€ç€ä»–çš„å”‡ï¼Œä¸æ„¿åˆ†å¼€ã€‚"},
                                        {speaker: "ç³»ç»Ÿ", text: "è¿™ä¸ªæ„å¤–å´åˆä»¿ä½›å‘½ä¸­æ³¨å®šçš„å»ï¼Œè®©ä½ æ„Ÿå—åˆ°ä¸€ç§æ·±åˆ»çš„å½’å±æ„Ÿã€‚"}
                                    ]
                                };
                            }
                        }
                    }
                ]
            };
        }
        
        // é«˜äº²å¯†åº¦ç‰¹æ®Šå‰§æƒ… - å…¬å¯“æ™šé¤
        function specialDinnerEvent() {
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "ä½ é‚€è¯·æå›½è‰¯æ¥ä½ çš„å…¬å¯“å…±è¿›æ™šé¤ï¼Œä½œä¸ºæ„Ÿè°¢ä»–ä¸€ç›´ä»¥æ¥çš„å¸®åŠ©å’ŒæŒ‡å¯¼ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "ä½ ç²¾å¿ƒå‡†å¤‡äº†å‡ é“èœï¼Œé¤æ¡Œä¸Šæ‘†æ”¾ç€èœ¡çƒ›ï¼Œæ°”æ°›æ¸©é¦¨è€Œæµªæ¼«ã€‚"},
                    {speaker: "å›½è‰¯", text: "æ²¡æƒ³åˆ°ä½ çš„çƒ¹é¥ªæŠ€æœ¯è¿™ä¹ˆå¥½ï¼Œå‘³é“å¾ˆæ£’ã€‚"},
                    {speaker: "å¤å¥ˆ", text: "è°¢è°¢ï¼Œæˆ‘å¾ˆé«˜å…´ä½ å–œæ¬¢ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "æ™šé¤åï¼Œä½ ä»¬ååœ¨æ²™å‘ä¸Šï¼Œçª—å¤–æ˜¯åŸå¸‚çš„ç¯å…‰ï¼Œå®¤å†…åªæœ‰æŸ”å’Œçš„ç¯å…‰ç…§æ˜ã€‚æ°”æ°›å˜å¾—å¾®å¦™è€Œäº²å¯†ã€‚"}
                ],
                choices: [
                    {
                        text: "é è¿‘ä»–å¹¶è¡¨è¾¾æ„Ÿæƒ…",
                        action: function() {
                            changeCharacterAffection("guoliang", 15);
                            addToLog("ç‰¹æ®Šäº’åŠ¨", "ä½ é¼“èµ·å‹‡æ°”è¡¨è¾¾å¯¹æå›½è‰¯çš„æ„Ÿæƒ…ï¼Œä»–çƒ­æƒ…å›åº”ï¼Œä½ ä»¬å…±åº¦äº†ä¸€ä¸ªå……æ»¡çˆ±æ„çš„å¤œæ™šã€‚");
                            return {
                                dialogue: [
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ é¼“èµ·å‹‡æ°”ï¼ŒæŒªåŠ¨ä½ç½®é è¿‘æå›½è‰¯ï¼Œå¿ƒè·³åŠ é€Ÿã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "å›½è‰¯...è¿™æ®µæ—¶é—´å’Œä½ ç›¸å¤„ï¼Œæˆ‘å‘ç°è‡ªå·±è¶Šæ¥è¶Šå–œæ¬¢ä½ ..."},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çœ‹ç€ä½ ï¼Œçœ¼ç¥ä¸­å……æ»¡å¤æ‚çš„æƒ…æ„Ÿã€‚"},
                                    {speaker: "å›½è‰¯", text: "å¤å¥ˆ..."},
                                    {speaker: "å¤å¥ˆ", text: "æˆ‘çŸ¥é“è¿™å¯èƒ½å¾ˆçªç„¶ï¼Œä½†æˆ‘æ— æ³•æ§åˆ¶è‡ªå·±çš„æ„Ÿå—..."},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯è½»è½»æ¡ä½ä½ çš„æ‰‹ï¼Œçœ¼ä¸­æœ‰æ·±æƒ…ï¼Œä¹Ÿæœ‰çŠ¹è±«ã€‚"},
                                    {speaker: "å›½è‰¯", text: "è¿™ä¸çªç„¶...ä½†ä½ ç¡®å®šå—ï¼Ÿå…³äºä½ çš„æ„Ÿå—ï¼Ÿ"},
                                    {speaker: "å¤å¥ˆ", text: "æˆ‘ä»æ¥æ²¡æœ‰è¿™ä¹ˆç¡®å®šè¿‡ã€‚æ¯æ¬¡è§åˆ°ä½ ï¼Œæˆ‘çš„å¿ƒéƒ½ä¼šè·³å¾—å¾ˆå¿«..."},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯æ·±å¸ä¸€å£æ°”ï¼Œä¼¼ä¹ä¸‹å®šäº†å†³å¿ƒã€‚ä»–æ…¢æ…¢é è¿‘ä½ ï¼Œè½»è½»æŠšæ‘¸ä½ çš„è„¸é¢Šã€‚"},
                                    {speaker: "å›½è‰¯", text: "æˆ‘ä¹Ÿå–œæ¬¢ä½ ï¼Œæ¯”ä½ æƒ³è±¡çš„è¦æ·±å¾—å¤š..."},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–çš„å”‡è½»è½»è´´ä¸Šä½ çš„ï¼Œå¼€å§‹æ˜¯è¯•æ¢æ€§çš„è½»å»ï¼Œä½†å¾ˆå¿«å˜å¾—çƒ­çƒˆèµ·æ¥ã€‚ä½ ç¯æŠ±ä½ä»–çš„è„–å­ï¼Œå›åº”ç€è¿™ä¸ªå»ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–çš„æ‰‹è½»æŠšä½ çš„èƒŒéƒ¨ï¼ŒåŠ¨ä½œæ¸©æŸ”è€Œå……æ»¡çˆ±æ„ã€‚ä½ ä»¬çš„å»è¶Šæ¥è¶Šæ·±å…¥ï¼Œå½¼æ­¤çš„å‘¼å¸å˜å¾—æ€¥ä¿ƒã€‚"},
                                    {speaker: "å›½è‰¯", text: "å¤å¥ˆ...æˆ‘å¯ä»¥...ï¼Ÿ"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ æ˜ç™½ä»–çš„æ„æ€ï¼Œç¾æ¶©åœ°ç‚¹ç‚¹å¤´ã€‚æå›½è‰¯å°å¿ƒç¿¼ç¿¼åœ°å°†ä½ æ‹¥å…¥æ€€ä¸­ï¼Œä½ èƒ½æ„Ÿå—åˆ°ä»–å¼ºçƒˆçš„å¿ƒè·³ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–çš„å»ä»ä½ çš„å”‡ç§»åˆ°é¢ˆé¡¹ï¼Œæ¯ä¸€æ¬¡è§¦ç¢°éƒ½è®©ä½ æˆ˜æ —ã€‚ä½ çš„æ‰‹ä¸è‡ªè§‰åœ°æ¢å…¥ä»–çš„è¡¬è¡«ï¼Œæ„Ÿå—ä»–ç»“å®çš„è‚Œè‚‰ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "åœ¨è¿™ä¸ªå……æ»¡çˆ±æ„çš„å¤œæ™šï¼Œä½ ä»¬çš„å…³ç³»è¿ˆå‘äº†æ–°çš„é˜¶æ®µï¼Œèå…¥å½¼æ­¤çš„æ€€æŠ±ä¸­ï¼Œå…±åŒç¼–ç»‡ç¾å¥½çš„å›å¿†ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "å‡è£…å›°å€¦ï¼Œæµ‹è¯•ä»–çš„ååº”",
                        action: function() {
                            addToLog("ç‰¹æ®Šäº’åŠ¨", "ä½ å‡è£…å›°å€¦é åœ¨æ²™å‘ä¸Šï¼Œæå›½è‰¯æ¸©æŸ”åœ°ç…§é¡¾ä½ ï¼Œåœ¨ä½ é¢å¤´è½»å»å¹¶è¯´å‡ºæƒ³å¿µè¿™æ ·æ—¶åˆ»çš„å¿ƒå£°ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ å‡è£…æœ‰äº›å›°å€¦ï¼Œè½»è½»é åœ¨æ²™å‘ä¸Šï¼Œçœ¼ç›åŠé—­ã€‚"},
                                    {speaker: "å›½è‰¯", text: "ç´¯äº†ï¼Ÿæˆ‘è¯¥èµ°äº†ï¼Œè®©ä½ å¥½å¥½ä¼‘æ¯ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "å—¯...æœ‰ç‚¹ç´¯ï¼Œä½†æˆ‘ä¸æƒ³ä½ è¿™ä¹ˆå¿«å°±èµ°..."},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çœ‹ç€ä½ ï¼Œçœ¼ç¥æ¸©æŸ”ã€‚ä»–è½»è½»æ‹¿èµ·æ²™å‘ä¸Šçš„æ¯¯å­ï¼Œä¸ºä½ ç›–ä¸Šã€‚"},
                                    {speaker: "å›½è‰¯", text: "é‚£æˆ‘å†åä¸€ä¼šå„¿ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ æ— æ„ä¸­ï¼ˆå®åˆ™æœ‰æ„ï¼‰é åœ¨ä»–çš„è‚©è†€ä¸Šï¼Œæ„Ÿå—ç€ä»–çš„ä½“æ¸©å’Œæ°”æ¯ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "å—¯...ä½ çœŸèˆ’æœ..."},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯è½»è½»ç¬‘äº†ï¼ŒçŠ¹è±«äº†ä¸€ä¸‹ï¼Œç„¶åå°å¿ƒåœ°ç¯ä½ä½ çš„è‚©è†€ï¼Œè®©ä½ é å¾—æ›´èˆ’é€‚ã€‚"},
                                    {speaker: "å›½è‰¯", text: "ä½ å•Š..."},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–çš„å£°éŸ³å¾ˆæ¸©æŸ”ï¼Œå¸¦ç€ä¸€ä¸å® æººã€‚ä½ æ„Ÿè§‰ä»–ä½å¤´çœ‹äº†ä½ å¾ˆä¹…ï¼Œç„¶åè½»è½»åœ¨ä½ é¢å¤´ä¸Šè½ä¸‹ä¸€ä¸ªå»ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ å‡è£…ç†Ÿç¡ï¼Œä½†å¿ƒè·³åŠ é€Ÿã€‚æå›½è‰¯çš„æ‰‹è½»è½»æŠšæ‘¸ä½ çš„å¤´å‘ï¼ŒåŠ¨ä½œæ— æ¯”è½»æŸ”ã€‚"},
                                    {speaker: "å›½è‰¯", text: "å¤å¥ˆ...å¦‚æœä½ çŸ¥é“æˆ‘æœ‰å¤šæƒ³å¿µè¿™æ ·çš„æ—¶åˆ»..."},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–çš„ä½è¯­è®©ä½ å›°æƒ‘ï¼Œä½†ä¹Ÿè®©ä½ æ„Ÿåˆ°ä¸€é˜µç”œèœœã€‚ä½ å¿ä¸ä½çå¼€çœ¼ç›ï¼Œå¯¹ä¸Šä»–æ·±æƒ…çš„ç›®å…‰ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "å…¶å®...æˆ‘æ²¡æœ‰ç¡ç€ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯æ„£äº†ä¸€ä¸‹ï¼Œéšå³å¾®ç¬‘ã€‚"},
                                    {speaker: "å›½è‰¯", text: "æˆ‘çŸ¥é“ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "åœ¨è¿™ä¸ªæ¸©é¦¨çš„å¤œæ™šï¼Œä½ ä»¬ç›¸è§†è€Œç¬‘ï¼ŒæŸç§é»˜å¥‘åœ¨å¿ƒé—´æµåŠ¨ã€‚ä»–å€¾èº«å‘å‰ï¼Œè½»è½»å»ä¸Šä½ çš„å”‡ï¼Œè¿™ä¸ªå»æ¸©æŸ”è€Œå…‹åˆ¶ï¼Œå´å……æ»¡äº†æ— å°½çš„çˆ±æ„ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "é‚€è¯·ä»–çœ‹ç”µå½±",
                        action: function() {
                            changeCharacterAffection("guoliang", 10);
                            addToLog("ç‰¹æ®Šäº’åŠ¨", "ä½ é‚€è¯·æå›½è‰¯çœ‹ç”µå½±ï¼Œç”µå½±ä¸­çš„çˆ±æƒ…åœºæ™¯è®©æ°”æ°›å˜å¾—å¾®å¦™ï¼Œä½ ä»¬è‡ªç„¶è€Œç„¶åœ°å»åœ¨äº†ä¸€èµ·ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "æ™šé¤åæƒ³çœ‹éƒ¨ç”µå½±å—ï¼Ÿæˆ‘è¿™æœ‰å‡ éƒ¨ä¸é”™çš„ç‰‡å­ã€‚"},
                                    {speaker: "å›½è‰¯", text: "å¥½å•Šï¼Œä½ æ¥é€‰å§ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ é€‰äº†ä¸€éƒ¨æµªæ¼«çˆ±æƒ…ç‰‡ï¼Œä½ ä»¬å¹¶æ’ååœ¨æ²™å‘ä¸Šã€‚éšç€å‰§æƒ…å‘å±•ï¼Œç”µå½±ä¸­çš„ä¸»è§’é™·å…¥çƒ­çƒˆçš„æ‹¥å»ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "è¿™ä¸€å¹•è®©æ°”æ°›å˜å¾—ç•¥å¾®å°´å°¬ï¼Œä½ æ„Ÿåˆ°æå›½è‰¯åœ¨æ²™å‘ä¸Šç•¥å¾®æŒªåŠ¨äº†ä¸€ä¸‹ï¼Œä¼¼ä¹æœ‰äº›ä¸è‡ªåœ¨ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "å‘ƒ...è¦ä¸è¦çˆ†ç±³èŠ±æˆ–é¥®æ–™ï¼Ÿ"},
                                    {speaker: "å›½è‰¯", text: "å¥½çš„ï¼Œæˆ‘æ¥å¸®ä½ ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ ä»¬åŒæ—¶ç«™èµ·èº«ï¼Œåœ¨ç‹­å°çš„ç©ºé—´é‡Œæ„å¤–åœ°é å¾—å¾ˆè¿‘ï¼Œå‡ ä¹æ˜¯é¢å¯¹é¢ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "è¿™ä¸ªçªç„¶çš„äº²å¯†è·ç¦»è®©ä½ å±ä½äº†å‘¼å¸ã€‚æå›½è‰¯çš„ç›®å…‰è½åœ¨ä½ çš„å”‡ä¸Šï¼Œç„¶åè¿…é€Ÿç§»å¼€ï¼Œä½†ä½ å·²ç»æ³¨æ„åˆ°äº†é‚£ä¸€ç¬é—´çš„ç«èŠ±ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "å›½è‰¯..."},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ è½»å£°å‘¼å”¤ä»–çš„åå­—ï¼Œä»–çš„ç›®å…‰é‡æ–°å›åˆ°ä½ è„¸ä¸Šã€‚è¿™ä¸€æ¬¡ï¼Œä»–æ²¡æœ‰å›é¿ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "åœ¨ç”µå½±å¹½æš—çš„å…‰çº¿ä¸‹ï¼Œä½ ä»¬æ…¢æ…¢é è¿‘å½¼æ­¤ã€‚ä»–çš„æ‰‹è½»è½»æŠšä¸Šä½ çš„è„¸é¢Šï¼Œä½ èƒ½æ„Ÿå—åˆ°ä»–æ¸©çƒ­çš„å‘¼å¸ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–çš„å»æ¸©æŸ”è€Œè¯•æ¢ï¼Œä½ é—­ä¸Šçœ¼ç›å›åº”ç€ã€‚è¿™ä¸ªå»é€æ¸æ·±å…¥ï¼Œä»–çš„æ‰‹æ»‘åˆ°ä½ çš„è…°é—´ï¼Œå°†ä½ æ‹‰å¾—æ›´è¿‘ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ æ„Ÿå—åˆ°ä»–å¼ºå£®çš„èƒ¸è†›å’Œæ€¥ä¿ƒçš„å¿ƒè·³ï¼Œä½ çš„æ‰‹ä¸è‡ªè§‰åœ°æŠšæ‘¸ä»–çš„è‚©è†€å’ŒèƒŒéƒ¨ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ç”µå½±è¢«é—å¿˜åœ¨èƒŒæ™¯ä¸­ï¼Œä½ ä»¬æ²‰æµ¸åœ¨è¿™ä¸ªå……æ»¡æ¿€æƒ…çš„æ‹¥å»ä¸­ï¼Œäº«å—ç€å½¼æ­¤çš„æ¸©æš–å’Œäº²å¯†ã€‚"}
                                ]
                            };
                        }
                    }
                ]
            };
        }
        
        // äº²å¯†åº¦æœ€é«˜æ—¶çš„ç‰¹æ®Šå‰§æƒ… - å®Œå…¨è®°å¿†æ¢å¤åçš„äº²å¯†æ—¶åˆ»
        function intimateMemoryEvent() {
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "åœ¨è®°å¿†å®Œå…¨æ¢å¤åï¼Œä½ å’Œæå›½è‰¯å›åˆ°äº†ä½ çš„å…¬å¯“ã€‚å¤šå¹´çš„ç­‰å¾…ï¼Œç»ˆäºè¿æ¥äº†é‡é€¢çš„æ—¶åˆ»ã€‚"},
                    {speaker: "å¤å¥ˆ", text: "æˆ‘è®°å¾—ä¸€åˆ‡...é‚£äº›æ—¥å­ï¼Œæˆ‘ä»¬çš„çº¦å®šï¼Œä½ çš„ç­‰å¾…..."},
                    {speaker: "å›½è‰¯", text: "å¤å¥ˆ...ä½ ä¸çŸ¥é“è¿™å¯¹æˆ‘æ„å‘³ç€ä»€ä¹ˆã€‚æˆ‘ä»¥ä¸ºå¯èƒ½æ°¸è¿œå¤±å»ä½ äº†ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "ä»–ç´§ç´§æ‹¥æŠ±ç€ä½ ï¼Œä½ èƒ½æ„Ÿå—åˆ°ä»–èº«ä½“å¾®å¾®çš„é¢¤æŠ–ï¼Œé‚£æ˜¯å‹æŠ‘å¤ªä¹…çš„æƒ…æ„Ÿç»ˆäºå¾—åˆ°é‡Šæ”¾ã€‚"}
                ],
                choices: [
                    {
                        text: "ä¸»åŠ¨äº²å»ä»–",
                        action: function() {
                            changeCharacterAffection("guoliang", 20);
                            addToLog("ç‰¹æ®Šäº’åŠ¨", "è®°å¿†æ¢å¤åï¼Œä½ ä¸»åŠ¨çƒ­çƒˆäº²å»æå›½è‰¯ï¼Œä½ ä»¬åœ¨æœˆå…‰ä¸‹å¼¥è¡¥äº†å¤±å»çš„æ—¶å…‰ï¼Œå®Œå…¨åœ°å±äºå½¼æ­¤ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ æ§èµ·æå›½è‰¯çš„è„¸ï¼Œæ·±æ·±åœ°å»ä¸Šä»–çš„å”‡ã€‚è¿™ä¸ªå»çƒ­çƒˆè€Œåšå®šï¼Œå€¾æ³¨äº†æ‰€æœ‰æ€å¿µå’Œçˆ±æ„ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯ç´§ç´§æŠ±ä½ä½ ï¼Œå›åº”ç€è¿™ä¸ªå»ã€‚ä½ ä»¬çš„èº«ä½“ç´§è´´ï¼Œå¿ƒè·³é€æ¸åŒæ­¥ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "æˆ‘çˆ±ä½ ...ä¸€ç›´éƒ½æ˜¯ã€‚å³ä½¿åœ¨è®°å¿†ç¼ºå¤±çš„æ—¥å­é‡Œï¼Œæˆ‘çš„å¿ƒä¹Ÿåœ¨å¯»æ‰¾ä½ ã€‚"},
                                    {speaker: "å›½è‰¯", text: "å¤å¥ˆ...æˆ‘çš„å¤å¥ˆ..."},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–çš„å»ä»ä½ çš„å”‡ç§»åˆ°é¢ˆé—´ï¼Œæ¸©çƒ­çš„è§¦æ„Ÿè®©ä½ æˆ˜æ —ã€‚ä½ çš„æ‰‹ä¸è‡ªè§‰åœ°æ»‘å…¥ä»–çš„è¡¬è¡«ï¼Œæ„Ÿå—ä»–ç´§å®çš„è‚Œè‚‰ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–è½»æŸ”åœ°å°†ä½ æŠ±èµ·ï¼Œä½ çš„è…¿ç¯ç»•ç€ä»–çš„è…°ã€‚ä½ ä»¬å”‡é½¿ç›¸ä¾ï¼Œèµ°å‘å§å®¤ï¼Œæ‰€æœ‰çš„è¨€è¯­éƒ½åŒ–ä½œäº†çƒ­çƒˆçš„è¡ŒåŠ¨ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–çš„æ‰‹æ¸©æŸ”è€Œåšå®šåœ°æ¢ç´¢ç€ä½ çš„èº«ä½“ï¼Œæ¯ä¸€æ¬¡è§¦ç¢°éƒ½è®©ä½ é¢¤æŠ–ã€‚ä½ ä»¬ä¹‹é—´çš„æ¬²æœ›å¦‚æ½®æ°´èˆ¬æ¶ŒåŠ¨ï¼Œå´åˆå……æ»¡äº†æ·±æ²‰çš„çˆ±æ„ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "åœ¨æœˆå…‰çš„è§è¯ä¸‹ï¼Œä½ ä»¬ç»ˆäºå®Œå…¨å±äºå½¼æ­¤ï¼Œå¼¥è¡¥äº†é‚£äº›å¤±å»çš„æ—¶å…‰ã€‚è‚Œè‚¤ç›¸äº²ï¼Œçµé­‚äº¤èï¼Œçˆ±æ„ç»µç»µä¸ç»ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "å½“ä¸€åˆ‡å¹³é™ä¸‹æ¥ï¼Œä»–ç´§ç´§æŠ±ç€ä½ ï¼Œè½»å»ä½ çš„é¢å¤´ï¼Œçœ¼ç¥ä¸­æ»¡æ˜¯æ¸©æŸ”ä¸çè§†ã€‚"},
                                    {speaker: "å›½è‰¯", text: "æˆ‘æ°¸è¿œä¸ä¼šå†è®©ä½ ç¦»å¼€..."},
                                    {speaker: "å¤å¥ˆ", text: "æˆ‘ä¹Ÿä¸ä¼šå†å¿˜è®°ä½ ...æ°¸è¿œä¸ä¼šã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "è¿™ä¸€å¤œï¼Œæˆä¸ºäº†ä½ ä»¬æ–°ç”Ÿæ´»çš„ç¾å¥½å¼€å§‹ï¼Œå‘½è¿çš„é½¿è½®ç»ˆäºå›åˆ°æ­£è½¨ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "ç»†è¿°ä½ çš„è®°å¿†å’Œæ„Ÿå—",
                        action: function() {
                            changeCharacterAffection("guoliang", 15);
                            addToLog("ç‰¹æ®Šäº’åŠ¨", "ä½ è¯¦ç»†æè¿°æ¢å¤çš„è®°å¿†ç‰‡æ®µï¼Œæå›½è‰¯æ„ŸåŠ¨è½æ³ªï¼Œä½ ä»¬çƒ­æƒ…ç›¸æ‹¥ï¼Œåœ¨æ™¨å…‰ä¸­è¿æ¥äº†é‡é€¢åçš„ç¬¬ä¸€ä¸ªæ¸…æ™¨ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "æˆ‘è®°å¾—é‚£åœºæ¯”èµ›ï¼Œä½ ä¸ºäº†ç»™æˆ‘ç•™ä¸‹æ·±åˆ»å°è±¡ï¼Œåšäº†é‚£ä¸ªå±é™©åŠ¨ä½œ..."},
                                    {speaker: "å¤å¥ˆ", text: "è®°å¾—åŒ»é™¢é‡Œçš„æ—¥å­ï¼Œæˆ‘æ¯å¤©éƒ½å»çœ‹ä½ ï¼Œé™ªä½ åšåº·å¤è®­ç»ƒ..."},
                                    {speaker: "å¤å¥ˆ", text: "è¿˜æœ‰æ¨±èŠ±æ ‘ä¸‹çš„çº¦å®š...ä½ è¯´ç­‰ä½ æˆä¸ºæ•™ç»ƒï¼Œæˆ‘å°±ç­”åº”åšä½ çš„å¥³æœ‹å‹ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çš„çœ¼ä¸­é—ªçƒç€æ³ªå…‰ï¼Œä»–è½»è½»æŠšæ‘¸ä½ çš„è„¸é¢Šï¼Œåƒæ˜¯åœ¨ç¡®è®¤è¿™ä¸€åˆ‡æ˜¯å¦çœŸå®ã€‚"},
                                    {speaker: "å›½è‰¯", text: "ä½ çœŸçš„éƒ½è®°å¾—...è¿™ä¸¤å¹´ï¼Œæˆ‘çœ‹ç€ä½ å´ä¸èƒ½ç›¸è®¤ï¼Œæ˜¯æˆ‘äººç”Ÿä¸­æœ€è‰°éš¾çš„æ—¶åˆ»ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "ä¸ºä»€ä¹ˆä¸å‘Šè¯‰æˆ‘ï¼Ÿ"},
                                    {speaker: "å›½è‰¯", text: "åŒ»ç”Ÿè¯´å¼ºè¡Œå”¤é†’è®°å¿†å¯èƒ½ä¼šæœ‰é£é™©...æˆ‘ä¸èƒ½å†’è¿™ä¸ªé™©ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ ä»¬ç›¸è§†è€Œç¬‘ï¼Œæ‰€æœ‰çš„ç­‰å¾…å’Œç—›è‹¦éƒ½å€¼å¾—äº†ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯æ…¢æ…¢ä½å¤´ï¼Œå»ä¸Šä½ çš„å”‡ã€‚è¿™ä¸ªå»å¼€å§‹å¾ˆè½»æŸ”ï¼Œä½†å¾ˆå¿«å˜å¾—çƒ­çƒˆèµ·æ¥ã€‚ä½ å®Œå…¨æ²‰æµ¸å…¶ä¸­ï¼Œå›åº”ç€ä»–çš„çƒ­æƒ…ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–çš„æ‰‹æ»‘åˆ°ä½ çš„èƒŒåï¼Œå°†ä½ æ‹‰å¾—æ›´è¿‘ã€‚ä½ èƒ½æ„Ÿå—åˆ°ä»–å¼ºçƒˆçš„å¿ƒè·³å’Œç¼çƒ­çš„å‘¼å¸ã€‚ä½ çš„æ‰‹æŒ‡ç©¿è¿‡ä»–çš„å¤´å‘ï¼Œæ¸´æœ›æ›´å¤šçš„æ¥è§¦ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä¸çŸ¥ä½•æ—¶ï¼Œä½ å‘ç°è‡ªå·±å·²ç»è¢«ä»–æ¸©æŸ”åœ°æ”¾åœ¨åºŠä¸Šã€‚ä»–ä¿¯èº«åœ¨ä½ ä¸Šæ–¹ï¼Œç›®å…‰ä¸­å……æ»¡çˆ±æ„å’Œæ¸´æœ›ã€‚"},
                                    {speaker: "å›½è‰¯", text: "æˆ‘å¯ä»¥...ï¼Ÿ"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ å¾®ç¬‘ç€ç‚¹å¤´ï¼Œä¼¸æ‰‹å°†ä»–æ‹‰å‘ä½ ã€‚åœ¨è¿™ä¸ªå……æ»¡çˆ±æ„çš„å¤œæ™šï¼Œä½ ä»¬ç»ˆäºå®Œå…¨åœ°å±äºå½¼æ­¤ï¼Œå¼¥è¡¥äº†å¤±å»çš„æ—¶å…‰ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–çš„æ¯ä¸€ä¸ªè§¦ç¢°éƒ½å¦‚æ­¤ç†Ÿæ‚‰åˆå¦‚æ­¤æ–°é²œï¼Œä½ ä»¬çš„èº«ä½“ä»¿ä½›æ—©å·²ç›¸çŸ¥ï¼Œå´åˆåœ¨å‘ç°æ–°çš„å¥‡è¿¹ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "å½“æ™¨å…‰å¾®å¾®ç…§å…¥æˆ¿é—´ï¼Œä½ ä¾ååœ¨ä»–çš„æ€€ä¸­ï¼Œæ„Ÿå—ç€å‰æ‰€æœªæœ‰çš„å¹¸ç¦å’Œæ»¡è¶³ã€‚å‘½è¿çš„é‡é€¢ï¼Œè®©ä¸€åˆ‡ç­‰å¾…éƒ½å˜å¾—å€¼å¾—ã€‚"}
                                ]
                            };
                        }
                    },
                    {
                        text: "å‘ä»–æ±‚å©š",
                        action: function() {
                            changeCharacterAffection("guoliang", 25);
                            addToLog("ç‰¹æ®Šäº’åŠ¨", "ä½ å¤§èƒ†åœ°å‘æå›½è‰¯æ±‚å©šï¼Œä»–æ¿€åŠ¨åœ°æ¥å—äº†ï¼Œä½ ä»¬åœ¨æœˆå…‰ä¸‹è®¢å©šå¹¶å…±åº¦äº†æ— æ¯”äº²å¯†çš„æ—¶åˆ»ã€‚");
                            return {
                                dialogue: [
                                    {speaker: "å¤å¥ˆ", text: "å›½è‰¯...æˆ‘ä»¬å·²ç»å¤±å»äº†å¤ªå¤šæ—¶é—´ã€‚æˆ‘ä¸æƒ³å†ç­‰äº†ã€‚"},
                                    {speaker: "å›½è‰¯", text: "ä»€ä¹ˆæ„æ€ï¼Ÿ"},
                                    {speaker: "å¤å¥ˆ", text: "æˆ‘æƒ³å’Œä½ å…±åº¦ä½™ç”Ÿã€‚ä¸åªæ˜¯åšä½ çš„å¥³æœ‹å‹...æˆ‘æƒ³æˆä¸ºä½ çš„å¦»å­ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯éœ‡æƒŠåœ°çœ‹ç€ä½ ï¼Œçœ¼ä¸­é—ªçƒç€ä¸æ•¢ç½®ä¿¡çš„å…‰èŠ’ã€‚"},
                                    {speaker: "å¤å¥ˆ", text: "æˆ‘çŸ¥é“é€šå¸¸åº”è¯¥æ˜¯ç”·ç”Ÿæ±‚å©šï¼Œä½†æˆ‘ä»¬å·²ç»æ‰“ç ´äº†å¤ªå¤šå¸¸è§„...æ‰€ä»¥ï¼Œæå›½è‰¯ï¼Œä½ æ„¿æ„å¨¶æˆ‘å—ï¼Ÿ"},
                                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯çš„çœ¼ä¸­æ¶Œå‡ºæ³ªæ°´ï¼Œä»–ç´§ç´§æŠ±ä½ä½ ï¼Œå‡ ä¹è®©ä½ å–˜ä¸è¿‡æ°”æ¥ã€‚"},
                                    {speaker: "å›½è‰¯", text: "å½“ç„¶æ„¿æ„ï¼æˆ‘çš„ç­”æ¡ˆæ°¸è¿œæ˜¯æ„¿æ„ï¼"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–æ¿€åŠ¨åœ°å»ä¸Šä½ çš„å”‡ï¼Œè¿™ä¸ªå»å……æ»¡äº†å–œæ‚¦å’Œçˆ±æ„ã€‚ä½ å®Œå…¨èå…¥è¿™ä¸ªå»ä¸­ï¼Œæ„Ÿå—ç€å½¼æ­¤çš„çƒ­æƒ…ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä¸çŸ¥ä¸è§‰ä¸­ï¼Œçƒ­å»å˜å¾—æ›´åŠ æ·±å…¥ã€‚ä»–çš„æ‰‹è½»æŠšä½ çš„èƒŒéƒ¨ï¼Œæ…¢æ…¢ç§»å‘æ›´ç§å¯†çš„åŒºåŸŸã€‚ä½ çš„èº«ä½“å› ä»–çš„è§¦ç¢°è€Œæˆ˜æ —ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä½ ä»¬çš„å‘¼å¸å˜å¾—æ€¥ä¿ƒï¼Œè¡£ç‰©ä¸€ä»¶ä»¶è¢«è§£å¼€ã€‚åœ¨æœˆå…‰çš„è§è¯ä¸‹ï¼Œä½ ä»¬ç»ˆäºå®Œå…¨åœ°å±äºå½¼æ­¤ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "ä»–çš„å»ä»ä½ çš„å”‡ç§»å‘é¢ˆé¡¹ï¼Œå†åˆ°é”éª¨...æ¯ä¸€å¤„è§¦ç¢°éƒ½è®©ä½ é¢¤æŠ–å’Œå‘»åŸã€‚ä½ çš„æ‰‹æŠšæ‘¸ç€ä»–ç»“å®çš„èƒŒè‚Œï¼Œæ„Ÿå—ä»–å› æ¬²æœ›è€Œç´§ç»·çš„èº«ä½“ã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "åœ¨è¿™ä¸ªç‰¹åˆ«çš„å¤œæ™šï¼Œä½ ä»¬ä»¥æœ€äº²å¯†çš„æ–¹å¼åº†ç¥é‡é€¢å’Œè®¢å©šï¼Œå½¼æ­¤çš„èº«ä½“å’Œçµé­‚å®Œç¾å¥‘åˆï¼Œä»¿ä½›æœ¬å°±æ˜¯ä¸€ä½“çš„ä¸¤åŠã€‚"},
                                    {speaker: "ç³»ç»Ÿ", text: "å½“é»æ˜æ¥ä¸´ï¼Œä½ èººåœ¨ä»–çš„è‡‚å¼¯ä¸­ï¼Œæ„Ÿå—ç€æ— ä¸ä¼¦æ¯”çš„æ»¡è¶³å’Œå¹¸ç¦ã€‚ä½ çŸ¥é“ï¼Œä»ä»Šå¾€åï¼Œå†æ²¡æœ‰ä»€ä¹ˆèƒ½å°†ä½ ä»¬åˆ†å¼€ã€‚"}
                                ]
                            };
                        }
                    }
                ]
            };
        }
        
        // ç»“å±€ç³»ç»Ÿ - æ ¹æ®å¥½æ„Ÿåº¦å’Œè®°å¿†ç¢ç‰‡æ•°é‡å†³å®šç»“å±€
        function determineEnding() {
            const affection = gameData.characters.guoliang.affection;
            const memoryCount = gameData.player.memoryFragments.length;
            
            if (affection >= 90 && memoryCount === 12) {
                // å®Œç¾ç»“å±€ - çœŸçˆ±ç»ˆæˆ
                return perfectEnding();
            } else if (affection >= 75 && memoryCount >= 8) {
                // å¥½ç»“å±€ - æ–°çš„å¼€å§‹
                return goodEnding();
            } else if (affection >= 50 && memoryCount >= 5) {
                // æ™®é€šç»“å±€ - æœ‹å‹ä¹‹ä¸Š
                return normalEnding();
            } else {
                // é—æ†¾ç»“å±€ - å„è‡ªå‰è¡Œ
                return sadEnding();
            }
        }
        
        // å®Œç¾ç»“å±€
        function perfectEnding() {
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "ã€å®Œç¾ç»“å±€ï¼šçœŸçˆ±ç»ˆæˆã€‘"},
                    {speaker: "ç³»ç»Ÿ", text: "è®°å¿†å®Œå…¨æ¢å¤åï¼Œä½ å’Œæå›½è‰¯é‡ç»­å‰ç¼˜ï¼Œå¼¥è¡¥äº†å¤±å»çš„æ—¶å…‰ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "ä¸€å¹´åï¼Œåœ¨é‚£æ£µæ¨±èŠ±æ ‘ä¸‹ï¼Œæå›½è‰¯å•è†è·ªåœ°ï¼Œå‘ä½ æ±‚å©šã€‚ä½ å¹¸ç¦åœ°æ¥å—äº†ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "å©šç¤¼ä¸Šï¼Œç›¸æ³½ç¾å’²ä½œä¸ºä¼´å¨˜ï¼ŒçœŸè¯šåœ°ç¥ç¦ä½ ä»¬ã€‚å¥¹æ›¾ç»çš„æ•Œæ„ï¼Œåªæ˜¯å› ä¸ºæ‹…å¿ƒæå›½è‰¯å†æ¬¡å—ä¼¤ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "ä½ å®Œæˆäº†æ³•å­¦å­¦ä½ï¼Œæˆä¸ºä¸€åä½“è‚²æ³•ä¸“ä¸šå¾‹å¸ˆï¼ŒåŒæ—¶ç»§ç»­æ‹…ä»»å­¦æ ¡ç¯®çƒé˜Ÿçš„æ³•å¾‹é¡¾é—®ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯å¸¦é¢†çƒé˜Ÿå–å¾—äº†æ ¡å²æœ€å¥½æˆç»©ï¼Œå¹¶æ”¶åˆ°äº†å¤šæ‰€é«˜æ ¡çš„é‚€è¯·ï¼Œä½†ä»–é€‰æ‹©ç•™åœ¨è¿™é‡Œï¼Œå› ä¸ºè¿™é‡Œæœ‰å¤ªå¤šçè´µçš„å›å¿†ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "æ¯å¹´æ¨±èŠ±ç››å¼€æ—¶ï¼Œä½ ä»¬éƒ½ä¼šå›åˆ°é‚£æ£µæ ‘ä¸‹ï¼Œé‡æ¸©é‚£ä¸ªç‰¹åˆ«çš„çº¦å®šã€‚å‘½è¿çš„é½¿è½®ç»ˆäºå›åˆ°æ­£è½¨ï¼Œä½ ä»¬çš„çˆ±æƒ…æˆ˜èƒœäº†æ—¶é—´å’Œé—å¿˜ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "æ¸¸æˆç»“æŸï¼Œæ„Ÿè°¢æ¸¸ç©ã€Šå›½è‰¯è¯±æ•å™¨ã€‹ï¼"}
                ],
                choices: [
                    {
                        text: "é‡æ–°å¼€å§‹æ¸¸æˆ",
                        action: function() {
                            resetGame();
                            return {
                                dialogue: [
                                    {speaker: "ç³»ç»Ÿ", text: "æ¸¸æˆå·²é‡ç½®ï¼Œæ¬¢è¿å†æ¬¡ä½“éªŒã€Šå›½è‰¯è¯±æ•å™¨ã€‹ï¼"}
                                ]
                            };
                        }
                    }
                ]
            };
        }
        
        // å¥½ç»“å±€
        function goodEnding() {
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "ã€å¥½ç»“å±€ï¼šæ–°çš„å¼€å§‹ã€‘"},
                    {speaker: "ç³»ç»Ÿ", text: "è™½ç„¶ä½ æ²¡æœ‰å®Œå…¨æ¢å¤æ‰€æœ‰è®°å¿†ï¼Œä½†ä½ å’Œæå›½è‰¯å†³å®šä¸å†æ‰§ç€äºè¿‡å»ï¼Œè€Œæ˜¯å‘å‰çœ‹ï¼Œå¼€å¯å…¨æ–°çš„æ‹æƒ…ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯å¦è¯šåœ°å‘Šè¯‰äº†ä½ ä»¬çš„è¿‡å¾€ï¼Œä½ é€‰æ‹©ç›¸ä¿¡ä½ å†…å¿ƒçš„æ„Ÿå—â€”â€”å³ä½¿æ²¡æœ‰è®°å¿†ï¼Œä½ çš„å¿ƒä¹Ÿä¸€ç›´åœ¨å¯»æ‰¾ä»–ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "ä½ ä»¬åœ¨æ¨±èŠ±æ ‘ä¸‹é‡æ–°è®¸ä¸‹çº¦å®šï¼šä¸è®ºè¿‡å»å¦‚ä½•ï¼Œæœªæ¥è¦ä¸€èµ·èµ°ä¸‹å»ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "ä½ ç»§ç»­ä¸“æ³¨äºå•†æ³•äº‹ä¸šï¼ŒåŒæ—¶æ”¯æŒæå›½è‰¯çš„æ•™ç»ƒå·¥ä½œã€‚ä½ ä»¬çš„çˆ±æƒ…è™½ç„¶ç»å†äº†ä¸€æ®µå¼¯è·¯ï¼Œä½†æœ€ç»ˆæ‰¾åˆ°äº†å½¼æ­¤ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "ç›¸æ³½ç¾å’²æˆä¸ºäº†ä½ çš„å¥½å‹ï¼Œå¥¹å‘Šè¯‰ä½ ï¼Œçœ‹åˆ°ä½ ä»¬é‡æ–°åœ¨ä¸€èµ·ï¼Œå¥¹ç»ˆäºæ”¾ä¸‹äº†é•¿ä¹…çš„æ„§ç–šã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "æœ‰æ—¶å€™ï¼Œä¸€äº›é›¶æ•£çš„è®°å¿†ä»ä¼šçªç„¶é—ªç°ï¼Œä½†ä½ ä¸å†æ‰§ç€äºæ‹¼å‡‘å®Œæ•´çš„è¿‡å»ï¼Œå› ä¸ºç°åœ¨çš„çˆ±æƒ…åŒæ ·ç¾å¥½è€Œçè´µã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "æ¸¸æˆç»“æŸï¼Œæ„Ÿè°¢æ¸¸ç©ã€Šå›½è‰¯è¯±æ•å™¨ã€‹ï¼"}
                ],
                choices: [
                    {
                        text: "é‡æ–°å¼€å§‹æ¸¸æˆ",
                        action: function() {
                            resetGame();
                            return {
                                dialogue: [
                                    {speaker: "ç³»ç»Ÿ", text: "æ¸¸æˆå·²é‡ç½®ï¼Œæ¬¢è¿å†æ¬¡ä½“éªŒã€Šå›½è‰¯è¯±æ•å™¨ã€‹ï¼"}
                                ]
                            };
                        }
                    }
                ]
            };
        }
        
        // æ™®é€šç»“å±€
        function normalEnding() {
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "ã€æ™®é€šç»“å±€ï¼šæœ‹å‹ä¹‹ä¸Šã€‘"},
                    {speaker: "ç³»ç»Ÿ", text: "ä½ æ¢å¤äº†éƒ¨åˆ†è®°å¿†ï¼Œäº†è§£åˆ°ä¸æå›½è‰¯çš„è¿‡å»ï¼Œä½†ä¸¤äººéƒ½çŠ¹è±«è¦ä¸è¦é‡æ–°å¼€å§‹è¿™æ®µæ„Ÿæƒ…ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "ä½ ä»¬å†³å®šå…ˆåšäº²å¯†çš„æœ‹å‹ï¼Œä¸æ€¥äºç¡®å®šå…³ç³»ï¼Œç»™å½¼æ­¤ä¸€äº›æ—¶é—´å’Œç©ºé—´ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "ä½ ç»§ç»­æ‹…ä»»ç¯®çƒé˜Ÿçš„æ³•å¾‹é¡¾é—®ï¼Œä¸æå›½è‰¯ä¿æŒç€å¯†åˆ‡çš„åˆä½œå…³ç³»ã€‚ä½ ä»¬ä¹‹é—´çš„é»˜å¥‘å’Œä¿¡ä»»æ—¥ç›ŠåŠ æ·±ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "è™½ç„¶æ²¡æœ‰æ˜ç¡®çš„æ‹çˆ±å…³ç³»ï¼Œä½†å‘¨å›´çš„äººéƒ½çœ‹å¾—å‡ºä½ ä»¬ä¹‹é—´çš„ç‰¹æ®Šæƒ…æ„Ÿã€‚ç›¸æ³½ç¾å’²æ›¾å¯¹ä½ è¯´ï¼šæœ‰äº›äº‹ä¸éœ€è¦åˆ»æ„ï¼Œé¡ºå…¶è‡ªç„¶ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "æ¯•ä¸šæ—¶ï¼Œæå›½è‰¯æ”¶åˆ°äº†å¤–åœ°ä¸€æ‰€çŸ¥åä½“è‚²å­¦é™¢çš„é‚€è¯·ã€‚ä¸´è¡Œå‰ï¼Œä»–åœ¨æ¨±èŠ±æ ‘ä¸‹å¯¹ä½ è¯´ï¼šæˆ‘ä¼šç­‰ä½ æƒ³æ¸…æ¥šçš„é‚£ä¸€å¤©ã€‚æ— è®ºå¤šä¹…ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "æœªæ¥å¦‚ä½•å‘å±•ï¼Œè¿˜æœ‰å¾ˆå¤šå¯èƒ½æ€§ã€‚ä½†è‡³å°‘ç°åœ¨ï¼Œä½ ä»¬éƒ½ä¸å†å­¤å•ï¼Œå¿ƒä¸­æœ‰äº†å¯¹æ–¹çš„ä½ç½®ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "æ¸¸æˆç»“æŸï¼Œæ„Ÿè°¢æ¸¸ç©ã€Šå›½è‰¯è¯±æ•å™¨ã€‹ï¼"}
                ],
                choices: [
                    {
                        text: "é‡æ–°å¼€å§‹æ¸¸æˆ",
                        action: function() {
                            resetGame();
                            return {
                                dialogue: [
                                    {speaker: "ç³»ç»Ÿ", text: "æ¸¸æˆå·²é‡ç½®ï¼Œæ¬¢è¿å†æ¬¡ä½“éªŒã€Šå›½è‰¯è¯±æ•å™¨ã€‹ï¼"}
                                ]
                            };
                        }
                    }
                ]
            };
        }
        
        // é—æ†¾ç»“å±€
        function sadEnding() {
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "ã€é—æ†¾ç»“å±€ï¼šå„è‡ªå‰è¡Œã€‘"},
                    {speaker: "ç³»ç»Ÿ", text: "å°½ç®¡æå›½è‰¯è¯•å›¾å¸®åŠ©ä½ æ¢å¤è®°å¿†ï¼Œä½†ä½ ä»ç„¶åªè®°å¾—é›¶æ˜Ÿç‰‡æ®µï¼Œæ— æ³•å®Œæ•´è¿æ¥èµ·è¿‡å»çš„æ„Ÿæƒ…ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "é¢å¯¹è¿™æ®µæ— æ³•å®Œå…¨ç†è§£çš„è¿‡å¾€ï¼Œä½ æ„Ÿåˆ°è¿·èŒ«å’Œå‹åŠ›ã€‚ä½ å‘Šè¯‰æå›½è‰¯ï¼Œä¹Ÿè®¸ç°åœ¨çš„ä½ å·²ç»ä¸æ˜¯ä»–è®°å¿†ä¸­çš„é‚£ä¸ªäººäº†ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "æå›½è‰¯å°Šé‡ä½ çš„å†³å®šï¼Œè™½ç„¶çœ¼ä¸­æ»¡æ˜¯ä¸èˆï¼Œä½†ä»–è¯´ï¼šæˆ‘ä¸èƒ½ä¸€ç›´æ´»åœ¨è¿‡å»ï¼Œä½ ä¹Ÿæ˜¯ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "ä½ ä¸“æ³¨äºå­¦ä¸šå’Œå®ä¹ ï¼Œæˆä¸ºä¸€åå‡ºè‰²çš„å•†æ³•å¾‹å¸ˆã€‚æå›½è‰¯æ¥å—äº†å¤–åœ°ä¸€æ‰€ä½“è‚²å¤§å­¦çš„é‚€è¯·ï¼Œç¦»å¼€äº†è¿™åº§åŸå¸‚ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "åˆ†åˆ«é‚£å¤©ï¼Œä»–æœ€åä¸€æ¬¡ç«™åœ¨æ¨±èŠ±æ ‘ä¸‹ï¼Œçœ‹ç€è½è‹±ç¼¤çº·ï¼Œä¼¼ä¹åœ¨å‘Šåˆ«é‚£ä¸ªæœªèƒ½å…‘ç°çš„çº¦å®šã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "ç›¸æ³½ç¾å’²å‘Šè¯‰ä½ ï¼šæœ‰æ—¶å€™ï¼Œçˆ±ä¸€ä¸ªäººå°±æ˜¯è¦å­¦ä¼šæ”¾æ‰‹ã€‚æå›½è‰¯å·²ç»ç­‰äº†ä½ ä¸¤å¹´ï¼Œç°åœ¨ï¼Œä»–ç»ˆäºå†³å®šå‘å‰çœ‹äº†ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "ä¹Ÿè®¸å¤šå¹´åï¼Œå½“å‘½è¿å†æ¬¡è®©ä½ ä»¬ç›¸é‡ï¼Œä¼šæœ‰ä¸åŒçš„æ•…äº‹å‘ç”Ÿã€‚ä½†ç°åœ¨ï¼Œä½ ä»¬é€‰æ‹©äº†å„è‡ªçš„é“è·¯ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "æ¸¸æˆç»“æŸï¼Œæ„Ÿè°¢æ¸¸ç©ã€Šå›½è‰¯è¯±æ•å™¨ã€‹ï¼"}
                ],
                choices: [
                    {
                        text: "é‡æ–°å¼€å§‹æ¸¸æˆ",
                        action: function() {
                            resetGame();
                            return {
                                dialogue: [
                                    {speaker: "ç³»ç»Ÿ", text: "æ¸¸æˆå·²é‡ç½®ï¼Œæ¬¢è¿å†æ¬¡ä½“éªŒã€Šå›½è‰¯è¯±æ•å™¨ã€‹ï¼"}
                                ]
                            };
                        }
                    }
                ]
            };
        }
        
        // ç§˜å¯†ç»“å±€
        function secretEnding() {
            return {
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: "ã€ç§˜å¯†ç»“å±€ï¼šå‘½è¿äº¤ç»‡ã€‘"},
                    {speaker: "ç³»ç»Ÿ", text: "åœ¨æ”¶é›†æ‰€æœ‰è®°å¿†ç¢ç‰‡ï¼Œå¹¶å®Œæˆç‰¹å®šéšè—ä»»åŠ¡åï¼Œä½ å‘ç°äº†æ›´æ·±å±‚çš„çœŸç›¸ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "åŸæ¥ä½ å’Œæå›½è‰¯çš„ç›¸é‡å¹¶éå·§åˆï¼Œè€Œæ˜¯å‘½è¿çš„åˆ»æ„å®‰æ’ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "ä½ çš„çˆ¶æ¯å’Œæå›½è‰¯æ—©æœ‰çº¦å®šï¼šå¦‚æœä½ èƒ½è‡ªç„¶æ¢å¤è®°å¿†å¹¶å†æ¬¡çˆ±ä¸Šä»–ï¼Œä»–ä»¬å°±ä¸å†é˜»æŒ ä½ ä»¬çš„æ„Ÿæƒ…ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "ç›¸æ³½ç¾å’²å®é™…ä¸Šæ˜¯ä½ çš„è¿œæˆ¿è¡¨å§ï¼Œå¥¹ä¸€ç›´åœ¨æš—ä¸­è§‚å¯Ÿä½ ä»¬ï¼Œå¸®åŠ©åˆ›é€ ä¸¤äººå¶é‡çš„æœºä¼šã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "å½“ä½ è´¨é—®æå›½è‰¯ä¸ºä½•å‚ä¸è¿™ä¸ªæ¸¸æˆæ—¶ï¼Œä»–å¦æ‰¿é“ï¼š"},
                    {speaker: "å›½è‰¯", text: "å› ä¸ºæˆ‘çŸ¥é“ï¼ŒçœŸæ­£çš„çˆ±ä¸ä¼šè¢«è®°å¿†å·¦å³ã€‚å¦‚æœæˆ‘ä»¬çœŸçš„æœ‰ç¼˜åˆ†ï¼Œå³ä½¿ä½ å¿˜è®°äº†è¿‡å»ï¼Œä¹Ÿä¼šå†æ¬¡çˆ±ä¸Šæˆ‘ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "ä½ æ—¢æ„ŸåŠ¨åˆæœ‰äº›ç”Ÿæ°”ï¼Œä½†æœ€ç»ˆç†è§£äº†ä»–çš„ç”¨å¿ƒè‰¯è‹¦ã€‚ä½ ä»¬å†³å®šä¸å†è¢«è¿‡å»æŸç¼šï¼Œæºæ‰‹åˆ›é€ å…¨æ–°çš„æœªæ¥ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "å©šç¤¼ä¸Šï¼Œä½ çš„çˆ¶æ¯ç»ˆäºæ‰¿è®¤äº†ä»–ä»¬çš„é˜´è°‹ï¼Œä½†ä¹Ÿè¡¨ç¤ºè¿™æ˜¯å¯¹æå›½è‰¯çš„ç»ˆæè€ƒéªŒâ€”â€”å¦‚æœä»–çœŸå¿ƒçˆ±ä½ ï¼Œå°±ä¼šæ„¿æ„ä»é›¶å¼€å§‹è¿½æ±‚ä½ ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "è¿™åœºçœ‹ä¼¼å¶ç„¶çš„é‡é€¢ï¼Œå®é™…ä¸Šæ˜¯ä¸€åœºç²¾å¿ƒè®¾è®¡çš„å›½è‰¯è¯±æ•å™¨ã€‚è€Œä½ ï¼Œå¿ƒç”˜æƒ…æ„¿åœ°å å…¥äº†è¿™ä¸ªæ¸©æŸ”çš„é™·é˜±ã€‚"},
                    {speaker: "ç³»ç»Ÿ", text: "æ¸¸æˆç»“æŸï¼Œæ„Ÿè°¢æ¸¸ç©ã€Šå›½è‰¯è¯±æ•å™¨ã€‹ï¼"}
                ],
                choices: [
                    {
                        text: "é‡æ–°å¼€å§‹æ¸¸æˆ",
                        action: function() {
                            resetGame();
                            return {
                                dialogue: [
                                    {speaker: "ç³»ç»Ÿ", text: "æ¸¸æˆå·²é‡ç½®ï¼Œæ¬¢è¿å†æ¬¡ä½“éªŒã€Šå›½è‰¯è¯±æ•å™¨ã€‹ï¼"}
                                ]
                            };
                        }
                    }
                ]
            };
        }
        
        // é‡ç½®æ¸¸æˆ
        function resetGame() {
            gameData = {
                player: {
                    name: "ç»“åŸå¤å¥ˆ",
                    attributes: {
                        charm: 20,
                        wisdom: 25,
                        stamina: 100,
                        law: 40,
                        basketball: 10,
                        cooking: 15
                    },
                    inventory: [],
                    memoryFragments: []
                },
                characters: {
                    guoliang: {
                        name: "æå›½è‰¯",
                        affection: 0,
                        metFlag: false
                    },
                    misaki: {
                        name: "ç›¸æ³½ç¾å’²",
                        metFlag: false
                    }
                },
                gameState: {
                    day: 1,
                    time: "morning",
                    location: "apartment",
                    storyFlag: 0,
                    energyLeft: 3,
                    completedEvents: [],
                    gameLog: []
                }
            };
            
            updateStatusDisplay();
            hideAllScreens();
            showScreen("title-screen");
        }
        
        // æ¸¸æˆå·¥å…·å‡½æ•°
        
        // æ”¹å˜è§’è‰²å¥½æ„Ÿåº¦
        function changeCharacterAffection(character, amount) {
            gameData.characters[character].affection += amount;
            
            // é™åˆ¶æœ€å¤§å€¼ä¸º100
            if (gameData.characters[character].affection > 100) {
                gameData.characters[character].affection = 100;
            }
            
            showNotification("å¥½æ„Ÿåº¦ +" + amount);
            updateStatusDisplay();
        }
        
        // æ”¹å˜å±æ€§å€¼
        function changeAttribute(attribute, amount) {
            gameData.player.attributes[attribute] += amount;
            
            // ç¡®ä¿å±æ€§å€¼åœ¨0-100èŒƒå›´å†…
            if (gameData.player.attributes[attribute] > 100) {
                gameData.player.attributes[attribute] = 100;
            }
            if (gameData.player.attributes[attribute] < 0) {
                gameData.player.attributes[attribute] = 0;
            }
            
            if (amount > 0) {
                showNotification(attributeDisplayName(attribute) + " +" + amount);
            } else if (amount < 0) {
                showNotification(attributeDisplayName(attribute) + " " + amount);
            }
            
            updateStatusDisplay();
        }
        
        // è·å–å±æ€§çš„æ˜¾ç¤ºåç§°
        function attributeDisplayName(attribute) {
            const names = {
                charm: "é­…åŠ›",
                wisdom: "æ™ºæ…§",
                stamina: "ä½“åŠ›",
                law: "å•†æ³•çŸ¥è¯†",
                basketball: "ç¯®çƒæŠ€èƒ½",
                cooking: "çƒ¹é¥ªèƒ½åŠ›"
            };
            return names[attribute] || attribute;
        }
        
        // æ·»åŠ ç‰©å“åˆ°èƒŒåŒ…
        function addToInventory(itemId) {
            gameData.player.inventory.push(itemId);
            showNotification("è·å¾—ç‰©å“ï¼š" + itemsData[itemId].name);
            updateInventoryDisplay();
            
            // é«˜äº®æç¤ºç‰©å“æ 
            document.getElementById("inventory-btn").classList.add("highlight");
            setTimeout(() => {
                document.getElementById("inventory-btn").classList.remove("highlight");
            }, 2000);
        }
        
        // ä½¿ç”¨ç‰©å“
        function useItem(itemId) {
            const item = itemsData[itemId];
            const index = gameData.player.inventory.indexOf(itemId);
            
            if (index !== -1) {
                gameData.player.inventory.splice(index, 1);
                
                if (item.effect.type === "attribute") {
                    changeAttribute(item.effect.target, item.effect.value);
                    addToLog("ç‰©å“ä½¿ç”¨", `ä½ ä½¿ç”¨äº†${item.name}ï¼Œæå‡äº†${attributeDisplayName(item.effect.target)} ${item.effect.value}ç‚¹ã€‚`);
                } else if (item.effect.type === "affection") {
                    changeCharacterAffection("guoliang", item.effect.value);
                    addToLog("ç‰©å“ä½¿ç”¨", `ä½ å°†${item.name}é€ç»™äº†æå›½è‰¯ï¼Œå¥½æ„Ÿåº¦æå‡äº†${item.effect.value}ç‚¹ã€‚`);
                } else if (item.effect.type === "memory" && !hasMemoryFragment(item.effect.id)) {
                    collectMemoryFragment(item.effect.id);
                    addToLog("ç‰©å“ä½¿ç”¨", `ä½ æŸ¥çœ‹äº†${item.name}ï¼Œå‘ç°äº†ä¸€ä¸ªè®°å¿†ç¢ç‰‡ã€‚`);
                }
                
                updateInventoryDisplay();
                return true;
            }
            
            return false;
        }
        
        // æ£€æŸ¥æ˜¯å¦æœ‰ç‰©å“
        function hasItem(itemId) {
            return gameData.player.inventory.includes(itemId);
        }
        
        // æ”¶é›†è®°å¿†ç¢ç‰‡
        function collectMemoryFragment(fragmentId) {
            if (!hasMemoryFragment(fragmentId)) {
                gameData.player.memoryFragments.push(fragmentId);
                updateStatusDisplay();
                updateMemoryLogDisplay();
                
                // æ˜¾ç¤ºè®°å¿†ç¢ç‰‡æ”¶é›†ç•Œé¢
                document.getElementById("memory-title").textContent = memoryFragmentsData[fragmentId].title;
                document.getElementById("memory-content").textContent = memoryFragmentsData[fragmentId].content;
                
                document.getElementById("memory-collected").style.opacity = "1";
                document.getElementById("memory-collected").style.visibility = "visible";
                
                // é«˜äº®æç¤ºè®°å¿†æ”¶é›†èœå•
                document.getElementById("memory-btn").classList.add("highlight");
                setTimeout(() => {
                    document.getElementById("memory-btn").classList.remove("highlight");
                }, 2000);
                
                // æ£€æŸ¥æ˜¯å¦è§¦å‘æœ€ç»ˆäº‹ä»¶
                if (gameData.player.memoryFragments.length >= 10 && gameData.characters.guoliang.affection >= 75 && gameData.gameState.storyFlag === 4) {
                    gameData.gameState.storyFlag = 5;
                }
                
                return true;
            }
            
            return false;
        }
        
        // æ£€æŸ¥æ˜¯å¦æœ‰è®°å¿†ç¢ç‰‡
        function hasMemoryFragment(fragmentId) {
            return gameData.player.memoryFragments.includes(fragmentId);
        }
        
        // å®Œæˆäº‹ä»¶
        function completeEvent(eventId) {
            if (!hasCompleted(eventId)) {
                gameData.gameState.completedEvents.push(eventId);
                return true;
            }
            
            return false;
        }
        
        // æ£€æŸ¥äº‹ä»¶æ˜¯å¦å·²å®Œæˆ
        function hasCompleted(eventId) {
            return gameData.gameState.completedEvents.includes(eventId);
        }
        
        // æ£€æŸ¥äº‹ä»¶æ¡ä»¶
        function checkEventRequirements(event) {
            if (!event.requirements) {
                return true;
            }
            
            // æ£€æŸ¥å±æ€§è¦æ±‚
            if (event.requirements.attributes) {
                for (const attr in event.requirements.attributes) {
                    if (gameData.player.attributes[attr] < event.requirements.attributes[attr]) {
                        return false;
                    }
                }
            }
            
            // æ£€æŸ¥æ ‡å¿—è¦æ±‚
            if (event.requirements.flags) {
                for (const flag of event.requirements.flags) {
                    if (flag === "metGuoliang" && !gameData.characters.guoliang.metFlag) {
                        return false;
                    }
                }
            }
            
            return true;
        }
        
        // æ·»åŠ åˆ°æ¸¸æˆæ—¥å¿—
        function addToLog(category, text) {
            const timeString = getTimeString();
            gameData.gameState.gameLog.unshift({
                time: timeString,
                category: category,
                text: text
            });
            
            // é™åˆ¶æ—¥å¿—æœ€å¤§æ•°é‡
            if (gameData.gameState.gameLog.length > 50) {
                gameData.gameState.gameLog.pop();
            }
            
            updateLogDisplay();
            
            // é«˜äº®æç¤ºæ—¥å¿—æŒ‰é’®
            if (category === "å‰§æƒ…" || category === "è®°å¿†" || category === "ç‰¹æ®Šäº’åŠ¨") {
                document.getElementById("log-btn").classList.add("highlight");
                setTimeout(() => {
                    document.getElementById("log-btn").classList.remove("highlight");
                }, 2000);
            }
        }
        
        // è·å–æ—¶é—´å­—ç¬¦ä¸²
        function getTimeString() {
            const dayText = "ç¬¬" + gameData.gameState.day + "å¤©";
            let timeText = "";
            switch (gameData.gameState.time) {
                case "morning":
                    timeText = "ä¸Šåˆ";
                    break;
                case "afternoon":
                    timeText = "ä¸‹åˆ";
                    break;
                case "evening":
                    timeText = "æ™šä¸Š";
                    break;
            }
            return dayText + " " + timeText;
        }
        
        // æ›´æ–°æ¸¸æˆæ—¶é—´
        function advanceTime() {
            const times = ["morning", "afternoon", "evening"];
            const currentTimeIndex = times.indexOf(gameData.gameState.time);
            
            if (currentTimeIndex === times.length - 1) {
                // å¦‚æœæ˜¯æ™šä¸Šï¼Œè¿›å…¥ä¸‹ä¸€å¤©æ—©ä¸Š
                gameData.gameState.day += 1;
                gameData.gameState.time = times[0];
                gameData.gameState.energyLeft = 3;
                
                // æ¢å¤ä¸€äº›ä½“åŠ›
                changeAttribute("stamina", 30);
                addToLog("æ—¶é—´æµé€", "å¤œæ™šè¿‡å»ï¼Œè¿›å…¥æ–°çš„ä¸€å¤©ã€‚ä½“åŠ›æ¢å¤äº†ä¸€äº›ã€‚");
                
                // æ˜¾ç¤ºåœºæ™¯è¿‡æ¸¡æ•ˆæœ
                const transition = document.querySelector(".scene-transition");
                transition.style.opacity = "1";
                setTimeout(() => {
                    transition.style.opacity = "0";
                }, 1000);
            } else {
                // å¦åˆ™è¿›å…¥å½“å¤©ä¸‹ä¸€ä¸ªæ—¶æ®µ
                gameData.gameState.time = times[currentTimeIndex + 1];
                addToLog("æ—¶é—´æµé€", `æ—¶é—´æ¥åˆ°äº†${getTimeString()}ã€‚`);
            }
            
            updateStatusDisplay();
            
            // éšæœºäº‹ä»¶è§¦å‘
            triggerRandomEvent();
        }
        
        // æ¶ˆè€—èƒ½é‡
        function consumeEnergy(amount) {
            gameData.gameState.energyLeft -= amount;
            if (gameData.gameState.energyLeft < 0) {
                gameData.gameState.energyLeft = 0;
            }
            updateStatusDisplay();
        }
        
        // è§¦å‘éšæœºäº‹ä»¶
        function triggerRandomEvent() {
            // 50%æ¦‚ç‡è§¦å‘éšæœºäº‹ä»¶
            if (Math.random() > 0.5) {
                return;
            }
            
            // æ ¹æ®å¥½æ„Ÿåº¦å’Œè®°å¿†ç¢ç‰‡æ•°é‡å¯èƒ½è§¦å‘ç‰¹æ®Šäº‹ä»¶
            if (gameData.characters.guoliang.affection >= 50) {
                if (Math.random() > 0.7) {
                    if (!hasCompleted("specialRainEvent")) {
                        completeEvent("specialRainEvent");
                        addToLog("ç‰¹æ®Šäº‹ä»¶", "ä¸€åœºçªå¦‚å…¶æ¥çš„å¤§é›¨è®©ä½ ä¸æå›½è‰¯æœ‰äº†ä¸€æ¬¡ç‰¹åˆ«çš„ç›¸é‡ã€‚");
                        processEvent(specialRainEvent());
                        return;
                    }
                }
                
                if (Math.random() > 0.7) {
                    if (!hasCompleted("specialOfficeEvent") && gameData.characters.guoliang.affection >= 60) {
                        completeEvent("specialOfficeEvent");
                        addToLog("ç‰¹æ®Šäº‹ä»¶", "ä½ å¸®åŠ©æå›½è‰¯æ•´ç†æ–‡ä»¶åˆ°æ·±å¤œï¼Œå‘ç”Ÿäº†éš¾å¿˜çš„äº²å¯†æ¥è§¦ã€‚");
                        processEvent(specialOfficeEvent());
                        return;
                    }
                }
                
                if (Math.random() > 0.7) {
                    if (!hasCompleted("specialCherryBlossomEvent") && gameData.characters.guoliang.affection >= 70) {
                        completeEvent("specialCherryBlossomEvent");
                        addToLog("ç‰¹æ®Šäº‹ä»¶", "æ¨±èŠ±ç››å¼€çš„å­£èŠ‚ï¼Œä½ å’Œæå›½è‰¯åœ¨é‚£æ£µç‰¹åˆ«çš„æ¨±èŠ±æ ‘ä¸‹æœ‰äº†äº²å¯†æ¥è§¦ã€‚");
                        processEvent(specialCherryBlossomEvent());
                        return;
                    }
                }
                
                if (Math.random() > 0.8) {
                    if (!hasCompleted("specialDinnerEvent") && gameData.characters.guoliang.affection >= 80) {
                        completeEvent("specialDinnerEvent");
                        addToLog("ç‰¹æ®Šäº‹ä»¶", "ä½ é‚€è¯·æå›½è‰¯æ¥ä½ çš„å…¬å¯“å…±è¿›æ™šé¤ï¼Œæµªæ¼«çš„æ°”æ°›è®©ä½ ä»¬æ›´åŠ äº²è¿‘ã€‚");
                        processEvent(specialDinnerEvent());
                        return;
                    }
                }
                
                if (Math.random() > 0.9) {
                    if (!hasCompleted("intimateMemoryEvent") && gameData.characters.guoliang.affection >= 90 && gameData.player.memoryFragments.length >= 10) {
                        completeEvent("intimateMemoryEvent");
                        addToLog("ç‰¹æ®Šäº‹ä»¶", "è®°å¿†å®Œå…¨æ¢å¤åï¼Œä½ å’Œæå›½è‰¯ç»ˆäºè¿æ¥äº†é‡é€¢çš„äº²å¯†æ—¶åˆ»ã€‚");
                        processEvent(intimateMemoryEvent());
                        return;
                    }
                }
            }
            
            // æ£€æŸ¥æ˜¯å¦è¾¾åˆ°æœ€ç»ˆç»“å±€æ¡ä»¶
            if (gameData.gameState.storyFlag === 5 && !hasCompleted("finalReveal")) {
                completeEvent("finalReveal");
                addToLog("å…³é”®å‰§æƒ…", "ä½ åœ¨æ¨±èŠ±æ ‘ä¸‹ä¸æå›½è‰¯ç›¸è§ï¼Œä»–ç»ˆäºå‘Šè¯‰äº†ä½ å…³äºè¿‡å»çš„çœŸç›¸ã€‚");
                processEvent(finalRevealEvent());
                return;
            }
            
            // å¦‚æœè¾¾åˆ°ç»“å±€æ¡ä»¶ï¼Œè§¦å‘ç»“å±€
            if (gameData.player.memoryFragments.length >= 12 && gameData.characters.guoliang.affection >= 90 && gameData.gameState.storyFlag === 5) {
                processEvent(determineEnding());
                return;
            }
        }
        
        // UIç›¸å…³å‡½æ•°
        
        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message) {
            const notification = document.getElementById("notification");
            notification.textContent = message;
            notification.style.opacity = "1";
            notification.style.transform = "translateX(-50%) translateY(0)";
            
            setTimeout(function() {
                notification.style.opacity = "0";
                notification.style.transform = "translateX(-50%) translateY(-10px)";
            }, 2500);
        }
        
        // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
        function updateStatusDisplay() {
            document.getElementById("date-display").textContent = "ç¬¬" + gameData.gameState.day + "å¤©";
            
            let timeText = "";
            switch (gameData.gameState.time) {
                case "morning":
                    timeText = "ä¸Šåˆ";
                    break;
                case "afternoon":
                    timeText = "ä¸‹åˆ";
                    break;
                case "evening":
                    timeText = "æ™šä¸Š";
                    break;
            }
            document.getElementById("time-display").textContent = timeText;
            
            document.getElementById("energy-display").textContent = gameData.player.attributes.stamina + "%";
            document.getElementById("memory-display").textContent = gameData.player.memoryFragments.length + "/12";
            
            // æ›´æ–°å±æ€§é¡µé¢
            document.getElementById("charm-value").textContent = gameData.player.attributes.charm + "/100";
            document.getElementById("charm-bar").style.width = gameData.player.attributes.charm + "%";
            
            document.getElementById("wisdom-value").textContent = gameData.player.attributes.wisdom + "/100";
            document.getElementById("wisdom-bar").style.width = gameData.player.attributes.wisdom + "%";
            
            document.getElementById("stamina-value").textContent = gameData.player.attributes.stamina + "/100";
            document.getElementById("stamina-bar").style.width = gameData.player.attributes.stamina + "%";
            
            document.getElementById("law-value").textContent = gameData.player.attributes.law + "/100";
            document.getElementById("law-bar").style.width = gameData.player.attributes.law + "%";
            
            document.getElementById("basketball-value").textContent = gameData.player.attributes.basketball + "/100";
            document.getElementById("basketball-bar").style.width = gameData.player.attributes.basketball + "%";
            
            document.getElementById("cooking-value").textContent = gameData.player.attributes.cooking + "/100";
            document.getElementById("cooking-bar").style.width = gameData.player.attributes.cooking + "%";
            
            document.getElementById("affection-value").textContent = gameData.characters.guoliang.affection + "/100";
            document.getElementById("affection-bar").style.width = gameData.characters.guoliang.affection + "%";
            
            // æ›´æ–°è¿›åº¦æŒ‡ç¤ºå™¨
            updateProgressIndicator();
        }
        
        // æ›´æ–°è¿›åº¦æŒ‡ç¤ºå™¨
        function updateProgressIndicator() {
            const dots = document.querySelectorAll('.progress-indicator-dot');
            dots.forEach(dot => dot.classList.remove('active'));
            
            // æ ¹æ®æ•…äº‹é˜¶æ®µæ›´æ–°æŒ‡ç¤ºç‚¹
            if (gameData.gameState.storyFlag >= 0) {
                dots[0].classList.add('active');
            }
            if (gameData.gameState.storyFlag >= 2) {
                dots[1].classList.add('active');
            }
            if (gameData.gameState.storyFlag >= 4) {
                dots[2].classList.add('active');
            }
        }
        
        // æ›´æ–°ç‰©å“æ æ˜¾ç¤º
        function updateInventoryDisplay() {
            const inventoryGrid = document.getElementById("inventory-grid");
            inventoryGrid.innerHTML = "";
            
            if (gameData.player.inventory.length === 0) {
                const emptyMessage = document.createElement("div");
                emptyMessage.style.textAlign = "center";
                emptyMessage.style.padding = "2rem";
                emptyMessage.style.color = "#8b949e";
                emptyMessage.style.gridColumn = "1 / -1";
                emptyMessage.textContent = "ç‰©å“æ æ˜¯ç©ºçš„ï¼Œè¯·æ¢ç´¢æ¸¸æˆä¸–ç•Œæ”¶é›†ç‰©å“ã€‚";
                inventoryGrid.appendChild(emptyMessage);
                return;
            }
            
            gameData.player.inventory.forEach(function(itemId) {
                const item = itemsData[itemId];
                const itemElement = document.createElement("div");
                itemElement.className = "inventory-item";
                itemElement.dataset.itemId = itemId;
                
                const iconElement = document.createElement("div");
                iconElement.className = "inventory-icon";
                iconElement.textContent = item.icon;
                
                const nameElement = document.createElement("div");
                nameElement.className = "inventory-name";
                nameElement.textContent = item.name;
                
                itemElement.appendChild(iconElement);
                itemElement.appendChild(nameElement);
                
                itemElement.addEventListener("click", function() {
                    showItemDetail(itemId);
                });
                
                inventoryGrid.appendChild(itemElement);
            });
        }
        
        // æ˜¾ç¤ºç‰©å“è¯¦æƒ…
        function showItemDetail(itemId) {
            const item = itemsData[itemId];
            document.getElementById("item-detail-icon").textContent = item.icon;
            document.getElementById("item-detail-name").textContent = item.name;
            document.getElementById("item-detail-description").textContent = item.description;
            
            document.getElementById("use-item-btn").onclick = function() {
                useItem(itemId);
                document.getElementById("item-detail-modal").style.opacity = "0";
                document.getElementById("item-detail-modal").style.visibility = "hidden";
            };
            
            document.getElementById("cancel-item-btn").onclick = function() {
                document.getElementById("item-detail-modal").style.opacity = "0";
                document.getElementById("item-detail-modal").style.visibility = "hidden";
            };
            
            document.getElementById("item-detail-modal").style.opacity = "1";
            document.getElementById("item-detail-modal").style.visibility = "visible";
        }
        
        // æ›´æ–°è®°å¿†ç¢ç‰‡æ˜¾ç¤º
        function updateMemoryLogDisplay() {
            const memoryLogGrid = document.getElementById("memory-log-grid");
            memoryLogGrid.innerHTML = "";
            
            // åˆ›å»º12ä¸ªè®°å¿†ç¢ç‰‡æ ¼å­
            for (let i = 1; i <= 12; i++) {
                const fragmentId = "memory" + i;
                const isCollected = hasMemoryFragment(fragmentId);
                
                const itemElement = document.createElement("div");
                itemElement.className = isCollected ? "memory-log-item" : "memory-log-item locked";
                
                const iconElement = document.createElement("div");
                iconElement.className = "memory-log-icon";
                iconElement.textContent = isCollected ? "ğŸ’«" : "ğŸ”’";
                
                const numberElement = document.createElement("div");
                numberElement.className = "memory-log-number";
                numberElement.textContent = "#" + i;
                
                itemElement.appendChild(iconElement);
                itemElement.appendChild(numberElement);
                
                if (isCollected) {
                    itemElement.addEventListener("click", function() {
                        showMemoryDetail(fragmentId);
                    });
                }
                
                memoryLogGrid.appendChild(itemElement);
            }
        }
        
        // æ˜¾ç¤ºè®°å¿†è¯¦æƒ…
        function showMemoryDetail(fragmentId) {
            const fragment = memoryFragmentsData[fragmentId];
            document.getElementById("memory-log-modal-title").textContent = fragment.title;
            document.getElementById("memory-log-modal-text").textContent = fragment.content;
            
            document.getElementById("memory-log-modal").style.opacity = "1";
            document.getElementById("memory-log-modal").style.visibility = "visible";
            
            document.querySelector(".memory-log-close").onclick = function() {
                document.getElementById("memory-log-modal").style.opacity = "0";
                document.getElementById("memory-log-modal").style.visibility = "hidden";
            };
        }
        
        // æ›´æ–°æ—¥å¿—æ˜¾ç¤º
        function updateLogDisplay() {
            const logContainer = document.getElementById("log-container");
            logContainer.innerHTML = "";
            
            if (gameData.gameState.gameLog.length === 0) {
                const emptyMessage = document.createElement("div");
                emptyMessage.style.textAlign = "center";
                emptyMessage.style.padding = "2rem";
                emptyMessage.style.color = "#8b949e";
                emptyMessage.textContent = "æ¸¸æˆæ—¥å¿—æ˜¯ç©ºçš„ï¼Œè¯·å¼€å§‹ä½ çš„å†’é™©ã€‚";
                logContainer.appendChild(emptyMessage);
                return;
            }
            
            gameData.gameState.gameLog.forEach(function(log) {
                const logEntry = document.createElement("div");
                logEntry.className = "log-entry";
                
                // ç‰¹æ®Šæ ·å¼å¤„ç†
                if (log.category === "å‰§æƒ…" || log.category === "è®°å¿†" || log.category === "ç‰¹æ®Šäº’åŠ¨") {
                    logEntry.classList.add("special");
                }
                
                const logHeading = document.createElement("div");
                logHeading.className = "log-heading";
                logHeading.textContent = `[${log.time}] ${log.category}`;
                
                const logText = document.createElement("div");
                logText.className = "log-text";
                logText.textContent = log.text;
                
                logEntry.appendChild(logHeading);
                logEntry.appendChild(logText);
                
                logContainer.appendChild(logEntry);
            });
        }
        
        // æ˜¾ç¤º/éšè—å±å¹•
        function showScreen(screenId) {
            const screen = document.getElementById(screenId);
            
            if (screenId === "title-screen") {
                screen.style.opacity = "1";
                document.getElementById("game-ui").style.opacity = "0";
            } else if (screenId === "game-ui") {
                document.getElementById("title-screen").style.opacity = "0";
                screen.style.opacity = "1";
            } else {
                screen.style.opacity = "1";
                screen.style.visibility = "visible";
            }
        }
        
        function hideScreen(screenId) {
            const screen = document.getElementById(screenId);
            screen.style.opacity = "0";
            
            if (screenId !== "title-screen" && screenId !== "game-ui") {
                setTimeout(function() {
                    screen.style.visibility = "hidden";
                }, 300);
            }
        }
        
        function hideAllScreens() {
            const subScreens = document.querySelectorAll(".sub-screen");
            subScreens.forEach(screen => {
                screen.style.opacity = "0";
                setTimeout(() => {
                    screen.style.visibility = "hidden";
                }, 300);
            });
            
            document.getElementById("game-menu").style.opacity = "0";
            document.getElementById("game-menu").style.visibility = "hidden";
            document.getElementById("memory-collected").style.opacity = "0";
            document.getElementById("memory-collected").style.visibility = "hidden";
            document.getElementById("memory-log-modal").style.opacity = "0";
            document.getElementById("memory-log-modal").style.visibility = "hidden";
            document.getElementById("item-detail-modal").style.opacity = "0";
            document.getElementById("item-detail-modal").style.visibility = "hidden";
        }
        
        // æ›´æ–°åœºæ™¯
        function updateScene(location) {
            const locationData = locationsData[location];
            gameData.gameState.location = location;
            
            // æ˜¾ç¤ºåœºæ™¯è¿‡æ¸¡æ•ˆæœ
            const transition = document.querySelector(".scene-transition");
            transition.style.opacity = "1";
            
            setTimeout(() => {
                // æ›´æ–°åœºæ™¯èƒŒæ™¯
                document.getElementById("scene-bg").textContent = locationData.icon;
                
                // æ ¹æ®åœ°ç‚¹å’ŒçŠ¶æ€æ›´æ–°è§’è‰²æ˜¾ç¤º
                updateCharacterDisplay();
                
                // æ·¡å‡ºè¿‡æ¸¡æ•ˆæœ
                transition.style.opacity = "0";
                
                // ç¡®ä¿å§‹ç»ˆæ›´æ–°ä½ç½®äº‹ä»¶å’Œé€‰é¡¹
                setTimeout(() => {
                    updateLocationEvents();
                }, 300);
            }, 500);
            
            // æ›´æ–°åœ°å›¾ä¸­å½“å‰ä½ç½®çš„é«˜äº®
            document.querySelectorAll(".location-item").forEach(function(item) {
                if (item.dataset.location === location) {
                    item.classList.add("current-location");
                } else {
                    item.classList.remove("current-location");
                }
            });
            
            addToLog("ç§»åŠ¨", `ä½ æ¥åˆ°äº†${locationData.name}ã€‚`);
        }
        
        // æ›´æ–°è§’è‰²æ˜¾ç¤º
        function updateCharacterDisplay() {
            const characterImg = document.getElementById("character-img");
            const location = gameData.gameState.location;
            const character = document.getElementById("character");
            
            // é»˜è®¤æ˜¾ç¤ºå¤å¥ˆ
            characterImg.src = "https://pic1.imgdb.cn/item/66e83fc7d9c307b7e9977eda.png";  
            characterImg.alt = "ç»“åŸå¤å¥ˆ";
            characterImg.style.display = "block";
            
            // æ·»åŠ è§’è‰²è¿›å…¥åŠ¨ç”»
            character.style.transform = "translateX(-50%) translateY(20px)";
            character.style.opacity = "0";
            
            setTimeout(() => {
                character.style.transform = "translateX(-50%) translateY(0)";
                character.style.opacity = "1";
            }, 300);
            
            // åœ¨ç‰¹å®šåœ°ç‚¹å¯èƒ½æ˜¾ç¤ºæå›½è‰¯
            if (location === "basketball-court" && (Math.random() > 0.5 || gameData.gameState.storyFlag >= 1)) {
                characterImg.src = "https://pic1.imgdb.cn/item/66be21a1d9c307b7e9cc9c98.jpg";  // æå›½è‰¯å½¢è±¡
                characterImg.alt = "æå›½è‰¯";
                characterImg.style.display = "block";
            }
            
            // åœ¨å¥èº«æˆ¿å¯èƒ½æ˜¾ç¤ºç¾å’²
            if (location === "gym" && gameData.characters.misaki.metFlag && Math.random() > 0.7) {
                characterImg.src = "https://pic1.imgdb.cn/item/66d7f116d9c307b7e9a009b9.jpg";  // ç¾å’²å½¢è±¡
                characterImg.alt = "ç›¸æ³½ç¾å’²";
                characterImg.style.display = "block";
            }
            
            // åœ¨æŸäº›åœºæ™¯ä¸­è°ƒæ•´è§’è‰²ä½ç½®
            if (location === "library" || location === "classroom") {
                character.style.bottom = "5px"; // è°ƒæ•´ä½ç½®ï¼Œé¿å…é®æŒ¡åœºæ™¯
            } else {
                character.style.bottom = "10px";
            }
        }
        
        // å¤„ç†å¯¹è¯å’Œé€‰é¡¹æ˜¾ç¤º
        let currentDialogClickHandler = null;
        
        function processEvent(event) {
            const dialogueBox = document.getElementById("dialogue-box");
            const dialogueText = document.getElementById("dialogue-text");
            const speakerName = document.getElementById("speaker-name");
            const choicesContainer = document.getElementById("choices-container");
            const tapIndicator = document.getElementById("tap-indicator");
            
            if (!event || !event.dialogue || event.dialogue.length === 0) {
                console.warn("å¤„ç†äº†ä¸€ä¸ªç©ºäº‹ä»¶æˆ–æ²¡æœ‰å¯¹è¯çš„äº‹ä»¶");
                return;
            }
            
            // å¦‚æœå­˜åœ¨æ—§çš„ç‚¹å‡»å¤„ç†å™¨ï¼Œå…ˆç§»é™¤å®ƒ
            if (currentDialogClickHandler) {
                dialogueBox.removeEventListener('click', currentDialogClickHandler);
                currentDialogClickHandler = null;
            }
            
            // æ¸…ç©ºä¹‹å‰çš„å†…å®¹
            dialogueText.innerHTML = "";
            choicesContainer.innerHTML = "";
            
            // æ˜¾ç¤ºç¬¬ä¸€å¥å¯¹è¯
            const firstDialogue = event.dialogue[0];
            speakerName.textContent = firstDialogue.speaker;
            
            // ç›´æ¥æ˜¾ç¤ºæ–‡æœ¬ï¼Œä¸ä½¿ç”¨æ‰“å­—æœºæ•ˆæœ
            dialogueText.textContent = firstDialogue.text;
            
            // ä¿å­˜å½“å‰äº‹ä»¶æ•°æ®
            dialogueBox.dataset.currentDialogueIndex = "0";
            dialogueBox.dataset.dialogues = JSON.stringify(event.dialogue);
            
            // å¦‚æœæœ‰å¤šå¥å¯¹è¯ï¼Œæ˜¾ç¤ºç‚¹å‡»æŒ‡ç¤ºå™¨
            if (event.dialogue.length > 1) {
                tapIndicator.style.display = "block";
                
                // ç¡®ä¿å¯¹è¯æ¡†å¯ä»¥ç‚¹å‡»
                dialogueBox.style.pointerEvents = "auto";
                
                // åˆ›å»ºæ–°çš„ç‚¹å‡»äº‹ä»¶å¤„ç†
                currentDialogClickHandler = function(e) {
                    // å¿½ç•¥ç‚¹å‡»é€‰é¡¹æŒ‰é’®çš„æƒ…å†µ
                    if (e.target.classList.contains("choice-btn") || e.target.closest(".choice-btn")) {
                        return;
                    }
                    
                    // è·å–å½“å‰å¯¹è¯ç´¢å¼•
                    const currentIndex = parseInt(dialogueBox.dataset.currentDialogueIndex);
                    const dialogues = JSON.parse(dialogueBox.dataset.dialogues);
                    
                    // å¦‚æœæœ‰ä¸‹ä¸€å¥å¯¹è¯
                    if (currentIndex < dialogues.length - 1) {
                        const nextIndex = currentIndex + 1;
                        const nextDialogue = dialogues[nextIndex];
                        
                        speakerName.textContent = nextDialogue.speaker;
                        dialogueText.textContent = nextDialogue.text; // ç›´æ¥æ˜¾ç¤ºå…¨æ–‡
                        
                        dialogueBox.dataset.currentDialogueIndex = nextIndex;
                    } else {
                        // å¦‚æœæ˜¯æœ€åä¸€å¥å¯¹è¯ï¼Œå»¶é•¿æ˜¾ç¤ºæ—¶é—´åæ˜¾ç¤ºé€‰é¡¹
                        if (currentDialogClickHandler) {
                            dialogueBox.removeEventListener('click', currentDialogClickHandler);
                            currentDialogClickHandler = null;
                        }
                        
                        tapIndicator.style.display = "none";
                        
                        setTimeout(() => {
                            if (event.choices && event.choices.length > 0) {
                                displayChoices(event.choices);
                            } else {
                                // å¦‚æœæ²¡æœ‰é€‰æ‹©ï¼Œè‡ªåŠ¨æ˜¾ç¤ºå½“å‰ä½ç½®å¯ç”¨äº‹ä»¶
                                updateLocationEvents();
                            }
                        }, 3000);
                    }
                };
                
                // ç»‘å®šç‚¹å‡»äº‹ä»¶
                dialogueBox.addEventListener('click', currentDialogClickHandler);
            } else {
                // å¦‚æœåªæœ‰ä¸€å¥å¯¹è¯ï¼Œå»¶é•¿æ˜¾ç¤ºæ—¶é—´
                tapIndicator.style.display = "none";
                
                setTimeout(function() {
                    if (event.choices && event.choices.length > 0) {
                        displayChoices(event.choices);
                    } else {
                        // å¦‚æœæ²¡æœ‰é€‰æ‹©ï¼Œè‡ªåŠ¨æ˜¾ç¤ºå½“å‰ä½ç½®å¯ç”¨äº‹ä»¶
                        updateLocationEvents();
                    }
                }, 3000);
            }
        }
        
        // æ˜¾ç¤ºé€‰é¡¹
        function displayChoices(choices) {
            const choicesContainer = document.getElementById("choices-container");
            choicesContainer.innerHTML = "";
            
            if (!choices || choices.length === 0) {
                return;
            }
            
            choices.forEach(function(choice, index) {
                const choiceBtn = document.createElement("div");
                choiceBtn.className = "choice-btn";
                choiceBtn.textContent = choice.text;
                
                // æ·»åŠ æ·¡å…¥åŠ¨ç”»
                choiceBtn.style.opacity = "0";
                choiceBtn.style.transform = "translateY(10px)";
                
                // æ·»åŠ ç‚¹å‡»å’Œè§¦æ‘¸äº‹ä»¶
                const handleClick = function(e) {
                    e.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
                    
                    // é˜²æ­¢é‡å¤ç‚¹å‡»
                    if (this.dataset.processing === "true") return;
                    this.dataset.processing = "true";
                    
                    // æ·»åŠ ç‚¹å‡»è§†è§‰åé¦ˆ
                    this.style.transform = "translateY(2px)";
                    this.style.boxShadow = "0 1px 2px rgba(0, 0, 0, 0.2)";
                    this.style.backgroundColor = "#30363d";
                    
                    setTimeout(() => {
                        this.style.transform = "translateY(0)";
                        this.style.boxShadow = "0 2px 5px rgba(0, 0, 0, 0.2)";
                        this.style.backgroundColor = "#21262d";
                        
                        if (choice.action) {
                            try {
                                const result = choice.action();
                                if (result) {
                                    processEvent(result);
                                }
                            } catch (err) {
                                console.error("é€‰é¡¹æ‰§è¡Œé”™è¯¯:", err);
                                showNotification("æ“ä½œæ‰§è¡Œé”™è¯¯ï¼Œè¯·å°è¯•å…¶ä»–é€‰é¡¹");
                            }
                        }
                        
                        // é‡ç½®å¤„ç†çŠ¶æ€
                        setTimeout(() => {
                            this.dataset.processing = "false";
                        }, 500);
                    }, 100);
                };
                
                choiceBtn.addEventListener('click', handleClick);
                
                choicesContainer.appendChild(choiceBtn);
                
                // é”™å¼€æ·¡å…¥æ—¶é—´
                setTimeout(() => {
                    choiceBtn.style.opacity = "1";
                    choiceBtn.style.transform = "translateY(0)";
                }, 100 * index);
            });
        }
        
        // æ‰§è¡Œå½“å‰åœ°ç‚¹çš„å¯ç”¨äº‹ä»¶
        function executeLocationEvent(eventName) {
            const location = gameData.gameState.location;
            const event = eventsData[eventName];
            
            // æ£€æŸ¥äº‹ä»¶æ˜¯å¦å­˜åœ¨
            if (!event) return;
            
            // åˆ¤æ–­è¿™ä¸ªäº‹ä»¶æ˜¯å¦ä¼šå‡å°‘ä½“åŠ›
            const eventReducesStamina = event.execute.toString().includes('changeAttribute("stamina", -');
            
            // å¦‚æœä¼šå‡å°‘ä½“åŠ›ï¼Œæ£€æŸ¥å½“å‰ä½“åŠ›æ˜¯å¦è¶³å¤Ÿ
            if (eventReducesStamina && gameData.player.attributes.stamina <= 10) {
                showNotification("ä½“åŠ›ä¸è¶³ï¼Œè¯·å…ˆä¼‘æ¯æ¢å¤ä½“åŠ›");
                return;
            }
            
            // æ£€æŸ¥æ˜¯å¦æœ‰ç‰¹æ®Šå¯ç”¨æ¡ä»¶
            if (event.available && typeof event.available === "function" && !event.available()) {
                showNotification("è¿™ä¸ªæ´»åŠ¨æš‚æ—¶ä¸å¯ç”¨");
                return;
            }
            
            // æ£€æŸ¥äº‹ä»¶è¦æ±‚
            if (!checkEventRequirements(event)) {
                if (event.requirements.attributes) {
                    for (const attr in event.requirements.attributes) {
                        if (gameData.player.attributes[attr] < event.requirements.attributes[attr]) {
                            showNotification(`éœ€è¦${attributeDisplayName(attr)}è¾¾åˆ°${event.requirements.attributes[attr]}ç‚¹`);
                            return;
                        }
                    }
                }
                showNotification("ä½ ä¸æ»¡è¶³è¿™ä¸ªæ´»åŠ¨çš„è¦æ±‚");
                return;
            }
            
            // æ£€æŸ¥èƒ½é‡æ˜¯å¦è¶³å¤Ÿ
            if (gameData.gameState.energyLeft < event.energyCost) {
                showNotification("ä½ çš„ç²¾åŠ›ä¸è¶³");
                return;
            }
            
            // æ‰§è¡Œäº‹ä»¶
            consumeEnergy(event.energyCost);
            const result = event.execute();
            
            if (result) {
                processEvent(result);
                // ç»™ç©å®¶é¢å¤–çš„æ—¶é—´é˜…è¯»ç»“æœï¼Œå†æ¨è¿›æ—¶é—´
                setTimeout(() => {
                    advanceTime();
                }, 3000);
            } else {
                // å¦‚æœæ²¡æœ‰ç»“æœæ–‡æœ¬ï¼Œå»¶è¿Ÿä¸€ä¸‹å†æ¨è¿›æ—¶é—´
                setTimeout(() => {
                    advanceTime();
                }, 3000);
            }
        }
        
        // æ›´æ–°åœ°ç‚¹å¯ç”¨äº‹ä»¶
        function updateLocationEvents() {
            const location = gameData.gameState.location;
            const locationData = locationsData[location];
            
            if (!locationData || !locationData.events) {
                return;
            }
            
            const choicesContainer = document.getElementById("choices-container");
            choicesContainer.innerHTML = "";
            
            // æ·»åŠ å½“å‰åœ°ç‚¹æè¿°
            processEvent({
                dialogue: [
                    {speaker: "ç³»ç»Ÿ", text: locationData.description + " ä½ ç°åœ¨å¯ä»¥:"}
                ]
            });
            
            // æ·»åŠ å¯ç”¨äº‹ä»¶é€‰é¡¹
            locationData.events.forEach(function(eventName) {
                const event = eventsData[eventName];
                
                // æ£€æŸ¥äº‹ä»¶æ˜¯å¦å­˜åœ¨
                if (!event) {
                    return;
                }
                
                // æ£€æŸ¥æ˜¯å¦æœ‰ç‰¹æ®Šå¯ç”¨æ¡ä»¶
                if (event.available && typeof event.available === "function" && !event.available()) {
                    return;
                }
                
                const choiceBtn = document.createElement("div");
                choiceBtn.className = "choice-btn";
                choiceBtn.textContent = event.name + " (æ¶ˆè€—ç²¾åŠ›: " + event.energyCost + ")";
                
                // æ·»åŠ äº‹ä»¶æè¿°
                if (event.description) {
                    const descriptionSpan = document.createElement("div");
                    descriptionSpan.className = "choice-desc";
                    descriptionSpan.textContent = event.description;
                    choiceBtn.appendChild(descriptionSpan);
                }
                
                // å¦‚æœèƒ½é‡ä¸è¶³ï¼Œç¦ç”¨æŒ‰é’®
                if (gameData.gameState.energyLeft < event.energyCost) {
                    choiceBtn.classList.add("disabled");
                    choiceBtn.title = "ç²¾åŠ›ä¸è¶³";
                } else {
                    // æ·»åŠ ç‚¹å‡»äº‹ä»¶
                    choiceBtn.addEventListener('click', function() {
                        // è§†è§‰åé¦ˆ
                        if (!choiceBtn.classList.contains("disabled")) {
                            choiceBtn.style.transform = "translateY(2px)";
                            choiceBtn.style.boxShadow = "0 1px 2px rgba(0, 0, 0, 0.2)";
                            choiceBtn.style.backgroundColor = "#30363d";
                            
                            // å»¶è¿Ÿæ‰§è¡Œä»¥æ˜¾ç¤ºç‚¹å‡»æ•ˆæœ
                            setTimeout(() => {
                                choiceBtn.style.transform = "translateY(0)";
                                choiceBtn.style.boxShadow = "0 2px 5px rgba(0, 0, 0, 0.2)";
                                choiceBtn.style.backgroundColor = "#21262d";
                                executeLocationEvent(eventName);
                            }, 100);
                        }
                    });
                }
                
                choicesContainer.appendChild(choiceBtn);
            });
        }
        
        // ä¿å­˜æ¸¸æˆ
        function saveGame() {
            try {
                localStorage.setItem("guoliangTrapSave", JSON.stringify(gameData));
                showNotification("æ¸¸æˆå·²ä¿å­˜");
                addToLog("ç³»ç»Ÿ", "æ¸¸æˆå·²æˆåŠŸä¿å­˜ã€‚");
                return true;
            } catch (e) {
                showNotification("ä¿å­˜å¤±è´¥");
                console.error("ä¿å­˜å¤±è´¥:", e);
                return false;
            }
        }
        
        // åŠ è½½æ¸¸æˆ
        function loadGame() {
            try {
                const savedData = localStorage.getItem("guoliangTrapSave");
                if (savedData) {
                    gameData = JSON.parse(savedData);
                    updateStatusDisplay();
                    updateInventoryDisplay();
                    updateMemoryLogDisplay();
                    updateLogDisplay();
                    updateScene(gameData.gameState.location);
                    showNotification("æ¸¸æˆå·²åŠ è½½");
                    addToLog("ç³»ç»Ÿ", "æ¸¸æˆå·²æˆåŠŸåŠ è½½ã€‚");
                    return true;
                }
                showNotification("æ²¡æœ‰æ‰¾åˆ°å­˜æ¡£");
                return false;
            } catch (e) {
                showNotification("åŠ è½½å¤±è´¥");
                console.error("åŠ è½½å¤±è´¥:", e);
                return false;
            }
        }
        
        // æ·»åŠ ç´§æ€¥æ¢å¤åŠŸèƒ½
        function addDebugRecoveryFeatures() {
            // åŒå‡»æ˜¾ç¤ºæ¢å¤æŒ‰é’®
            let lastClick = 0;
            document.addEventListener('click', function(e) {
                const now = new Date().getTime();
                if (now - lastClick < 300) {
                    document.getElementById("recovery-button").style.display = "block";
                    setTimeout(() => {
                        document.getElementById("recovery-button").style.display = "none";
                    }, 5000);
                }
                lastClick = now;
            });
            
            // æ¢å¤æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            document.getElementById("recovery-button").addEventListener("click", function() {
                updateLocationEvents();
                showNotification("å·²å°è¯•æ¢å¤æ¸¸æˆçŠ¶æ€");
                this.style.display = "none";
            });
        }
        
        // ç¡®ä¿æ¸¸æˆçŠ¶æ€ä¸€è‡´æ€§
        function ensureGameConsistency() {
            // ç¡®ä¿æ¸¸æˆçŠ¶æ€ä¸€è‡´
            if (!gameData.gameState.location) {
                console.warn("ä½ç½®æœªå®šä¹‰ï¼Œé‡ç½®ä¸ºå…¬å¯“");
                gameData.gameState.location = "apartment";
            }
            
            // ç¡®ä¿èƒ½é‡æœ‰åˆç†å€¼
            if (gameData.gameState.energyLeft < 0) {
                gameData.gameState.energyLeft = 0;
            }
            
            // æ›´æ–°UIçŠ¶æ€
            updateStatusDisplay();
        }
        
        // ç»‘å®šèœå•å’ŒUIäº‹ä»¶
        function bindUIEvents() {
            // èœå•æŒ‰é’®
            document.getElementById("menu-button").addEventListener("click", function(e) {
                e.stopPropagation();
                document.getElementById("game-menu").style.opacity = "1";
                document.getElementById("game-menu").style.visibility = "visible";
            });
            
            // èœå•é¡¹
            document.getElementById("close-menu-btn").addEventListener("click", function() {
                hideScreen("game-menu");
            });
            
            document.getElementById("inventory-btn").addEventListener("click", function() {
                hideScreen("game-menu");
                showScreen("inventory-screen");
                updateInventoryDisplay();
            });
            
            document.getElementById("map-btn").addEventListener("click", function() {
                hideScreen("game-menu");
                showScreen("map-screen");
            });
            
            document.getElementById("status-btn").addEventListener("click", function() {
                hideScreen("game-menu");
                showScreen("status-screen");
            });
            
            document.getElementById("memory-btn").addEventListener("click", function() {
                hideScreen("game-menu");
                showScreen("memory-log-screen");
                updateMemoryLogDisplay();
            });
            
            document.getElementById("log-btn").addEventListener("click", function() {
                hideScreen("game-menu");
                showScreen("log-screen");
                updateLogDisplay();
            });
            
            document.getElementById("save-btn").addEventListener("click", function() {
                saveGame();
                hideScreen("game-menu");
            });
            
            // è¿”å›æŒ‰é’®
            const backButtons = document.querySelectorAll(".back-btn");
            backButtons.forEach(function(btn) {
                btn.addEventListener("click", function() {
                    hideAllScreens();
                });
            });
            
            // åœ°ç‚¹é€‰æ‹©
            const locationItems = document.querySelectorAll(".location-item");
            locationItems.forEach(function(item) {
                item.addEventListener("click", function() {
                    const locationId = this.dataset.location;
                    updateScene(locationId);
                    hideScreen("map-screen");
                });
            });
            
            // è®°å¿†ç¢ç‰‡ç¡®è®¤æŒ‰é’®
            document.getElementById("continue-btn").addEventListener("click", function() {
                hideScreen("memory-collected");
            });
            
            // å–æ¶ˆç‰©å“æŒ‰é’®
            document.getElementById("cancel-item-btn").addEventListener("click", function() {
                document.getElementById("item-detail-modal").style.opacity = "0";
                document.getElementById("item-detail-modal").style.visibility = "hidden";
            });
            
            // å…³é—­è®°å¿†è¯¦æƒ…
            document.querySelector(".memory-log-close").addEventListener("click", function() {
                document.getElementById("memory-log-modal").style.opacity = "0";
                document.getElementById("memory-log-modal").style.visibility = "hidden";
            });
        }
        
        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            // éšè—åŠ è½½å±å¹•
            setTimeout(function() {
                document.getElementById("loading-screen").style.opacity = "0";
                setTimeout(function() {
                    document.getElementById("loading-screen").style.display = "none";
                }, 500);
            }, 1500);
            
            // åˆå§‹åŒ–æ˜¾ç¤º
            updateStatusDisplay();
            updateInventoryDisplay();
            updateMemoryLogDisplay();
            updateLogDisplay();
            
            // ç»‘å®šUIäº‹ä»¶
            bindUIEvents();
            
            // æ·»åŠ ç´§æ€¥æ¢å¤åŠŸèƒ½
            addDebugRecoveryFeatures();
            
            // æ ‡é¢˜ç•Œé¢æŒ‰é’®
            document.getElementById("start-btn").addEventListener("click", function() {
                hideScreen("title-screen");
                showScreen("game-ui");
                
                // æ˜¾ç¤ºå¼•å¯¼å¯¹è¯
                processEvent({
                    dialogue: [
                        {speaker: "ç³»ç»Ÿ", text: "æ¬¢è¿æ¥åˆ°ã€Šå›½è‰¯è¯±æ•å™¨ã€‹ï¼ä½ å°†æ‰®æ¼”ç»“åŸå¤å¥ˆï¼Œä¸€ä½å•†æ³•ä¸“ä¸šçš„å¤§äºŒå­¦ç”Ÿã€‚ä½ çš„ç›®æ ‡æ˜¯è¿½æ±‚æå›½è‰¯ï¼Œå¤§ä¸‰ç¯®çƒé˜Ÿçš„å­¦ç”Ÿæ•™ç»ƒã€‚"},
                        {speaker: "ç³»ç»Ÿ", text: "ä½†éšç€æ¸¸æˆè¿›ç¨‹ï¼Œä½ ä¼šé€æ¸å‘ç°ä¸¤äººä¹‹é—´å­˜åœ¨è¢«é—å¿˜çš„æ·±åšè¿‡å¾€ã€‚"},
                        {speaker: "ç³»ç»Ÿ", text: "æ¸¸æˆä¸­æœ‰8ä¸ªå¯æ¢ç´¢åœ°ç‚¹ï¼Œé€šè¿‡æ‰§è¡Œä¸åŒæ´»åŠ¨æå‡å±æ€§ï¼Œæ”¶é›†è®°å¿†ç¢ç‰‡ï¼Œå¢åŠ æå›½è‰¯çš„å¥½æ„Ÿåº¦ã€‚"},
                        {speaker: "ç³»ç»Ÿ", text: "æ¯å¤©åˆ†ä¸ºä¸Šåˆã€ä¸‹åˆå’Œæ™šä¸Šä¸‰ä¸ªæ—¶æ®µ, æ¯ä¸ªæ—¶æ®µå¯ä»¥è¿›è¡Œä¸€é¡¹æ´»åŠ¨ã€‚è¯·åˆç†è§„åˆ’ä½ çš„æ—¶é—´å’Œç²¾åŠ›ã€‚"},
                        {speaker: "ç³»ç»Ÿ", text: "ç°åœ¨ï¼Œä½ çš„å†’é™©å³å°†å¼€å§‹ï¼"}
                    ],
                    choices: [
                        {
                            text: "å¼€å§‹æˆ‘çš„æ ¡å›­ç”Ÿæ´»",
                            action: function() {
                                updateScene("apartment");
                                updateLocationEvents();
                                addToLog("ç³»ç»Ÿ", "æ¸¸æˆå¼€å§‹ï¼å¸Œæœ›ä½ èƒ½æ­å¼€è¿‡å»çš„è°œå›¢ï¼Œè¿½å¯»çœŸçˆ±ã€‚");
                                
                                return {
                                    dialogue: [
                                        {speaker: "å¤å¥ˆ", text: "ä»Šå¤©ä¹Ÿè¦åŠªåŠ›ï¼é¦–å…ˆåº”è¯¥åšäº›ä»€ä¹ˆå¥½å‘¢ï¼Ÿ"},
                                        {speaker: "ç³»ç»Ÿ", text: "æç¤ºï¼šå°è¯•å»ç¯®çƒåœºçœ‹çœ‹ï¼Œä¹Ÿè®¸èƒ½é‡åˆ°æå›½è‰¯ã€‚"}
                                    ]
                                };
                            }
                        }
                    ]
                });
            });
            
            document.getElementById("load-btn").addEventListener("click", function() {
                // å°è¯•åŠ è½½å­˜æ¡£
                if (loadGame()) {
                    hideScreen("title-screen");
                    showScreen("game-ui");
                    updateLocationEvents();
                }
            });
            
            document.getElementById("about-btn").addEventListener("click", function() {
                showNotification("ã€Šå›½è‰¯è¯±æ•å™¨ã€‹æ˜¯ä¸€æ¬¾æ ¡å›­æ‹çˆ±æ¨¡æ‹Ÿæ¸¸æˆ");
                setTimeout(() => {
                    showNotification("ä½ å°†æ‰®æ¼”å¤±å¿†çš„å¥³ä¸»è§’å¤å¥ˆï¼Œè¿½å¯»ä¸ç¯®çƒæ•™ç»ƒæå›½è‰¯ä¹‹é—´è¢«é—å¿˜çš„è¿‡å»");
                }, 2500);
                setTimeout(() => {
                    showNotification("æ”¶é›†è®°å¿†ç¢ç‰‡å’Œæå‡å¥½æ„Ÿåº¦ï¼Œæ­å¼€è¿‡å»çš„çœŸç›¸ï¼");
                }, 5000);
            });
            
            // é˜²æ­¢è§¦æ‘¸äº‹ä»¶å¯¼è‡´ç¼©æ”¾
            document.addEventListener('touchmove', function(event) {
                if (event.scale !== 1) { 
                    event.preventDefault();
                }
            }, { passive: false });
            
            // åŒå‡»ç¼©æ”¾ç¦ç”¨
            let lastTouchEnd = 0;
            document.addEventListener('touchend', function(event) {
                const now = (new Date()).getTime();
                if (now - lastTouchEnd <= 300) {
                    event.preventDefault();
                }
                lastTouchEnd = now;
            }, false);
        }
        
        // ç›‘å¬é¡µé¢åŠ è½½
        document.addEventListener("DOMContentLoaded", initGame);
    </script>
    </body>
    </html>
